import{S as e}from"./sdkwork-page-container-5d58390b.js";import{k as a,c as o,r as t,a as s,Q as l,R as i,S as n,j as r,a0 as m,X as d,$ as c,Z as p,U as u,a4 as g,O as h}from"./vue-vendor-a2672387.js";import{s as v,I as f,B as k,_ as w,u as j}from"./index-5affcab4.js";/* empty css              */import{_ as b,a as x}from"./sdkwork-collapse-item-faedb3e0.js";import{_ as C}from"./sdkwork-popup-6e1ec418.js";/* empty css              *//* empty css              */import{P as y}from"./index-0a8ae520.js";import{S as V}from"./index-8ec8972f.js";import{_ as M,a as _}from"./sdkwork-cell-group-c8f6555d.js";/* empty css              *//* empty css              */import{S as U}from"./sdkwork-voice-speaker-category-list-popup-6a918502.js";import{S as I}from"./sdkwork-avatar-f9ee9326.js";import{A as P}from"./agent-93cf4383.js";import{F as z}from"./index-dee6a080.js";import"./utils-vendor-b5712723.js";import"./index-44056be1.js";import"./sdkwork-icon-2d6efb98.js";import"./sdkwork-pull-refresh-9d6db096.js";import"./index-e159e7ef.js";import"./shared-1cf0c357.js";import"./sdkwork-search-bar-4d747e22.js";import"./index-ccee2c65.js";import"./use-id-82312033.js";import"./ListItem-783a2127.js";import"./LoadingSection-0e2448c2.js";import"./LoadMoreSection-49ddad4b.js";import"./sdkwork-voice-clone-2a1489b7.js";/* empty css              */import"./index-5d6825eb.js";import"./ImagePreview-084463df.js";import"./index-63936d32.js";import"./index-4fcf5799.js";import"./index-fa879ae6.js";import"./function-call-e02e5da4.js";const H={class:"header-section"},S={class:"avatar-container"},F={class:"name-field-wrapper"},A={class:"char-count-bottom"},O={class:"prompt-field-wrapper"},B={class:"char-count-bottom"},L={class:"char-count"},$={class:"voice-selector"},D={key:0,class:"selected-voice"},K={key:1,class:"placeholder"},N={class:"description-field-wrapper"},T={class:"char-count-bottom"},q={class:"welcome-field-wrapper"},Q={class:"char-count-bottom"},R={class:"char-count"},X={class:"permission-value"},Z={class:"bottom-action-bar"},E=w(a({__name:"sdkwork-agent-create",props:{themeMode:{default:"auto"}},emits:["agent-created","agent-canceled"],setup(e,{expose:a,emit:h}){const w=e,j=o(()=>"dark"===w.themeMode||"light"!==w.themeMode&&(!("undefined"==typeof window||!window.matchMedia)&&window.matchMedia("(prefers-color-scheme: dark)").matches)),E=o(()=>j.value?"sdkwork-agent-create--dark":"sdkwork-agent-create--light"),G=t(!1),J=t(!1),W=t(!1),Y=t([]),ee=t(""),ae=t(""),oe=t(["view"]),te=new P,se=o(()=>"100%"),le=[{text:"查看",value:"view"},{text:"交互",value:"interact"},{text:"分享",value:"share"}],ie=t(""),ne=s({name:"",description:"",isPublic:!1,permissions:[],prompt:{content:""},greeting:"",baseConfig:{welcome:"",questions:[],saveFiles:!1,enableMemory:!1,maxHistoryMessages:50,useKnowledgeBase:!1,properties:{}}}),re=o(()=>ne.name.trim()&&ne.name.length<=20&&ne.description.length<=200),me=()=>{ne.name.trim()?ne.name.length>20?ee.value="名称不能超过20个字符":ee.value="":ee.value="名称不能为空"},de=e=>{console.log("头像上传:",e),ne.faceImage={url:ie.value,type:1,size:e.size},v("头像上传成功")},ce=()=>{console.log("头像被点击")},pe=e=>{const a={id:e.id?.toString(),displayName:e.name,description:e.description,provider:"default",product:"default",model:"default",voice:e.name};ne.speechConfig={speakerConfig:{speaker:a}},J.value=!1,v(`已选择: ${e.name}`)},ue=e=>{if(!e||0===e.length)return"";const a=le.find(a=>a.value===e[0]);return a?a.text:""},ge=e=>{let a;console.log("Picker返回的值:",e),a=Array.isArray(e)?e[0]:e&&"object"==typeof e?e:{text:e,value:e},ne.permissions=a.value||a,W.value=!1,v(`已选择: ${a.text||a}`)},he=async()=>{if(me(),!ee.value&&ne.name.trim()){G.value=!0;try{ie.value&&!ne.faceImage&&(ne.faceImage={url:ie.value,type:1,size:0});const e={name:ne.name,description:ne.description,faceImage:ne.faceImage,faceVideo:ne.faceVideo,icon:ne.icon,tags:ne.tags,prompt:ne.prompt,greeting:ne.greeting,speechConfig:ne.speechConfig,isPublic:ne.isPublic,permissions:ne.permissions,baseConfig:ne.baseConfig,type:ne.type,status:ne.status,knowledgeConfig:ne.knowledgeConfig,memoryConfig:ne.memoryConfig,toolConfig:ne.toolConfig,chatOptions:ne.chatOptions};te.create(e),v("智能体创建成功"),console.log("智能体创建成功，提交的数据:",e)}catch(e){console.error("智能体创建失败:",e),v("创建失败，请重试")}finally{G.value=!1}}else v("请完善基本信息")};return a({resetForm:()=>{ie.value="",Object.assign(ne,{name:"",description:"",faceImage:void 0,faceVideo:void 0,icon:void 0,tags:void 0,prompt:{content:""},greeting:"",speechConfig:void 0,isPublic:!1,permissions:[],baseConfig:{welcome:"",questions:[],saveFiles:!1,enableMemory:!1,maxHistoryMessages:50,useKnowledgeBase:!1,properties:{}}}),Y.value=[]},getFormData:()=>ne,setFormData:e=>{Object.assign(ne,e)}}),(a,o)=>{const t=z,s=M,h=f,v=_,w=V,j=y,P=C,te=b,ve=x,fe=k;return l(),i("div",{class:d(["agent-create",E.value])},[n("div",H,[n("div",S,[r(I,{modelValue:ie.value,"onUpdate:modelValue":o[0]||(o[0]=e=>ie.value=e),size:80,uploadable:!0,"show-ai-generate":!1,round:!0,text:"头像","theme-mode":e.themeMode,onUpload:de,onClick:ce,class:"avatar-uploader"},null,8,["modelValue","theme-mode"])]),r(s,{class:"name-section","theme-mode":e.themeMode},{default:m(()=>[n("div",F,[r(t,{modelValue:ne.name,"onUpdate:modelValue":o[1]||(o[1]=e=>ne.name=e),placeholder:"请输入智能体名称",maxlength:20,"error-message":ee.value,size:"large",onBlur:me,center:""},null,8,["modelValue","error-message"]),n("div",A,[n("span",{class:d(["char-count",{error:ne.name.length>20}])},c(ne.name.length)+"/20 ",3)])])]),_:1},8,["theme-mode"])]),r(s,{class:"basic-info-section","theme-mode":e.themeMode},{default:m(()=>[n("div",O,[r(t,{modelValue:ne.prompt.content,"onUpdate:modelValue":o[2]||(o[2]=e=>ne.prompt.content=e),label:"提示词","label-align":"top",type:"textarea",placeholder:"请输入角色提示词",autosize:{minHeight:100,maxHeight:200},maxlength:1e3},null,8,["modelValue"]),n("div",B,[n("span",L,c(ne.prompt.content?.length||0)+"/1000 ",1)])])]),_:1},8,["theme-mode"]),r(s,{class:"voice-section","theme-mode":e.themeMode},{default:m(()=>[r(v,{title:"发音人",center:"","is-link":"",onClick:o[3]||(o[3]=e=>J.value=!0),"theme-mode":e.themeMode},{value:m(()=>[n("div",$,[r(h,{name:"music",class:"voice-icon"}),ne.speechConfig?.speakerConfig?.speaker?(l(),i("span",D,c(ne.speechConfig.speakerConfig.speaker.displayName),1)):(l(),i("span",K,"请选择发音人"))])]),_:1},8,["theme-mode"]),n("div",N,[r(t,{modelValue:ne.description,"onUpdate:modelValue":o[4]||(o[4]=e=>ne.description=e),label:"描述","label-align":"top",type:"textarea",placeholder:"请输入智能体描述",maxlength:200,autosize:{minHeight:80,maxHeight:120},"error-message":ae.value},null,8,["modelValue","error-message"]),n("div",T,[n("span",{class:d(["char-count",{error:ne.description.length>200}])},c(ne.description.length)+"/200 ",3)])])]),_:1},8,["theme-mode"]),r(ve,{modelValue:Y.value,"onUpdate:modelValue":o[11]||(o[11]=e=>Y.value=e),class:"other-settings-section","theme-mode":e.themeMode},{default:m(()=>[r(te,{title:"其他设置",name:"other","theme-mode":e.themeMode},{default:m(()=>[n("div",q,[r(t,{modelValue:ne.baseConfig.welcome,"onUpdate:modelValue":o[5]||(o[5]=e=>ne.baseConfig.welcome=e),label:"默认开场白","label-align":"top",type:"textarea",placeholder:"请输入默认开场白",autosize:{minHeight:80,maxHeight:120},maxlength:500},null,8,["modelValue"]),n("div",Q,[n("span",R,c(ne.baseConfig?.welcome?.length||0)+"/500 ",1)])]),r(s,{"theme-mode":e.themeMode},{default:m(()=>[r(v,{title:"公开智能体",center:"","theme-mode":e.themeMode},{value:m(()=>[r(w,{modelValue:ne.isPublic,"onUpdate:modelValue":o[6]||(o[6]=e=>ne.isPublic=e),size:"20"},null,8,["modelValue"])]),_:1},8,["theme-mode"]),ne.isPublic?(l(),p(v,{key:0,title:"权限设置",center:"","is-link":"",onClick:o[7]||(o[7]=e=>W.value=!0),"theme-mode":e.themeMode},{value:m(()=>[n("span",X,c(ue(ne.permissions)||"请选择权限"),1)]),_:1},8,["theme-mode"])):u("",!0),r(P,{show:W.value,"onUpdate:show":o[10]||(o[10]=e=>W.value=e),position:"bottom",round:"","theme-mode":e.themeMode},{default:m(()=>[r(j,{columns:le,modelValue:oe.value,"onUpdate:modelValue":o[8]||(o[8]=e=>oe.value=e),onConfirm:ge,onCancel:o[9]||(o[9]=e=>W.value=!1),title:"选择权限"},null,8,["modelValue"])]),_:1},8,["show","theme-mode"])]),_:1},8,["theme-mode"])]),_:1},8,["theme-mode"])]),_:1},8,["modelValue","theme-mode"]),n("div",Z,[r(fe,{type:"primary",size:"large",block:"",loading:G.value,disabled:!re.value,onClick:he,class:"create-button"},{default:m(()=>[...o[14]||(o[14]=[g(" 创建智能体 ",-1)])]),_:1},8,["loading","disabled"])]),r(U,{modelValue:J.value,"onUpdate:modelValue":o[12]||(o[12]=e=>J.value=e),title:"选择发音人",height:se.value,"selected-speaker-id":ne.speechConfig?.speakerConfig?.speaker?.id,"theme-mode":e.themeMode,onConfirm:pe,onClose:o[13]||(o[13]=e=>J.value=!1)},null,8,["modelValue","height","selected-speaker-id","theme-mode"])],2)}}}),[["__scopeId","data-v-4243fd2e"]]),G=w(a({__name:"create",setup(a){const s=h(),{t:i}=j(),n=t("auto");o(()=>"dark"===n.value||"light"!==n.value&&(!("undefined"==typeof window||!window.matchMedia)&&window.matchMedia("(prefers-color-scheme: dark)").matches));const d=e=>{console.log("智能体创建成功:",e),v({message:i("agent.create.successMessage"),type:"success",duration:2e3}),setTimeout(()=>{s.push("/agent/list")},2e3)},c=()=>{console.log("智能体创建取消"),v({message:i("agent.create.cancelMessage"),type:"fail",duration:1500}),setTimeout(()=>{s.back()},1500)};return(a,o)=>{const t=e;return l(),p(t,{class:"agent-create-page"},{default:m(()=>[r(E,{onAgentCreated:d,onAgentCanceled:c,"theme-mode":n.value,class:"agent-create-component"},null,8,["theme-mode"])]),_:1})}}}),[["__scopeId","data-v-860cdc7d"]]);export{G as default};
