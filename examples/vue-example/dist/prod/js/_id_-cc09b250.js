import{m as e,r as a,an as s,aw as t,Q as r,X as o,I as i,U as l,a1 as n,a2 as p,z as c,w as u,s as d,d as m,L as g,B as v,P as f,_ as y,aN as h}from"./index-2cafbb5e.js";/* empty css              */import{C as b}from"./index-6f80587d.js";import{k,r as w,a as j,w as x,t as C,v as _,j as $,c as J,Q as S,R as z,a0 as I,a4 as V,S as q,U as T,$ as U,F as A,Y as B,Z as M,W as H,X as P,a3 as E,O as X,b as L,a1 as O,u as R}from"./vue-vendor-fce65f55.js";import{E as D}from"./index-17b6a864.js";/* empty css              */import{T as F}from"./index-4f03d337.js";import{S as N}from"./sdkwork-qr-code-70d5f87a.js";import{C as Q}from"./index-fa16672a.js";import"./utils-vendor-b5712723.js";import"./use-id-bc367f23.js";const[W,G]=e("notice-bar");const Y=u(k({name:W,props:{text:String,mode:String,color:String,delay:a(1),speed:a(60),leftIcon:String,wrapable:Boolean,background:String,scrollable:{type:Boolean,default:null}},emits:["close","replay"],setup(e,{emit:a,slots:u}){let d,m=0,g=0;const v=w(),f=w(),y=j({show:!0,offset:0,duration:0}),h=s=>{"closeable"===e.mode&&(y.show=!1,a("close",s))},b=()=>{if(u["right-icon"])return u["right-icon"]();const a="closeable"===e.mode?"cross":"link"===e.mode?"arrow":void 0;return a?$(i,{name:a,class:G("right-icon"),onClick:h},null):void 0},k=()=>{y.offset=m,y.duration=0,p(()=>{n(()=>{y.offset=-g,y.duration=(g+m)/+e.speed,a("replay")})})},J=()=>{const a=!1===e.scrollable&&!e.wrapable,s={transform:y.offset?`translateX(${y.offset}px)`:"",transitionDuration:`${y.duration}s`};return $("div",{ref:v,role:"marquee",class:G("wrap")},[$("div",{ref:f,style:s,class:[G("content"),{"van-ellipsis":a}],onTransitionend:k},[u.default?u.default():e.text])])},S=()=>{const{delay:a,speed:s,scrollable:t}=e,r=c(a)?1e3*+a:0;m=0,g=0,y.offset=0,y.duration=0,clearTimeout(d),d=setTimeout(()=>{if(!v.value||!f.value||!1===t)return;const e=l(v).width,a=l(f).width;(t||a>e)&&n(()=>{m=e,g=a,y.offset=-g,y.duration=g/+s})},r)};return s(S),t(S),r("pageshow",S),o({reset:S}),x(()=>[e.text,e.scrollable],S),()=>{const{color:a,wrapable:s,background:t}=e;return C($("div",{role:"alert",class:G({wrapable:s}),style:{color:a,background:t}},[u["left-icon"]?u["left-icon"]():e.leftIcon?$(i,{class:G("left-icon"),name:e.leftIcon},null):void 0,J(),b()]),[[_,y.show]])}}})),Z={key:0,class:"loading-container"},K={key:1,class:"detail-container"},ee={class:"header-section"},ae={class:"avatar-container"},se=["src","alt"],te={key:0,class:"official-badge"},re={key:1,class:"verified-badge"},oe={class:"basic-info"},ie={class:"group-name"},le={class:"group-tags"},ne={class:"stats-info"},pe={class:"stat-item"},ce={class:"stat-value"},ue={class:"stat-item"},de={class:"stat-value"},me={key:0,class:"stat-divider"},ge={key:1,class:"stat-item"},ve={class:"stat-value"},fe={key:0,class:"description-section"},ye={class:"description-text"},he={class:"price-info"},be={key:0,class:"original-price"},ke={class:"current-price"},we={class:"action-section"},je={key:2,class:"error-container"},xe={class:"qr-popup-content"},Ce={key:0,class:"join-success-animation"},_e={class:"success-title"},$e={class:"success-subtitle"},Je={key:1,class:"qr-title"},Se={class:"qr-section"},ze={key:2,class:"qr-blur-tip"},Ie={class:"qr-popup-actions"},Ve="https://picsum.photos/seed/group-default/200/200.jpg",qe=y(k({__name:"sdkwork-group-detail",props:{groupId:{},group:{},loading:{type:Boolean,default:!1},error:{type:Boolean,default:!1},showJoinButton:{type:Boolean,default:!0},themeMode:{default:"auto"}},emits:["join","enter","retry"],setup(e,{expose:a,emit:s}){const t=e,r=s,o=w(!1),l=w(!1),n=w(!1),p=J(()=>`theme-${t.themeMode}`),c=J(()=>t.group?t.group.isJoined?"扫描二维码进入群聊":(t.group.price??0)>0?"扫码付费加入群组":"扫码免费加入群组":"扫描二维码加入群组"),u=J(()=>t.group?(t.group.price??0)>0?"支付成功，已加入群组":"已加入群组":"加入成功"),y=J(()=>t.group?`扫描下方二维码加入「${t.group.name}」`:"扫码进入群聊"),h=e=>e>=1e4?(e/1e4).toFixed(1)+"w":e>=1e3?(e/1e3).toFixed(1)+"k":e.toString(),k=e=>{if(!e)return"未知";return("string"==typeof e?new Date(e):e).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"})},j=e=>{e.target.src=Ve},x=async()=>{if(t.group)if(t.group.isJoined)d("您已加入该群组");else if((t.group.price??0)>0)try{await m({title:"付费入群",message:`加入"${t.group.name}"需要支付 ¥${t.group.price}，是否确认？`}),C()}catch{}else C()},C=()=>{t.group&&(o.value=!0,setTimeout(()=>{o.value=!1,n.value=!0,l.value=!0;const e={...t.group,isJoined:!0};r("join",e),setTimeout(()=>{n.value=!1},1500)},1500))},_=()=>{t.group&&r("enter",t.group)},E=()=>{r("retry")},X=e=>{d("二维码已保存")},L=e=>{d("分享功能待实现")},O=()=>{if(!t.group)return;const e=`https://example.com/group/${t.group.id}`;navigator.clipboard.writeText(e).then(()=>{d("群组链接已复制")}).catch(()=>{d("复制失败，请手动复制")})},R=()=>{l.value=!1,d("欢迎加入群组")};return a({retry:E}),(a,s)=>{const r=g,d=i,m=F,w=Q,C=b,J=v,W=D,G=Y,qe=f;return S(),z("div",{class:P(["sdkwork-group-detail",p.value])},[e.loading?(S(),z("div",Z,[$(r,{size:"24px",vertical:""},{default:I(()=>[...s[2]||(s[2]=[V("加载中...",-1)])]),_:1})])):e.group?(S(),z("div",K,[q("div",ee,[q("div",ae,[q("img",{src:e.group.avatar||Ve,alt:e.group.name,class:"group-avatar",onError:j},null,40,se),e.group.isOfficial?(S(),z("div",te,"官方")):T("",!0),e.group.isVerified?(S(),z("div",re,[$(d,{name:"success"})])):T("",!0)]),q("div",oe,[q("h1",ie,U(e.group.name),1),q("div",le,[(S(!0),z(A,null,B(e.group.tags,e=>(S(),M(m,{key:e,type:"primary",plain:"",class:"group-tag"},{default:I(()=>[V(U(e),1)]),_:2},1024))),128))]),q("div",ne,[q("div",pe,[q("span",ce,U(h(e.group.memberCount)),1),s[3]||(s[3]=q("span",{class:"stat-label"},"成员",-1))]),s[6]||(s[6]=q("div",{class:"stat-divider"},null,-1)),q("div",ue,[q("span",de,U(h(e.group.messageCount)),1),s[4]||(s[4]=q("span",{class:"stat-label"},"消息",-1))]),e.group.maxMembers?(S(),z("div",me)):T("",!0),e.group.maxMembers?(S(),z("div",ge,[q("span",ve,U(e.group.maxMembers),1),s[5]||(s[5]=q("span",{class:"stat-label"},"上限",-1))])):T("",!0)])])]),e.group.description?(S(),z("div",fe,[s[7]||(s[7]=q("h3",{class:"section-title"},"群组简介",-1)),q("p",ye,U(e.group.description),1)])):T("",!0),$(C,{class:"info-section",inset:""},{default:I(()=>{return[$(w,{title:"群组类型",value:(a=e.group.type,{public:"公开群",private:"私密群",official:"官方群"}[a||"public"]||"公开群")},null,8,["value"]),$(w,{title:"创建时间",value:k(e.group.createdAt)},null,8,["value"]),(e.group.price??0)>0?(S(),M(w,{key:0,title:"入群价格"},{value:I(()=>[q("div",he,[e.group.originalPrice&&e.group.originalPrice>e.group.price?(S(),z("span",be," ¥"+U(e.group.originalPrice),1)):T("",!0),q("span",ke,"¥"+U(e.group.price),1)])]),_:1})):(S(),M(w,{key:1,title:"入群价格",value:"免费"})),e.group.isHot?(S(),M(w,{key:2,title:"群组状态"},{value:I(()=>[$(m,{type:"danger"},{default:I(()=>[...s[8]||(s[8]=[V("热门",-1)])]),_:1})]),_:1})):T("",!0)];var a}),_:1}),q("div",we,[e.group.isJoined?(S(),M(J,{key:1,size:"large",round:"",onClick:_,class:"join-button"},{default:I(()=>[...s[9]||(s[9]=[V(" 进入群组 ",-1)])]),_:1})):(S(),M(J,{key:0,type:"primary",size:"large",round:"",loading:o.value,onClick:x,class:"join-button"},{default:I(()=>[V(U((e.group.price??0)>0?`付费加入 (¥${e.group.price})`:"免费加入"),1)]),_:1},8,["loading"]))]),H(a.$slots,"extra",{group:e.group},void 0,!0)])):(S(),z("div",je,[$(W,{image:"error",description:"群组信息加载失败"},{default:I(()=>[$(J,{type:"primary",size:"small",onClick:E},{default:I(()=>[...s[10]||(s[10]=[V(" 重试 ",-1)])]),_:1})]),_:1})])),$(qe,{show:l.value,"onUpdate:show":s[1]||(s[1]=e=>l.value=e),position:"center",style:{width:"90%",maxWidth:"380px"},round:"","safe-area-inset-bottom":""},{default:I(()=>[q("div",xe,[n.value?(S(),z("div",Ce,[$(d,{name:"success",size:"48",color:"#07c160"}),q("h3",_e,U(u.value),1),q("p",$e,U(y.value),1)])):(S(),z("h3",Je,"扫码加入群组")),q("div",Se,[$(N,{title:e.group?.name,description:e.group?.description,avatar:e.group?.avatar,value:t.group?`https://example.com/group/invite/${t.group.id}?source=qr`:"","tip-text":c.value,"show-actions":!0,"allow-save":!0,"allow-share":!0,"allow-copy-link":!0,blur:!e.group?.isJoined&&(e.group?.price??0)>0,onSave:X,onShare:L,onCopyLink:O},null,8,["title","description","avatar","value","tip-text","blur"])]),!e.group?.isJoined&&(e.group?.price??0)>0?(S(),z("div",ze,[$(G,{type:"warning",text:"付费群组需先加入后才能查看完整二维码",background:"#fff7e8",color:"#ed6a0c"}),$(J,{type:"primary",size:"large",round:"",block:"",onClick:x,class:"blur-join-button"},{default:I(()=>[V(U((e.group?.price??0)>0?`付费加入 (¥${e.group?.price??0})`:"免费加入"),1)]),_:1})])):T("",!0),q("div",Ie,[n.value?(S(),M(J,{key:1,type:"primary",size:"small",onClick:R},{default:I(()=>[...s[12]||(s[12]=[V("完成",-1)])]),_:1})):(S(),M(J,{key:0,type:"default",size:"small",onClick:s[0]||(s[0]=e=>l.value=!1)},{default:I(()=>[...s[11]||(s[11]=[V("关闭",-1)])]),_:1}))])])]),_:1},8,["show"])],2)}}}),[["__scopeId","data-v-f92b6860"]]),Te={class:"group-detail-page"},Ue={class:"content"},Ae={key:0,class:"members-preview-section"},Be={class:"members-container"},Me=["src","alt"],He={class:"member-name"},Pe={key:1,class:"announcement-section"},Ee={class:"announcement-content"},Xe={key:2,class:"recommend-section"},Le={class:"recommend-list"},Oe=["onClick"],Re=["src","alt"],De={class:"recommend-info"},Fe={class:"recommend-name"},Ne={class:"recommend-desc"},Qe={class:"recommend-meta"},We={class:"recommend-members"},Ge={key:0,class:"recommend-price"},Ye={key:1,class:"recommend-free"},Ze="https://picsum.photos/seed/user-default/100/100.jpg",Ke=y(k({__name:"[id]",setup(e){const a=E(),s=X(),t=a.params,r=Array.isArray(t.id)?t.id[0]:t.id,o=w(void 0),l=w(!1),n=w(!1),p=w([]),c=w(""),u=w([]),m=async()=>{if(r){l.value=!0,n.value=!1;try{await new Promise(e=>setTimeout(e,800));const e={id:r,name:"前端技术交流群",description:"分享前端技术、讨论最新前端框架、解决技术难题、共同进步的技术交流群组。欢迎各位前端爱好者加入！在这里你可以学到最新的前端技术，解决工作中遇到的技术难题，结识志同道合的前端开发者。",avatar:"https://picsum.photos/seed/frontend-group/200/200.jpg",tags:["前端","技术","交流","React","Vue"],memberCount:3586,maxMembers:5e3,messageCount:128560,price:0,isOfficial:!0,isVerified:!0,isHot:!0,type:"official",createdAt:"2022-01-15"};c.value="本周六晚8点将举办Vue 3.4新特性分享会，欢迎大家参加！另外，群里正在征集优秀的开源项目，有兴趣的同学可以联系管理员。",p.value=[{id:"1",name:"张三",avatar:"https://picsum.photos/seed/user1/100/100.jpg"},{id:"2",name:"李四",avatar:"https://picsum.photos/seed/user2/100/100.jpg"},{id:"3",name:"王五",avatar:"https://picsum.photos/seed/user3/100/100.jpg"},{id:"4",name:"赵六",avatar:"https://picsum.photos/seed/user4/100/100.jpg"},{id:"5",name:"前端小王",avatar:"https://picsum.photos/seed/user5/100/100.jpg"},{id:"6",name:"React专家",avatar:"https://picsum.photos/seed/user6/100/100.jpg"},{id:"7",name:"Vue开发者",avatar:"https://picsum.photos/seed/user7/100/100.jpg"},{id:"8",name:"JS大神",avatar:"https://picsum.photos/seed/user8/100/100.jpg"}],u.value=[{id:"2",name:"设计师创意工坊",description:"UI/UX设计师聚集地，分享设计经验、展示作品、获取反馈。",avatar:"https://picsum.photos/seed/design-group/200/200.jpg",tags:["设计","UI/UX","创意"],memberCount:1923,messageCount:64230,price:19.9,originalPrice:39.9,isVerified:!0,isHot:!0,type:"public",createdAt:"2022-03-20"},{id:"3",name:"产品经理交流圈",description:"产品思维碰撞、需求分析、用户研究、产品规划讨论。",avatar:"https://picsum.photos/seed/pm-group/200/200.jpg",tags:["产品","需求","规划"],memberCount:1245,messageCount:38920,price:0,isVerified:!0,type:"public",createdAt:"2022-05-10"},{id:"4",name:"Java开发精英群",description:"Java技术分享、架构设计、性能优化、面试经验交流。",avatar:"https://picsum.photos/seed/java-group/200/200.jpg",tags:["Java","后端","架构"],memberCount:2890,maxMembers:3e3,messageCount:98760,price:29.9,isVerified:!0,isHot:!0,type:"public",createdAt:"2022-02-28"}],o.value=e}catch(e){console.error("加载群组数据失败:",e),n.value=!0}finally{l.value=!1}}},g=e=>{o.value&&(o.value.isJoined=!0),h("成功加入群组")},f=e=>{d("进入群组聊天")},y=e=>{e.target.src=Ze},k=e=>{e.target.src=Ze},j=()=>{d("查看所有成员")};return L(()=>{m()}),(e,a)=>{const t=i,h=b,w=v;return S(),z("div",Te,[q("div",Ue,[$(qe,{"group-id":R(r),group:o.value,loading:l.value,error:n.value,onJoin:g,onEnter:f,onRetry:m},{extra:I(({group:e})=>[p.value.length>0?(S(),z("div",Ae,[$(h,{inset:"",title:"群组成员",border:!1},{default:I(()=>[q("div",Be,[(S(!0),z(A,null,B(p.value.slice(0,8),(e,a)=>(S(),z("div",{key:e.id,class:"member-avatar"},[q("img",{src:e.avatar||Ze,alt:e.name,onError:y},null,40,Me),q("span",He,U(e.name),1)]))),128)),e.memberCount>8?(S(),z("div",{key:0,class:"member-more",onClick:j},[$(t,{name:"ellipsis"}),q("span",null,U(e.memberCount-8)+"+",1)])):T("",!0)])]),_:2},1024)])):T("",!0),c.value?(S(),z("div",Pe,[$(h,{inset:"",title:"群组公告"},{default:I(()=>[q("div",Ee,[q("p",null,U(c.value),1)])]),_:1})])):T("",!0),u.value.length>0?(S(),z("div",Xe,[$(h,{inset:"",title:"推荐群组",border:!1},{default:I(()=>[q("div",Le,[(S(!0),z(A,null,B(u.value,e=>(S(),z("div",{key:e.id,class:"recommend-item",onClick:a=>{return t=e.id,void s.push(`/group/detail/${t}`);var t}},[q("img",{src:e.avatar||Ze,alt:e.name,class:"recommend-avatar",onError:k},null,40,Re),q("div",De,[q("div",Fe,U(e.name),1),q("div",Ne,U(e.description),1),q("div",Qe,[q("span",We,U(e.memberCount)+"人",1),e.price>0?(S(),z("span",Ge,"¥"+U(e.price),1)):(S(),z("span",Ye,"免费"))])]),$(w,{size:"small",type:"primary",plain:!e.isHot,onClick:O(a=>{var s;(s=e).price>0?d(`加入"${s.name}"需要支付 ¥${s.price}`):d(`已申请加入"${s.name}"`)},["stop"])},{default:I(()=>[V(U(e.isHot?"热门":"加入"),1)]),_:2},1032,["plain","onClick"])],8,Oe))),128))])]),_:1})])):T("",!0)]),_:1},8,["group-id","group","loading","error"])])])}}}),[["__scopeId","data-v-4569bdae"]]);export{Ke as default};
