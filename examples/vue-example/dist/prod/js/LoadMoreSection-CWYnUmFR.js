import{r as e,n as a,c as s,av as t,C as o,D as l,L as n,aw as i,a2 as d,w as u,_ as r}from"./index-TwMLNQLv.js";import{k as c,r as h,c as g,w as p,j as m,n as f,f as v,P as x,R as k,a9 as D,a0 as M,Q as T,U as y,W as w,Z as V,a4 as $,S as _}from"./vue-vendor-BAnrfl1G.js";const[H,B,b]=s("pull-refresh"),S=["pulling","loosing","success"];const L=u(c({name:H,props:{disabled:Boolean,modelValue:Boolean,headHeight:e(50),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:a,successDuration:e(500),animationDuration:e(300)},emits:["change","refresh","update:modelValue"],setup(e,{emit:a,slots:s}){let u;const r=h(),c=h(),v=t(r),x=g({status:"normal",distance:0,duration:0}),k=o(),D=()=>{if(50!==e.headHeight)return{height:`${e.headHeight}px`}},M=()=>"loading"!==x.status&&"success"!==x.status&&!e.disabled,T=(s,t)=>{const o=+(e.pullDistance||e.headHeight);x.distance=s,x.status=t?"loading":0===s?"normal":s<o?"pulling":"loosing",a("change",{status:x.status,distance:s})},y=()=>{const{status:a}=x;return"normal"===a?"":e[`${a}Text`]||b(a)},w=()=>{const{status:e,distance:a}=x;if(s[e])return s[e]({distance:a});const t=[];return S.includes(e)&&t.push(m("div",{class:B("text")},[y()])),"loading"===e&&t.push(m(n,{class:B("loading")},{default:y})),t},V=e=>{u=0===i(v.value),u&&(x.duration=0,k.start(e))},$=e=>{M()&&V(e)},_=()=>{u&&k.deltaY.value&&M()&&(x.duration=+e.animationDuration,"loosing"===x.status?(T(+e.headHeight,!0),a("update:modelValue",!0),f(()=>a("refresh"))):T(0))};return p(()=>e.modelValue,a=>{x.duration=+e.animationDuration,a?T(+e.headHeight,!0):s.success||e.successText?(x.status="success",setTimeout(()=>{T(0)},+e.successDuration)):T(0,!1)}),l("touchmove",a=>{if(M()){u||V(a);const{deltaY:s}=k;k.move(a),u&&s.value>=0&&k.isVertical()&&(d(a),T((a=>{const s=+(e.pullDistance||e.headHeight);return a>s&&(a=a<2*s?s+(a-s)/2:1.5*s+(a-2*s)/4),Math.round(a)})(s.value)))}},{target:c}),()=>{var e;const a={transitionDuration:`${x.duration}ms`,transform:x.distance?`translate3d(0,${x.distance}px, 0)`:""};return m("div",{ref:r,class:B()},[m("div",{ref:c,class:B("track"),style:a,onTouchstartPassive:$,onTouchend:_,onTouchcancel:_},[m("div",{class:B("head"),style:D()},[w()]),null==(e=s.default)?void 0:e.call(s)])])}}})),R=r(c({__name:"sdkwork-pull-refresh",props:{modelValue:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},pullDistance:{default:50},headHeight:{default:50},animationDuration:{default:300},successDuration:{default:500},pullingText:{default:"下拉即可刷新..."},loosingText:{default:"释放即可刷新..."},loadingText:{default:"加载中..."},successText:{default:"刷新成功"},themeMode:{default:"auto"}},emits:["refresh","change","update:modelValue"],setup(e,{expose:a,emit:s}){const t=e,o=s,l=h(t.modelValue),n=h(!1),i=()=>{"dark"===t.themeMode?n.value=!0:"light"===t.themeMode?n.value=!1:"auto"===t.themeMode&&(n.value=!("undefined"==typeof window||!window.matchMedia)&&window.matchMedia("(prefers-color-scheme: dark)").matches)},d=v(()=>n.value?"sdkwork-pull-refresh--dark":"sdkwork-pull-refresh--light"),u=e=>{o("change",e)},r=async()=>{o("refresh")};return a({finish:()=>{l.value=!1}}),p(()=>t.themeMode,i),p(()=>t.modelValue,e=>{l.value=e}),p(l,e=>{o("update:modelValue",e)}),p(l,e=>{o("update:modelValue",e)}),i(),(a,s)=>{const t=L;return T(),x("div",{class:k(["sdkwork-pull-refresh-container",d.value])},[m(t,{modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=e=>l.value=e),disabled:e.disabled,"pull-distance":e.pullDistance,"head-height":e.headHeight,"animation-duration":e.animationDuration,"success-duration":e.successDuration,"pulling-text":e.pullingText,"loosing-text":e.loosingText,"loading-text":e.loadingText,"success-text":e.successText,onRefresh:r,onChange:u,class:"sdkwork-pull-refresh"},D({default:M(()=>[y(a.$slots,"default",{},void 0,!0)]),_:2},[a.$slots.pulling?{name:"pulling",fn:M(({distance:e})=>[y(a.$slots,"pulling",{distance:e},void 0,!0)]),key:"0"}:void 0,a.$slots.loosing?{name:"loosing",fn:M(({distance:e})=>[y(a.$slots,"loosing",{distance:e},void 0,!0)]),key:"1"}:void 0,a.$slots.loading?{name:"loading",fn:M(()=>[y(a.$slots,"loading",{},void 0,!0)]),key:"2"}:void 0,a.$slots.success?{name:"success",fn:M(()=>[y(a.$slots,"success",{},void 0,!0)]),key:"3"}:void 0]),1032,["modelValue","disabled","pull-distance","head-height","animation-duration","success-duration","pulling-text","loosing-text","loading-text","success-text"])],2)}}}),[["__scopeId","data-v-e48733fe"]]),j={key:1,class:"load-more-tip"},C={key:1,class:"no-more-section"},I=r(c({__name:"LoadMoreSection",props:{hasMore:{type:Boolean},loadingMore:{type:Boolean},dataList:{},showNoMoreData:{type:Boolean,default:!1}},emits:["load"],setup(e,{expose:a,emit:s}){const t=e,o=s,l=()=>{t.loadingMore||o("load")};return a({loadMoreRef:h()}),(a,s)=>{const t=n;return e.hasMore?(T(),x("div",{key:0,ref:"loadMoreRef",class:"load-more-section",onClick:l},[e.loadingMore?(T(),V(t,{key:0,size:"24px"},{default:M(()=>[...s[0]||(s[0]=[$("加载中...",-1)])]),_:1})):(T(),x("div",j,"点击加载更多"))],512)):e.showNoMoreData&&e.dataList.length>0?(T(),x("div",C,[...s[1]||(s[1]=[_("div",{class:"no-more-tip"},"没有更多数据了",-1)])])):w("",!0)}}}),[["__scopeId","data-v-4e175053"]]);export{I as L,R as _};
