import{x as e,M as t,y as a,I as l,B as s,_ as i,L as o,s as d,f as r,a as c}from"./index-3Iq02xX1.js";/* empty css              */import{T as n}from"./index-i1mINqgr.js";import{S as u}from"./sdkwork-api-list-p68xGu2z.js";import{k as p,P as v,Q as m,S as f,W as g,$ as y,R as h,j as S,a4 as k,Z as b,a1 as w,a0 as $,O as I,a as _,f as D,w as C,u as L,o as E,F as T,Y as B}from"./vue-vendor-BOogp7Xw.js";import"./utils-vendor-WEzSe-CR.js";import"./index-Bmpmgbhp.js";import"./index-BoeRvyAS.js";import"./use-tab-status-C8BruCQu.js";import"./shared-B_4JvhtZ.js";import"./sdkwork-search-bar-1YXth7fK.js";import"./sdkwork-icon-Dhm3xmJ9.js";import"./index-DVvwYFvp.js";import"./use-id-Dx2a3-Lt.js";import"./ListItem-BDzKOUqD.js";class P extends e.BaseService{constructor(){super(t.create(a.VideoManager))}}const j={class:"video-cover"},A=["src","alt"],x={key:0,class:"video-duration"},z={class:"play-overlay"},M={class:"video-info"},F=["title"],O={key:0,class:"video-description"},N={class:"video-meta"},K={key:0,class:"meta-item"},R={key:1,class:"meta-item"},G={key:2,class:"meta-item"},U={key:1,class:"video-actions"},V=i(p({__name:"VideoListItem",props:{video:{},index:{default:0},selected:{type:Boolean,default:!1},selectable:{type:Boolean,default:!1},deletable:{type:Boolean,default:!1}},emits:["select","delete","click"],setup(e,{emit:t}){const a=e,i=t;I();const o=e=>{if(!e)return"00:00";const t=Math.floor(e/3600),a=Math.floor(e%3600/60),l=Math.floor(e%60);return t>0?`${t.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`:`${a.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`},d=e=>{if(!e)return"0 B";let t="string"==typeof e?parseFloat(e):e;const a=["B","KB","MB","GB","TB"];let l=0;for(;t>=1024&&l<a.length-1;)t/=1024,l++;return`${t.toFixed(1)} ${a[l]}`},r=e=>{if(!e)return"";const t=new Date(e),a=(new Date).getTime()-t.getTime(),l=Math.floor(a/864e5);return 0===l?"今天":1===l?"昨天":l<7?`${l}天前`:t.toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric"})},c=e=>({COMPLETED:"已完成",PROCESSING:"处理中",FAILED:"失败",DELETED:"已删除",DEFAULT:"默认"}[e]||"未知"),n=()=>{i("click",a.video)},u=()=>{a.selectable&&i("select",a.video)},p=()=>{a.deletable&&i("delete",a.video)};return(t,a)=>{const i=l,I=s;return m(),v("div",{class:h(["video-list-item",{"video-item-selected":e.selected}]),onClick:n},[f("div",j,[f("img",{src:e.video.thumbnailUrl||"/images/video-placeholder.jpg",alt:e.video.title,class:"cover-image",loading:"lazy"},null,8,A),e.video.duration?(m(),v("div",x,y(o(e.video.duration)),1)):g("",!0),f("div",{class:h(["video-status",(_=e.video.status,{COMPLETED:"status-completed",PROCESSING:"status-processing",FAILED:"status-failed",DELETED:"status-deleted",DEFAULT:"status-default"}[_]||"status-default")])},y(c(e.video.status)),3),f("div",z,[S(i,{name:"play-circle-o",size:"32",color:"white"})])]),f("div",M,[f("h3",{class:"video-title",title:e.video.title},y(e.video.title||"未命名视频"),9,F),e.video.description?(m(),v("p",O,y(e.video.description),1)):g("",!0),f("div",N,[e.video.resolution?(m(),v("span",K,[S(i,{name:"video-o"}),k(" "+y(e.video.resolution),1)])):g("",!0),e.video.fileSize?(m(),v("span",R,[S(i,{name:"file-o"}),k(" "+y(d(e.video.fileSize)),1)])):g("",!0),e.video.createdAt?(m(),v("span",G,[S(i,{name:"clock-o"}),k(" "+y(r(e.video.createdAt)),1)])):g("",!0)]),e.selectable||e.deletable?(m(),v("div",U,[e.selectable?(m(),b(I,{key:0,type:e.selected?"primary":"default",onClick:w(u,["stop"]),class:"action-btn"},{default:$(()=>[k(y(e.selected?"已选":"选择"),1)]),_:1},8,["type"])):g("",!0),e.deletable?(m(),b(I,{key:1,type:"danger",plain:"",onClick:w(p,["stop"]),class:"action-btn"},{default:$(()=>[...a[0]||(a[0]=[k(" 删除 ",-1)])]),_:1})):g("",!0)])):g("",!0)])],2);var _}}}),[["__scopeId","data-v-f71f2476"]]),Y={class:"empty-video"},H={class:"loading-video"},Q={class:"list-header"},W={key:0,class:"list-footer"},Z=i(p({__name:"sdkwork-video-list",props:{api:{},params:{},selectable:{type:Boolean,default:!1},deletable:{type:Boolean,default:!1},searchable:{type:Boolean,default:!0},pageSize:{default:10},itemKey:{default:"id"},itemTitleField:{default:"title"},itemDescriptionField:{default:"description"},autoLoad:{type:Boolean,default:!0},defaultKeyword:{default:""}},emits:["select","delete","search","load","click","batch-action","refresh"],setup(e,{expose:t,emit:a}){const i=e,c=a,p=_(),h=new P,w=_({keyword:i.defaultKeyword,...i.params}),I=_(0),E=_(0),T=_(0),B=_(0),j=_([]),A=D(()=>j.value.filter(e=>"PROCESSING"===e.status).length),x=i.api?i.api:async e=>{try{const{keyword:t,...a}=w.value,l={keyword:t||"",...a};return await h.listByPage(l,e)}catch(t){throw console.error("获取视频列表失败:",t),t}},z=e=>{c("select",e),R(),d(`已选择: ${e.title}`)},M=async e=>{try{await r({title:"确认删除",message:`确定要删除视频"${e.title}"吗？此操作不可撤销。`}),i.api?(c("delete",e),d("删除请求已发送")):(await h.delete(e.id),c("delete",e),d("视频删除成功"),p.value?.refresh())}catch(t){console.log("取消删除或删除失败")}},F=e=>{c("click",e)},O=e=>{w.value.keyword=e,c("search",e)},N=e=>{I.value=e.total||0,T.value=e.pageable.pageNumber||0,B.value=e.total/(e.pageable.pageSize||10)||0,c("load",e)},K=()=>{0!==j.value.length?(c("batch-action",j.value),d(`已选择 ${j.value.length} 个视频进行批量操作`)):d("请先选择视频")},R=()=>{const e=p.value?.getSelectedItems()||[];j.value=e,E.value=e.length};return C(E,()=>{R()}),C(()=>i.params,e=>{w.value={...w.value,...e}},{deep:!0}),C(()=>i.defaultKeyword,e=>{w.value.keyword=e}),t({refresh:()=>p.value?.refresh(),loadMore:()=>p.value?.loadMore(),getData:()=>p.value?.getData()||[],getSelectedItems:()=>p.value?.getSelectedItems()||[],clearSelected:()=>{p.value?.clearSelected(),j.value=[],E.value=0},setSelectedItems:e=>{p.value?.setSelectedItems(e),j.value=e,E.value=e.length},setKeyword:e=>{w.value.keyword=e,p.value?.refresh()},getService:()=>h,search:e=>{O(e)}}),(t,a)=>{const i=l,d=o,r=n,c=s;return m(),b(u,{api:L(x),params:w.value,selectable:e.selectable,deletable:e.deletable,searchable:e.searchable,"page-size":e.pageSize,"item-key":e.itemKey,"item-title-field":e.itemTitleField,"item-description-field":e.itemDescriptionField,onSelect:z,onDelete:M,onSearch:O,onLoad:N},{default:$(({item:t,index:a,selected:l})=>[S(V,{video:t,index:a,selected:l,selectable:e.selectable,deletable:e.deletable,onSelect:z,onDelete:M,onClick:F},null,8,["video","index","selected","selectable","deletable"])]),empty:$(()=>[f("div",Y,[S(i,{name:"video-o",size:"48"}),a[0]||(a[0]=f("p",null,"暂无视频",-1))])]),loading:$(()=>[f("div",H,[S(d,{size:"24px"}),a[1]||(a[1]=f("span",null,"加载视频中...",-1))])]),header:$(()=>[f("div",Q,[S(r,{type:"primary"},{default:$(()=>[k("视频总数: "+y(I.value),1)]),_:1}),S(r,{type:"success"},{default:$(()=>[k("选中: "+y(E.value),1)]),_:1}),S(r,{type:"warning"},{default:$(()=>[k("当前页: "+y(T.value+1)+"/"+y(B.value),1)]),_:1}),A.value>0?(m(),b(r,{key:0,type:"danger"},{default:$(()=>[k("处理中: "+y(A.value),1)]),_:1})):g("",!0)])]),footer:$(()=>[E.value>0?(m(),v("div",W,[S(c,{type:"primary",block:"",onClick:K},{default:$(()=>[k(" 批量操作 ("+y(E.value)+") ",1)]),_:1})])):g("",!0)]),_:1},8,["api","params","selectable","deletable","searchable","page-size","item-key","item-title-field","item-description-field"])}}}),[["__scopeId","data-v-6ca128d1"]]),q={class:"video-list-demo"},J={class:"demo-controls"},X={class:"control-panel"},ee={class:"video-list-section"},te={class:"result-panel"},ae={class:"log-container"},le={class:"log-time"},se={class:"log-message"},ie=i(p({__name:"video-list-demo",setup(e){const t=_(""),a=_([]),l=_(),i=_({category:"demo",status:"published"}),o=async e=>{r("API","调用自定义API方法"),await new Promise(e=>setTimeout(e,300));const t=e.pageNumber||0,a=e.pageSize||10,l=t*a,s=[];for(let i=0;i<a&&l+i<25;i++){const e=l+i+1;s.push({id:`video-${e}`,title:`演示视频 ${e}`,description:`这是第 ${e} 个演示视频的描述信息，用于展示API模式的效果`,duration:Math.floor(600*Math.random())+60})}return{content:s,totalElements:25,totalPages:Math.ceil(25/a),number:t,pageSize:a,first:0===t,last:t>=Math.ceil(25/a)-1,empty:0===s.length}},r=(e,t)=>{a.value.unshift({time:(new Date).toLocaleTimeString(),type:e,message:t}),a.value.length>20&&a.value.pop()},n=e=>{r("API",`选择了视频: ${e.title}`),d(`选择了视频: ${e.title}`)},u=e=>{r("API",`删除视频请求: ${e.title}`),d("删除请求已发送，请父组件处理")},p=e=>{r("API",`搜索关键词: ${e}`),t.value=e},g=e=>{},b=e=>{r("API",`批量操作 ${e.length} 个视频`),c({title:"批量操作",message:`将对 ${e.length} 个视频执行批量操作，请父组件处理`})},w=e=>{r("CLICK",`点击视频: ${e.title}`),d(`点击了视频: ${e.title}`)},I=()=>{l.value?.refresh(),r("CONTROL","刷新列表")},D=()=>{l.value?.clearSelected(),r("CONTROL","清空选择")},C=()=>{const e=l.value?.getData()||[],t=l.value?.getSelectedItems()||[];r("STATS",`数据 ${e.length} 条，选中 ${t.length} 条`),d(`数据 ${e.length} 条，选中 ${t.length} 条`)};return E(()=>{r("SYSTEM","视频列表演示页面已加载")}),(e,d)=>{const r=s;return m(),v("div",q,[d[4]||(d[4]=f("div",{class:"demo-header"},[f("h1",null,"视频列表组件演示"),f("p",null,"API模式演示 - 使用模拟数据")],-1)),f("div",J,[f("div",X,[S(r,{type:"primary",onClick:I},{default:$(()=>[...d[0]||(d[0]=[k("刷新列表",-1)])]),_:1}),S(r,{onClick:D},{default:$(()=>[...d[1]||(d[1]=[k("清空选择",-1)])]),_:1}),S(r,{type:"warning",onClick:C},{default:$(()=>[...d[2]||(d[2]=[k("显示统计",-1)])]),_:1})])]),f("div",ee,[S(Z,{ref_key:"apiVideoListRef",ref:l,api:o,params:i.value,selectable:!0,deletable:!0,searchable:!0,"pageNumber-pageSize":10,"default-keyword":t.value,onSelect:n,onDelete:u,onClick:w,onSearch:p,onLoad:g,onBatchAction:b},null,8,["params","default-keyword"])]),f("div",te,[d[3]||(d[3]=f("h3",null,"操作日志",-1)),f("div",ae,[(m(!0),v(T,null,B(a.value,(e,t)=>(m(),v("div",{key:t,class:"log-item"},[f("span",le,y(e.time),1),f("span",{class:h(["log-type",e.type])},y(e.type),3),f("span",se,y(e.message),1)]))),128))])])])}}}),[["__scopeId","data-v-82c00572"]]);export{ie as default};
