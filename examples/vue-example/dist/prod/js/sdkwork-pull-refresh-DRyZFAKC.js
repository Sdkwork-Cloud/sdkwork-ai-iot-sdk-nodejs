import{r as e,n as s,c as a,at as t,E as l,F as o,L as n,a2 as i,au as u,w as d,_ as r}from"./index-C5cIQ-JB.js";import{k as c,r as h,c as g,w as m,j as p,n as f,f as v,P as x,Q as k,R as T,a9 as D,a0 as V,U as w}from"./vue-vendor-BAnrfl1G.js";const[$,y,H]=a("pull-refresh"),M=["pulling","loosing","success"];const _=d(c({name:$,props:{disabled:Boolean,modelValue:Boolean,headHeight:e(50),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:s,successDuration:e(500),animationDuration:e(300)},emits:["change","refresh","update:modelValue"],setup(e,{emit:s,slots:a}){let d;const r=h(),c=h(),v=t(r),x=g({status:"normal",distance:0,duration:0}),k=l(),T=()=>{if(50!==e.headHeight)return{height:`${e.headHeight}px`}},D=()=>"loading"!==x.status&&"success"!==x.status&&!e.disabled,V=(a,t)=>{const l=+(e.pullDistance||e.headHeight);x.distance=a,x.status=t?"loading":0===a?"normal":a<l?"pulling":"loosing",s("change",{status:x.status,distance:a})},w=()=>{const{status:s}=x;return"normal"===s?"":e[`${s}Text`]||H(s)},$=()=>{const{status:e,distance:s}=x;if(a[e])return a[e]({distance:s});const t=[];return M.includes(e)&&t.push(p("div",{class:y("text")},[w()])),"loading"===e&&t.push(p(n,{class:y("loading")},{default:w})),t},_=e=>{d=0===u(v.value),d&&(x.duration=0,k.start(e))},b=e=>{D()&&_(e)},B=()=>{d&&k.deltaY.value&&D()&&(x.duration=+e.animationDuration,"loosing"===x.status?(V(+e.headHeight,!0),s("update:modelValue",!0),f(()=>s("refresh"))):V(0))};return m(()=>e.modelValue,s=>{x.duration=+e.animationDuration,s?V(+e.headHeight,!0):a.success||e.successText?(x.status="success",setTimeout(()=>{V(0)},+e.successDuration)):V(0,!1)}),o("touchmove",s=>{if(D()){d||_(s);const{deltaY:a}=k;k.move(s),d&&a.value>=0&&k.isVertical()&&(i(s),V((s=>{const a=+(e.pullDistance||e.headHeight);return s>a&&(s=s<2*a?a+(s-a)/2:1.5*a+(s-2*a)/4),Math.round(s)})(a.value)))}},{target:c}),()=>{var e;const s={transitionDuration:`${x.duration}ms`,transform:x.distance?`translate3d(0,${x.distance}px, 0)`:""};return p("div",{ref:r,class:y()},[p("div",{ref:c,class:y("track"),style:s,onTouchstartPassive:b,onTouchend:B,onTouchcancel:B},[p("div",{class:y("head"),style:T()},[$()]),null==(e=a.default)?void 0:e.call(a)])])}}})),b=r(c({__name:"sdkwork-pull-refresh",props:{modelValue:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},pullDistance:{default:50},headHeight:{default:50},animationDuration:{default:300},successDuration:{default:500},pullingText:{default:"下拉即可刷新..."},loosingText:{default:"释放即可刷新..."},loadingText:{default:"加载中..."},successText:{default:"刷新成功"},themeMode:{default:"auto"}},emits:["refresh","change","update:modelValue"],setup(e,{expose:s,emit:a}){const t=e,l=a,o=h(t.modelValue),n=h(!1),i=()=>{"dark"===t.themeMode?n.value=!0:"light"===t.themeMode?n.value=!1:"auto"===t.themeMode&&(n.value=!("undefined"==typeof window||!window.matchMedia)&&window.matchMedia("(prefers-color-scheme: dark)").matches)},u=v(()=>n.value?"sdkwork-pull-refresh--dark":"sdkwork-pull-refresh--light"),d=e=>{l("change",e)},r=async()=>{l("refresh")};return s({finish:()=>{o.value=!1}}),m(()=>t.themeMode,i),m(()=>t.modelValue,e=>{o.value=e}),m(o,e=>{l("update:modelValue",e)}),m(o,e=>{l("update:modelValue",e)}),i(),(s,a)=>{const t=_;return k(),x("div",{class:T(["sdkwork-pull-refresh-container",u.value])},[p(t,{modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=e=>o.value=e),disabled:e.disabled,"pull-distance":e.pullDistance,"head-height":e.headHeight,"animation-duration":e.animationDuration,"success-duration":e.successDuration,"pulling-text":e.pullingText,"loosing-text":e.loosingText,"loading-text":e.loadingText,"success-text":e.successText,onRefresh:r,onChange:d,class:"sdkwork-pull-refresh"},D({default:V(()=>[w(s.$slots,"default",{},void 0,!0)]),_:2},[s.$slots.pulling?{name:"pulling",fn:V(({distance:e})=>[w(s.$slots,"pulling",{distance:e},void 0,!0)]),key:"0"}:void 0,s.$slots.loosing?{name:"loosing",fn:V(({distance:e})=>[w(s.$slots,"loosing",{distance:e},void 0,!0)]),key:"1"}:void 0,s.$slots.loading?{name:"loading",fn:V(()=>[w(s.$slots,"loading",{},void 0,!0)]),key:"2"}:void 0,s.$slots.success?{name:"success",fn:V(()=>[w(s.$slots,"success",{},void 0,!0)]),key:"3"}:void 0]),1032,["modelValue","disabled","pull-distance","head-height","animation-duration","success-duration","pulling-text","loosing-text","loading-text","success-text"])],2)}}}),[["__scopeId","data-v-e48733fe"]]);export{b as _};
