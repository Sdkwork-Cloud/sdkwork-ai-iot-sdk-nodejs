import{_ as e}from"./sdkwork-popup-Bablj-VP.js";import{a,_ as l}from"./sdkwork-cell-group-D43p2rxJ.js";import{aQ as s,s as t,B as o,I as n,aR as i,f as u,_ as c}from"./index-BkXo8abR.js";import{S as r}from"./index-BKNgSeMz.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */import{k as d,r as v,f as m,w as p,b as g,o as h,P as y,Q as k,S as f,j as _,W as b,a0 as w,a4 as x,R as V,$ as z,F as C,Y as j,Z as S}from"./vue-vendor-Caw1HGjZ.js";import{F as U}from"./index-DMcr__ih.js";import{R as I,a as R}from"./index-zDBISY3v.js";const $={class:"sdkwork-speech-to-text"},F={class:"stt-container"},M={class:"result-section"},B={class:"section-header"},D={class:"result-actions"},E={class:"result-content"},K={class:"recognition-status"},N={class:"status-text"},P={key:0,class:"volume-indicator"},Q={class:"volume-bars"},T={class:"volume-text"},W={class:"control-section"},G={class:"control-buttons"},H={key:0,class:"recording-controls"},J={key:0,class:"recording-info"},O={class:"recording-time"},X={class:"recording-size"},Y={class:"settings-section"},Z={class:"selected-language"},q={class:"slider-value"},A={class:"popup-header"},L={key:0,class:"history-section"},ee={class:"section-header"},ae={class:"history-list"},le=c(d({__name:"sdkwork-speech-to-text",emits:["recognition-start","recognition-stop","recognition-error","recognition-complete"],setup(c,{emit:d}){const le=d,se=v(""),te=v(!1),oe=v(!1),ne=v(!1),ie=v(""),ue=v(0),ce=v(0),re=v({code:"zh-CN",name:"中文（普通话）"}),de=v("continuous"),ve=v(!0),me=v(!0),pe=v(3),ge=v(!1),he=v([]),ye=[{code:"zh-CN",name:"中文（普通话）"},{code:"zh-TW",name:"中文（台湾）"},{code:"zh-HK",name:"中文（香港）"},{code:"en-US",name:"英语（美国）"},{code:"en-GB",name:"英语（英国）"},{code:"ja-JP",name:"日语"},{code:"ko-KR",name:"韩语"},{code:"fr-FR",name:"法语"},{code:"de-DE",name:"德语"},{code:"es-ES",name:"西班牙语"}],{isSupported:ke,isFinal:fe,result:_e,error:be,start:we,stop:xe}=s({continuous:m(()=>"continuous"===de.value).value});let Ve=null,ze=null;const Ce=m(()=>!!ke||(t("您的浏览器不支持语音识别功能"),!1)),je=async()=>{Ce.value&&(te.value?await Ue():await Se())},Se=async()=>{try{ne.value=!0,ie.value="",ue.value=0,await we(),te.value=!0,oe.value=!1,Be(),Ee(),le("recognition-start"),t("开始语音识别")}catch(e){ie.value="语音识别启动失败",le("recognition-error",e),t("语音识别启动失败")}finally{ne.value=!1}},Ue=async()=>{try{await xe(),te.value=!1,oe.value=!1,De(),Ke(),se.value.trim()&&Ne(),le("recognition-stop",se.value),le("recognition-complete",se.value),t("语音识别已停止")}catch(e){ie.value="停止语音识别失败",le("recognition-error",e)}},Ie=()=>{oe.value=!0,De(),Ke(),t("语音识别已暂停")},Re=()=>{oe.value=!1,Be(),Ee(),t("语音识别已继续")},$e=()=>{se.value="",t("已清空识别结果")},Fe=async()=>{try{await navigator.clipboard.writeText(se.value),t("已复制到剪贴板")}catch(e){t("复制失败")}},Me=async()=>{try{await u({title:"确认清空",message:"确定要清空所有识别历史记录吗？"}),he.value=[],t("历史记录已清空")}catch{}},Be=()=>{Ve=window.setInterval(()=>{ue.value++},1e3)},De=()=>{Ve&&(clearInterval(Ve),Ve=null)},Ee=()=>{ze=window.setInterval(()=>{ce.value=Math.floor(5*Math.random())+1},200)},Ke=()=>{ze&&(clearInterval(ze),ze=null),ce.value=0},Ne=()=>{he.value.unshift({text:se.value,timestamp:Date.now()}),he.value.length>50&&(he.value=he.value.slice(0,50))},Pe=e=>{const a=e%60;return`${Math.floor(e/60).toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`};return p(_e,e=>{e&&(se.value=e,fe&&"single"===de.value&&Ue())}),p(be,e=>{e&&(ie.value=e.message,t(`识别错误: ${e.message}`))}),g(()=>{Ce.value||t("您的浏览器不支持语音识别功能")}),h(()=>{De(),Ke(),te.value&&xe()}),(s,u)=>{const c=o,d=U,v=n,m=a,p=R,g=I,h=r,le=i,ke=l,fe=e;return k(),y("div",$,[f("div",F,[f("div",M,[f("div",B,[u[11]||(u[11]=f("h3",{class:"section-title"},"识别结果",-1)),f("div",D,[_(c,{type:"default",size:"small",onClick:$e,disabled:!se.value,class:"clear-btn"},{default:w(()=>[...u[9]||(u[9]=[x(" 清空 ",-1)])]),_:1},8,["disabled"]),_(c,{type:"primary",size:"small",onClick:Fe,disabled:!se.value,class:"copy-btn"},{default:w(()=>[...u[10]||(u[10]=[x(" 复制 ",-1)])]),_:1},8,["disabled"])])]),f("div",E,[_(d,{modelValue:se.value,"onUpdate:modelValue":u[0]||(u[0]=e=>se.value=e),type:"textarea",rows:"6",placeholder:"识别结果将显示在这里...",readonly:"",class:"result-textarea"},null,8,["modelValue"]),f("div",K,[f("div",{class:V(["status-indicator",{active:te.value,error:ie.value}])},[_(v,{name:ie.value?"warning":te.value?"volume":"volume-o",class:"status-icon"},null,8,["name"]),f("span",N,z(ie.value?"识别错误":te.value?"正在识别中...":"等待语音输入"),1)],2),te.value?(k(),y("div",P,[f("div",Q,[(k(),y(C,null,j(5,e=>f("div",{key:e,class:V(["volume-bar",{active:e<=ce.value}])},null,2)),64))]),f("span",T,"音量: "+z(20*ce.value)+"%",1)])):b("",!0)])])]),f("div",W,[u[14]||(u[14]=f("div",{class:"section-header"},[f("h3",{class:"section-title"},"语音控制")],-1)),f("div",G,[_(c,{type:te.value?"danger":"primary",size:"large",loading:ne.value,onClick:je,class:"recognition-btn"},{default:w(()=>[_(v,{name:te.value?"pause":"play"},null,8,["name"]),x(" "+z(te.value?"停止识别":"开始识别"),1)]),_:1},8,["type","loading"]),te.value?(k(),y("div",H,[_(c,{type:"warning",size:"small",onClick:Ie,disabled:!te.value||oe.value,class:"pause-btn"},{default:w(()=>[_(v,{name:"pause"}),u[12]||(u[12]=x(" 暂停 ",-1))]),_:1},8,["disabled"]),_(c,{type:"success",size:"small",onClick:Re,disabled:!oe.value,class:"resume-btn"},{default:w(()=>[_(v,{name:"play"}),u[13]||(u[13]=x(" 继续 ",-1))]),_:1},8,["disabled"])])):b("",!0)]),te.value?(k(),y("div",J,[f("div",O,[_(v,{name:"clock"}),x(" 录音时长: "+z(Pe(ue.value)),1)]),f("div",X,[_(v,{name:"graph"}),x(" 识别字数: "+z(se.value.length),1)])])):b("",!0)]),f("div",Y,[u[17]||(u[17]=f("div",{class:"section-header"},[f("h3",{class:"section-title"},"识别设置")],-1)),_(ke,null,{default:w(()=>[_(m,{title:"识别语言",center:"","is-link":"",onClick:u[1]||(u[1]=e=>ge.value=!0)},{value:w(()=>[f("div",Z,[_(v,{name:"globe"}),x(" "+z(re.value.name),1)])]),_:1}),_(m,{title:"识别模式",center:""},{value:w(()=>[_(g,{modelValue:de.value,"onUpdate:modelValue":u[2]||(u[2]=e=>de.value=e),direction:"horizontal"},{default:w(()=>[_(p,{name:"continuous"},{default:w(()=>[...u[15]||(u[15]=[x("连续识别",-1)])]),_:1}),_(p,{name:"single"},{default:w(()=>[...u[16]||(u[16]=[x("单次识别",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),_(m,{title:"自动标点",center:""},{value:w(()=>[_(h,{modelValue:ve.value,"onUpdate:modelValue":u[3]||(u[3]=e=>ve.value=e),size:"20"},null,8,["modelValue"])]),_:1}),_(m,{title:"静音检测",center:""},{value:w(()=>[_(h,{modelValue:me.value,"onUpdate:modelValue":u[4]||(u[4]=e=>me.value=e),size:"20"},null,8,["modelValue"])]),_:1}),me.value?(k(),S(m,{key:0,title:"静音阈值",center:""},{value:w(()=>[_(le,{modelValue:pe.value,"onUpdate:modelValue":u[5]||(u[5]=e=>pe.value=e),min:1,max:10,step:1,class:"threshold-slider"},{button:w(()=>[f("div",q,z(pe.value)+"秒",1)]),_:1},8,["modelValue"])]),_:1})):b("",!0)]),_:1})])]),_(fe,{show:ge.value,"onUpdate:show":u[8]||(u[8]=e=>ge.value=e),position:"bottom",round:"",class:"language-popup"},{default:w(()=>[f("div",A,[u[19]||(u[19]=f("h3",{class:"popup-title"},"选择识别语言",-1)),_(c,{type:"primary",size:"small",onClick:u[6]||(u[6]=e=>ge.value=!1)},{default:w(()=>[...u[18]||(u[18]=[x(" 确定 ",-1)])]),_:1})]),_(g,{modelValue:re.value.code,"onUpdate:modelValue":u[7]||(u[7]=e=>re.value.code=e)},{default:w(()=>[_(ke,null,{default:w(()=>[(k(),y(C,null,j(ye,e=>_(m,{key:e.code,title:e.name,clickable:"",onClick:a=>(e=>{re.value=e,ge.value=!1,t(`已切换到${e.name}`)})(e)},{"right-icon":w(()=>[_(p,{name:e.code},null,8,["name"])]),_:2},1032,["title","onClick"])),64))]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["show"]),he.value.length>0?(k(),y("div",L,[f("div",ee,[u[21]||(u[21]=f("h3",{class:"section-title"},"识别历史",-1)),_(c,{type:"default",size:"small",onClick:Me,class:"clear-history-btn"},{default:w(()=>[...u[20]||(u[20]=[x(" 清空历史 ",-1)])]),_:1})]),f("div",ae,[(k(!0),y(C,null,j(he.value.slice(0,5),(e,a)=>(k(),S(m,{key:a,title:Pe(e.timestamp),value:e.text.substring(0,50)+(e.text.length>50?"...":""),clickable:"",onClick:a=>(e=>{se.value=e.text,t("已加载历史记录")})(e)},{"right-icon":w(()=>[_(v,{name:"arrow"})]),_:1},8,["title","value","onClick"]))),128))])])):b("",!0)])}}}),[["__scopeId","data-v-66cac5bf"]]);export{le as S};
