import{_ as e,E as a,L as l}from"./LoadMoreSection-CnWalSP1.js";import{k as t,f as i,P as s,Q as o,R as d,W as n,S as c,j as r,a1 as p,a0 as u,U as m,r as f,w as v,b as g,n as b,o as h,Z as y,u as S,i as x,ac as k,ad as _,F as w,Y as F,V as $,X as j}from"./vue-vendor-CnVaDBlt.js";import{D as I,u as D,S as z}from"./shared-Xg0sfMNA.js";import{B,I as L,_ as P}from"./index-CJyFKuKg.js";/* empty css              *//* empty css              *//* empty css              */import{C as M}from"./index-DsZzsfux.js";import{L as R}from"./LoadingSection-BwtXHJU1.js";const T={key:0,class:"selection-overlay"},K={key:1,class:"delete-overlay"},V={class:"waterfall-item-content"},C=P(t({__name:"WaterfallItem",props:{item:{},index:{},selectable:{type:Boolean,default:!1},deletable:{type:Boolean,default:!1},isSelected:{type:Boolean,default:!1},itemKey:{default:"id"},itemTitleField:{default:"name"},itemDescriptionField:{default:"description"}},emits:["select","delete","click"],setup(e,{emit:a}){const l=e,t=a,f=e=>{l.selectable&&t("select",l.item)},v=()=>{l.selectable?f(b.value):t("click",l.item)},g=()=>{l.deletable&&t("delete",l.item)},b=i(()=>l.isSelected);return i(()=>l.item[l.itemTitleField]||""),i(()=>l.item[l.itemDescriptionField]||""),(a,l)=>{const t=M,i=L,h=B;return o(),s("div",{class:d(["waterfall-item",{"waterfall-item--selected":b.value,"waterfall-item--selectable":e.selectable,"waterfall-item--deletable":e.deletable}]),onClick:v},[e.selectable?(o(),s("div",T,[r(t,{"model-value":b.value,"onUpdate:modelValue":f,onClick:l[0]||(l[0]=p(()=>{},["stop"])),class:"selection-checkbox"},null,8,["model-value"])])):n("",!0),e.deletable?(o(),s("div",K,[r(h,{type:"danger",round:"",onClick:p(g,["stop"]),class:"delete-button"},{default:u(()=>[r(i,{name:"delete",size:"14"})]),_:1})])):n("",!0),c("div",V,[m(a.$slots,"default",{item:e.item,index:e.index,selected:b.value},void 0,!0)])],2)}}}),[["__scopeId","data-v-fec8c58d"]]),E={class:"sdkwork-api-waterfall"},U={key:2,class:"data-section"},W={class:"waterfall-container"},G=P(t({__name:"sdkwork-api-waterfall",props:{api:{type:Function,default:void 0},service:{default:void 0},params:{default:()=>({})},pageableParams:{default:()=>({})},selectable:{type:Boolean,default:I.selectable},deletable:{type:Boolean,default:I.deletable},searchable:{type:Boolean,default:I.searchable},pageSize:{default:I.pageSize},itemKey:{default:I.itemKey},itemTitleField:{default:I.itemTitleField},itemDescriptionField:{default:I.itemDescriptionField},topSpacing:{default:I.topSpacing},leftSpacing:{default:I.leftSpacing},rightSpacing:{default:I.rightSpacing},columns:{default:I.columns},gap:{default:I.gap}},emits:["select","delete","search","reach-top","reach-bottom","scroll","item-resize","range-update","load"],setup(t,{expose:d,emit:p}){j(e=>({v62b79a6a:I.columns,v655f6d69:I.gap+"px"}));const I=t,B=p,L=f([]),P=f();let M=null;const{dataList:T,currentPage:K,totalElements:V,totalPages:G,loading:H,loadingMore:O,hasMore:Q,loadData:X,onRefresh:Y}=D({api:I.api,service:I.service,params:I.params,pageableParams:I.pageableParams,pageSize:I.pageSize,autoLoad:!1}),Z=i(()=>"number"==typeof I.topSpacing?`${I.topSpacing}px`:I.topSpacing),q=i(()=>"number"==typeof I.leftSpacing?`${I.leftSpacing}px`:I.leftSpacing),A=i(()=>"number"==typeof I.rightSpacing?`${I.rightSpacing}px`:I.rightSpacing),J=i(()=>({paddingTop:Z.value,paddingLeft:q.value,paddingRight:A.value})),N=(e,a)=>e[I.itemKey]||a,ee=e=>L.value.some(a=>N(a,-1)===N(e,-1)),ae=e=>{B("search",e),(async(e=0,a=!1)=>{try{await X(e,a),(T.value.length>0||0===e)&&B("load",{content:T.value,number:K.value,totalElements:V.value,totalPages:G.value,last:!Q.value})}catch(l){}})(0)},le=e=>{if(I.selectable){const a=L.value.findIndex(a=>N(a,-1)===N(e,-1));a>-1?L.value.splice(a,1):L.value.push(e)}B("select",e)},te=e=>{B("delete",e)};return v(()=>I.params,()=>{X(0)},{deep:!0}),v(()=>I.pageSize,()=>{X(0)}),g(()=>{X(0),b(()=>{P.value?.$el&&(M=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&Q.value&&!O.value&&!H.value&&X(K.value+1,!0)})},{root:null,rootMargin:"0px",threshold:.1}),M.observe(P.value.$el))})}),h(()=>{M&&(M.disconnect(),M=null)}),d({refresh:()=>X(0),loadMore:()=>X(K.value+1,!0),getData:()=>T.value,getSelectedItems:()=>L.value,clearSelected:()=>{L.value=[]},setSelectedItems:e=>{L.value=e}}),(i,d)=>{const p=e;return o(),s("div",E,[t.searchable?(o(),y(z,{key:0,searchable:t.searchable,onSearch:ae},null,8,["searchable"])):n("",!0),r(p,{modelValue:S(H),"onUpdate:modelValue":d[0]||(d[0]=e=>x(H)?H.value=e:null),onRefresh:S(Y)},{default:u(()=>[c("div",{class:"waterfall-content",style:$(J.value)},[S(H)&&!S(T).length?(o(),y(R,{key:0},{default:u(({loading:e})=>[m(i.$slots,"loading",k(_({loading:e})),void 0,!0)]),_:3})):S(H)||S(T).length?(o(),s("div",U,[m(i.$slots,"header",{},void 0,!0),c("div",W,[(o(!0),s(w,null,F(S(T),(e,a)=>(o(),y(C,{key:N(e,a),item:e,index:a,selectable:t.selectable,deletable:t.deletable,"is-selected":ee(e),"item-key":t.itemKey,"item-title-field":t.itemTitleField,"item-description-field":t.itemDescriptionField,onSelect:le,onDelete:te},{default:u(({item:e,index:a,selected:l})=>[m(i.$slots,"default",{item:e,index:a,selected:l},void 0,!0)]),_:3},8,["item","index","selectable","deletable","is-selected","item-key","item-title-field","item-description-field"]))),128))]),m(i.$slots,"footer",{},void 0,!0),r(l,{"has-more":S(Q),"loading-more":S(O),"data-list":S(T),ref_key:"loadMoreSectionRef",ref:P},null,8,["has-more","loading-more","data-list"])])):(o(),y(a,{key:1},{default:u(({empty:e})=>[m(i.$slots,"empty",k(_({empty:e})),void 0,!0)]),_:3}))],4)]),_:3},8,["modelValue","onRefresh"])])}}}),[["__scopeId","data-v-bc078e8a"]]);export{G as S};
