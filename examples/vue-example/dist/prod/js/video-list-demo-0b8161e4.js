import{k as e,M as t,l as a,I as l,B as s,_ as i,s as o,d,L as r,a as c}from"./index-2cafbb5e.js";/* empty css              */import{T as n}from"./index-4f03d337.js";import{S as u}from"./sdkwork-api-list-be20b211.js";import{k as p,O as v,Q as m,R as f,S as g,$ as y,U as h,X as S,j as k,a4 as b,Z as w,a0 as $,a1 as I,r as _,c as D,w as L,u as T,b as C,F as E,Y as j}from"./vue-vendor-fce65f55.js";import"./utils-vendor-b5712723.js";import"./index-ead435a5.js";import"./index-6e9c758b.js";import"./use-tab-status-2f29a6cd.js";import"./shared-9d0b1b96.js";import"./sdkwork-search-bar-a4feada5.js";import"./sdkwork-icon-105dbc30.js";import"./index-17b6a864.js";import"./use-id-bc367f23.js";import"./ListItem-b5deca21.js";class B extends e.BaseService{constructor(){super(t.create(a.VideoManager))}}const P={class:"video-cover"},A=["src","alt"],M={key:0,class:"video-duration"},x={class:"play-overlay"},z={class:"video-info"},F=["title"],O={key:0,class:"video-description"},N={class:"video-meta"},K={key:0,class:"meta-item"},R={key:1,class:"meta-item"},U={key:2,class:"meta-item"},G={key:1,class:"video-actions"},V=i(p({__name:"VideoListItem",props:{video:{},index:{default:0},selected:{type:Boolean,default:!1},selectable:{type:Boolean,default:!1},deletable:{type:Boolean,default:!1}},emits:["select","delete","click"],setup(e,{emit:t}){const a=e,i=t;v();const o=e=>{if(!e)return"00:00";const t=Math.floor(e/3600),a=Math.floor(e%3600/60),l=Math.floor(e%60);return t>0?`${t.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`:`${a.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`},d=e=>{if(!e)return"0 B";let t="string"==typeof e?parseFloat(e):e;const a=["B","KB","MB","GB","TB"];let l=0;for(;t>=1024&&l<a.length-1;)t/=1024,l++;return`${t.toFixed(1)} ${a[l]}`},r=e=>{if(!e)return"";const t=new Date(e),a=(new Date).getTime()-t.getTime(),l=Math.floor(a/864e5);return 0===l?"今天":1===l?"昨天":l<7?`${l}天前`:t.toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric"})},c=e=>({COMPLETED:"已完成",PROCESSING:"处理中",FAILED:"失败",DELETED:"已删除",DEFAULT:"默认"}[e]||"未知"),n=()=>{i("click",a.video)},u=()=>{a.selectable&&i("select",a.video)},p=()=>{a.deletable&&i("delete",a.video)};return(t,a)=>{const i=l,v=s;return m(),f("div",{class:S(["video-list-item",{"video-item-selected":e.selected}]),onClick:n},[g("div",P,[g("img",{src:e.video.thumbnailUrl||"/images/video-placeholder.jpg",alt:e.video.title,class:"cover-image",loading:"lazy"},null,8,A),e.video.duration?(m(),f("div",M,y(o(e.video.duration)),1)):h("",!0),g("div",{class:S(["video-status",(_=e.video.status,{COMPLETED:"status-completed",PROCESSING:"status-processing",FAILED:"status-failed",DELETED:"status-deleted",DEFAULT:"status-default"}[_]||"status-default")])},y(c(e.video.status)),3),g("div",x,[k(i,{name:"play-circle-o",size:"32",color:"white"})])]),g("div",z,[g("h3",{class:"video-title",title:e.video.title},y(e.video.title||"未命名视频"),9,F),e.video.description?(m(),f("p",O,y(e.video.description),1)):h("",!0),g("div",N,[e.video.resolution?(m(),f("span",K,[k(i,{name:"video-o"}),b(" "+y(e.video.resolution),1)])):h("",!0),e.video.fileSize?(m(),f("span",R,[k(i,{name:"file-o"}),b(" "+y(d(e.video.fileSize)),1)])):h("",!0),e.video.createdAt?(m(),f("span",U,[k(i,{name:"clock-o"}),b(" "+y(r(e.video.createdAt)),1)])):h("",!0)]),e.selectable||e.deletable?(m(),f("div",G,[e.selectable?(m(),w(v,{key:0,type:e.selected?"primary":"default",onClick:I(u,["stop"]),class:"action-btn"},{default:$(()=>[b(y(e.selected?"已选":"选择"),1)]),_:1},8,["type"])):h("",!0),e.deletable?(m(),w(v,{key:1,type:"danger",plain:"",onClick:I(p,["stop"]),class:"action-btn"},{default:$(()=>[...a[0]||(a[0]=[b(" 删除 ",-1)])]),_:1})):h("",!0)])):h("",!0)])],2);var _}}}),[["__scopeId","data-v-f71f2476"]]),Y={class:"empty-video"},Q={class:"loading-video"},W={class:"list-header"},X={key:0,class:"list-footer"},Z=i(p({__name:"sdkwork-video-list",props:{api:{},params:{},selectable:{type:Boolean,default:!1},deletable:{type:Boolean,default:!1},searchable:{type:Boolean,default:!0},pageSize:{default:10},itemKey:{default:"id"},itemTitleField:{default:"title"},itemDescriptionField:{default:"description"},autoLoad:{type:Boolean,default:!0},defaultKeyword:{default:""}},emits:["select","delete","search","load","click","batch-action","refresh"],setup(e,{expose:t,emit:a}){const i=e,c=a,p=_(),v=new B,S=_({keyword:i.defaultKeyword,...i.params}),I=_(0),C=_(0),E=_(0),j=_(0),P=_([]),A=D(()=>P.value.filter(e=>"PROCESSING"===e.status).length),M=i.api?i.api:async e=>{try{const{keyword:t,...a}=S.value,l={keyword:t||"",...a};return await v.listByPage(l,e)}catch(t){throw console.error("获取视频列表失败:",t),t}},x=e=>{c("select",e),R(),o(`已选择: ${e.title}`)},z=async e=>{try{await d({title:"确认删除",message:`确定要删除视频"${e.title}"吗？此操作不可撤销。`}),i.api?(c("delete",e),o("删除请求已发送")):(await v.delete(e.id),c("delete",e),o("视频删除成功"),p.value?.refresh())}catch(t){console.log("取消删除或删除失败")}},F=e=>{c("click",e)},O=e=>{S.value.keyword=e,c("search",e)},N=e=>{I.value=e.total||0,E.value=e.pageable.pageNumber||0,j.value=e.total/(e.pageable.pageSize||10)||0,c("load",e)},K=()=>{0!==P.value.length?(c("batch-action",P.value),o(`已选择 ${P.value.length} 个视频进行批量操作`)):o("请先选择视频")},R=()=>{const e=p.value?.getSelectedItems()||[];P.value=e,C.value=e.length};return L(C,()=>{R()}),L(()=>i.params,e=>{S.value={...S.value,...e}},{deep:!0}),L(()=>i.defaultKeyword,e=>{S.value.keyword=e}),t({refresh:()=>p.value?.refresh(),loadMore:()=>p.value?.loadMore(),getData:()=>p.value?.getData()||[],getSelectedItems:()=>p.value?.getSelectedItems()||[],clearSelected:()=>{p.value?.clearSelected(),P.value=[],C.value=0},setSelectedItems:e=>{p.value?.setSelectedItems(e),P.value=e,C.value=e.length},setKeyword:e=>{S.value.keyword=e,p.value?.refresh()},getService:()=>v,search:e=>{O(e)}}),(t,a)=>{const i=l,o=r,d=n,c=s;return m(),w(u,{api:T(M),params:S.value,selectable:e.selectable,deletable:e.deletable,searchable:e.searchable,"page-size":e.pageSize,"item-key":e.itemKey,"item-title-field":e.itemTitleField,"item-description-field":e.itemDescriptionField,onSelect:x,onDelete:z,onSearch:O,onLoad:N},{default:$(({item:t,index:a,selected:l})=>[k(V,{video:t,index:a,selected:l,selectable:e.selectable,deletable:e.deletable,onSelect:x,onDelete:z,onClick:F},null,8,["video","index","selected","selectable","deletable"])]),empty:$(()=>[g("div",Y,[k(i,{name:"video-o",size:"48"}),a[0]||(a[0]=g("p",null,"暂无视频",-1))])]),loading:$(()=>[g("div",Q,[k(o,{size:"24px"}),a[1]||(a[1]=g("span",null,"加载视频中...",-1))])]),header:$(()=>[g("div",W,[k(d,{type:"primary"},{default:$(()=>[b("视频总数: "+y(I.value),1)]),_:1}),k(d,{type:"success"},{default:$(()=>[b("选中: "+y(C.value),1)]),_:1}),k(d,{type:"warning"},{default:$(()=>[b("当前页: "+y(E.value+1)+"/"+y(j.value),1)]),_:1}),A.value>0?(m(),w(d,{key:0,type:"danger"},{default:$(()=>[b("处理中: "+y(A.value),1)]),_:1})):h("",!0)])]),footer:$(()=>[C.value>0?(m(),f("div",X,[k(c,{type:"primary",block:"",onClick:K},{default:$(()=>[b(" 批量操作 ("+y(C.value)+") ",1)]),_:1})])):h("",!0)]),_:1},8,["api","params","selectable","deletable","searchable","page-size","item-key","item-title-field","item-description-field"])}}}),[["__scopeId","data-v-6ca128d1"]]),q={class:"video-list-demo"},H={class:"demo-controls"},J={class:"control-panel"},ee={class:"video-list-section"},te={class:"result-panel"},ae={class:"log-container"},le={class:"log-time"},se={class:"log-message"},ie=i(p({__name:"video-list-demo",setup(e){const t=_(""),a=_([]),l=_(),i=_({category:"demo",status:"published"}),d=async e=>{r("API","调用自定义API方法"),await new Promise(e=>setTimeout(e,300));const t=e.pageNumber||0,a=e.pageSize||10,l=t*a,s=[];for(let i=0;i<a&&l+i<25;i++){const e=l+i+1;s.push({id:`video-${e}`,title:`演示视频 ${e}`,description:`这是第 ${e} 个演示视频的描述信息，用于展示API模式的效果`,duration:Math.floor(600*Math.random())+60})}return{content:s,totalElements:25,totalPages:Math.ceil(25/a),number:t,pageSize:a,first:0===t,last:t>=Math.ceil(25/a)-1,empty:0===s.length}},r=(e,t)=>{a.value.unshift({time:(new Date).toLocaleTimeString(),type:e,message:t}),a.value.length>20&&a.value.pop()},n=e=>{r("API",`选择了视频: ${e.title}`),o(`选择了视频: ${e.title}`)},u=e=>{r("API",`删除视频请求: ${e.title}`),o("删除请求已发送，请父组件处理")},p=e=>{r("API",`搜索关键词: ${e}`),t.value=e},v=e=>{},h=e=>{r("API",`批量操作 ${e.length} 个视频`),c({title:"批量操作",message:`将对 ${e.length} 个视频执行批量操作，请父组件处理`})},w=e=>{r("CLICK",`点击视频: ${e.title}`),o(`点击了视频: ${e.title}`)},I=()=>{l.value?.refresh(),r("CONTROL","刷新列表")},D=()=>{l.value?.clearSelected(),r("CONTROL","清空选择")},L=()=>{const e=l.value?.getData()||[],t=l.value?.getSelectedItems()||[];r("STATS",`数据 ${e.length} 条，选中 ${t.length} 条`),o(`数据 ${e.length} 条，选中 ${t.length} 条`)};return C(()=>{r("SYSTEM","视频列表演示页面已加载")}),(e,o)=>{const r=s;return m(),f("div",q,[o[4]||(o[4]=g("div",{class:"demo-header"},[g("h1",null,"视频列表组件演示"),g("p",null,"API模式演示 - 使用模拟数据")],-1)),g("div",H,[g("div",J,[k(r,{type:"primary",onClick:I},{default:$(()=>[...o[0]||(o[0]=[b("刷新列表",-1)])]),_:1}),k(r,{onClick:D},{default:$(()=>[...o[1]||(o[1]=[b("清空选择",-1)])]),_:1}),k(r,{type:"warning",onClick:L},{default:$(()=>[...o[2]||(o[2]=[b("显示统计",-1)])]),_:1})])]),g("div",ee,[k(Z,{ref_key:"apiVideoListRef",ref:l,api:d,params:i.value,selectable:!0,deletable:!0,searchable:!0,"pageNumber-pageSize":10,"default-keyword":t.value,onSelect:n,onDelete:u,onClick:w,onSearch:p,onLoad:v,onBatchAction:h},null,8,["params","default-keyword"])]),g("div",te,[o[3]||(o[3]=g("h3",null,"操作日志",-1)),g("div",ae,[(m(!0),f(E,null,j(a.value,(e,t)=>(m(),f("div",{key:t,class:"log-item"},[g("span",le,y(e.time),1),g("span",{class:S(["log-type",e.type])},y(e.type),3),g("span",se,y(e.message),1)]))),128))])])])}}}),[["__scopeId","data-v-82c00572"]]);export{ie as default};
