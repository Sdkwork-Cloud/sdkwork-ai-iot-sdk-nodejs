import{k as e,r as a,c as t,b as l,n as s,w as u,d as o,e as v,t as i,v as n,j as r,q as c,s as f}from"./vue-vendor-905d75e5.js";import{c as p,T as g,U as h,V as x,b as d,W as y,X as m,Y as b,q as T,Z as j,z as w,w as k}from"./index-34815b62.js";function C(e,a){return e.reduce((e,t)=>Math.abs(e-a)<Math.abs(t-a)?e:t)}const O={gap:{type:[Number,Object],default:24},icon:String,axis:T("y"),magnetic:String,offset:Object,teleport:{type:[String,Object],default:"body"}},[S,q]=p("floating-bubble");const M=k(e({name:S,inheritAttrs:!1,props:O,emits:["click","update:offset","offsetChange"],setup(e,{slots:p,emit:T,attrs:k}){const O=a(),S=a({x:0,y:0,width:0,height:0}),M=t(()=>g(e.gap)?e.gap.x:e.gap),P=t(()=>g(e.gap)?e.gap.y:e.gap),X=t(()=>({top:P.value,right:h.value-S.value.width-M.value,bottom:x.value-S.value.height-P.value,left:M.value})),Y=a(!1);let $=!1;const z=t(()=>{const e={},a=d(S.value.x),t=d(S.value.y);return e.transform=`translate3d(${a}, ${t}, 0)`,!Y.value&&$||(e.transition="none"),e}),A=()=>{if(!Z.value)return;const{width:a,height:t}=j(O.value),{offset:l}=e;S.value={x:l?l.x:h.value-a-M.value,y:l?l.y:x.value-t-P.value,width:a,height:t}},D=y();let F=0,N=0;const U=e=>{D.start(e),Y.value=!0,F=S.value.x,N=S.value.y};m("touchmove",a=>{if(a.preventDefault(),D.move(a),"lock"!==e.axis&&!D.isTap.value){if("x"===e.axis||"xy"===e.axis){let e=F+D.deltaX.value;e<X.value.left&&(e=X.value.left),e>X.value.right&&(e=X.value.right),S.value.x=e}if("y"===e.axis||"xy"===e.axis){let e=N+D.deltaY.value;e<X.value.top&&(e=X.value.top),e>X.value.bottom&&(e=X.value.bottom),S.value.y=e}const a=w(S.value,["x","y"]);T("update:offset",a)}},{target:O});const V=()=>{Y.value=!1,s(()=>{if("x"===e.magnetic){const e=C([X.value.left,X.value.right],S.value.x);S.value.x=e}if("y"===e.magnetic){const e=C([X.value.top,X.value.bottom],S.value.y);S.value.y=e}if(!D.isTap.value){const e=w(S.value,["x","y"]);T("update:offset",e),F===e.x&&N===e.y||T("offsetChange",e)}})},W=e=>{D.isTap.value?T("click",e):e.stopPropagation()};l(()=>{A(),s(()=>{$=!0})}),u([h,x,M,P,()=>e.offset],A,{deep:!0});const Z=a(!0);return o(()=>{Z.value=!0}),v(()=>{e.teleport&&(Z.value=!1)}),()=>{const a=i(r("div",c({class:q(),ref:O,onTouchstartPassive:U,onTouchend:V,onTouchcancel:V,onClickCapture:W,style:z.value},k),[p.default?p.default():r(b,{name:e.icon,class:q("icon")},null)]),[[n,Z.value]]);return e.teleport?r(f,{to:e.teleport},{default:()=>[a]}):a}}}));export{M as F};
