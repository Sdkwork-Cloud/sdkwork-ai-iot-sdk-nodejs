import{x as e,M as t,y as a,s,_ as l,B as i,L as o,I as r,f as c,O as u}from"./index-CS7g9XHh.js";import{D as d,a as n}from"./index-R94oIWOX.js";/* empty css              */import{_ as m}from"./sdkwork-search-bar-BVv1IjtJ.js";/* empty css              */import{S as p}from"./sdkwork-api-list-B8oU94eE.js";import{k as v,a as h,f as w,P as g,Q as y,W as f,S as x,$ as b,a1 as k,R as S,w as B,Z as j,a0 as z,u as C,j as _,a4 as M,U as I,o as A,n as L}from"./vue-vendor-BvtDOCb5.js";import"./utils-vendor-WEzSe-CR.js";import"./index-CVZvWEDx.js";import"./use-id-Bc1QsgaB.js";import"./sdkwork-icon-DuHr6i5g.js";import"./index-PnL9L784.js";import"./index-BWgZZY7i.js";import"./use-tab-status-UmGlUUSR.js";import"./shared-DPkvtz4r.js";import"./index-1dsIbHLT.js";import"./ListItem-BKv55VP8.js";class H extends e.BaseService{constructor(){super(t.create(a.MusicManager))}}const T=["data-theme"],$={key:0,class:"music-index"},D={class:"index-number"},V={key:0,class:"playing-indicator"},P={class:"music-cover"},K=["src","alt"],F={key:0,class:"music-duration"},U={class:"music-info"},q={class:"music-main-info"},E=["title"],N={key:0,class:"music-artist"},R={key:0,class:"music-album"},O={key:1,class:"music-tags"},Q={key:0,class:"music-tag"},Z={key:1,class:"music-tag quality-tag"},G={class:"music-actions"},W={key:0,class:"music-time"},Y={class:"action-buttons"},J=l(v({__name:"MusicListItem",props:{music:{},index:{default:0},selected:{type:Boolean,default:!1},selectable:{type:Boolean,default:!1},deletable:{type:Boolean,default:!1},showIndex:{type:Boolean,default:!1},themeMode:{default:"auto"},showBorderBottom:{type:Boolean,default:!1}},emits:["click","like","more"],setup(e,{emit:t}){const a=e,l=t,i=h(!1),o=w(()=>{if(!window.$music)return!1;try{const e=window.$music.getState();return e.currentTrack?.id===a.music.id&&e.isPlaying}catch(e){return!1}}),r=e=>{if(!e)return"00:00";const t=Math.floor(e/60),a=Math.floor(e%60);return`${t.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`},c=()=>{l("click",a.music)},u=()=>{i.value=!i.value,l("like",a.music),s(i.value?"已添加到喜欢":"已取消喜欢")},d=()=>{l("more",a.music)};return(t,s)=>(y(),g("div",{class:S(["music-list-item",{"music-item-selected":e.selected,"music-item-playing":o.value,"no-border":!a.showBorderBottom}]),"data-theme":a.themeMode,onClick:c},[e.showIndex?(y(),g("div",$,[x("span",D,b(e.index+1),1),o.value?(y(),g("div",V,[...s[0]||(s[0]=[x("div",{class:"wave-bar"},null,-1),x("div",{class:"wave-bar"},null,-1),x("div",{class:"wave-bar"},null,-1)])])):f("",!0)])):f("",!0),x("div",P,[x("img",{src:e.music.cover||e.music.thumbnailUrl||"/images/music-placeholder.jpg",alt:e.music.title,class:"cover-image",loading:"lazy"},null,8,K),e.music.duration?(y(),g("div",F,b(r(e.music.duration)),1)):f("",!0)]),x("div",U,[x("div",q,[x("h3",{class:"music-title",title:e.music.title},b(e.music.title||"未命名音乐"),9,E),e.music.artist?(y(),g("p",N,b(e.music.artist),1)):f("",!0)]),e.music.album?(y(),g("p",R,b(e.music.album),1)):f("",!0),e.music.genre||e.music.quality?(y(),g("div",O,[e.music.genre?(y(),g("span",Q,b(e.music.genre),1)):f("",!0),e.music.quality?(y(),g("span",Z,b(e.music.quality),1)):f("",!0)])):f("",!0)]),x("div",G,[e.music.duration?(y(),g("div",W,b(r(e.music.duration)),1)):f("",!0),x("div",Y,[x("button",{class:S(["action-btn like-btn",{liked:i.value}]),onClick:k(u,["stop"])},[...s[1]||(s[1]=[x("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor"},[x("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})],-1)])],2),x("button",{class:"action-btn more-btn",onClick:k(d,["stop"])},[...s[2]||(s[2]=[x("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor"},[x("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})],-1)])])])])],10,T))}}),[["__scopeId","data-v-a652aaeb"]]),X={class:"empty-music"},ee={class:"loading-music"},te={key:0,class:"list-footer"},ae=l(v({__name:"sdkwork-music-list",props:{api:{},params:{},selectable:{type:Boolean,default:!1},deletable:{type:Boolean,default:!1},searchable:{type:Boolean,default:!0},pageSize:{default:10},itemKey:{default:"id"},itemTitleField:{default:"title"},itemDescriptionField:{default:"description"},autoLoad:{type:Boolean,default:!0},defaultKeyword:{default:""},themeMode:{default:"auto"},showBorderBottom:{type:Boolean,default:!1}},emits:["select","delete","search","load","click","batch-action","refresh"],setup(e,{expose:t,emit:a}){const l=e,u=a,d=h(),n=new H,m=h({keyword:l.defaultKeyword,...l.params}),v=h(0),k=h(0),S=h(0),A=h(0),L=h([]);w(()=>L.value.filter(e=>"PROCESSING"===e.status).length);const T=l.api?l.api:async e=>{try{const{keyword:t,...a}=m.value,s={keyword:t||"",...a};return await n.listByPage(s,e)}catch(t){throw t}},$=e=>{u("select",e),U()},D=async e=>{try{await c({title:"确认删除",message:`确定要删除音乐"${e.title}"吗？此操作不可撤销。`}),l.api?(u("delete",e),s("删除请求已发送")):(await n.delete(e.id),u("delete",e),s("音乐删除成功"),d.value?.refresh())}catch(t){}},V=e=>{u("click",e)},P=e=>{m.value.keyword=e,u("search",e)},K=e=>{v.value=e.total||0,S.value=e.pageable.pageNumber||0,A.value=e.total/(e.pageable.pageSize||10)||0,u("load",e)},F=()=>{0!==L.value.length&&u("batch-action",L.value)},U=()=>{const e=d.value?.getSelectedItems()||[];L.value=e,k.value=e.length};return B(()=>l.params,e=>{m.value={...m.value,...e}},{deep:!0}),B(()=>l.defaultKeyword,e=>{m.value.keyword=e}),t({refresh:()=>d.value?.refresh(),loadMore:()=>d.value?.loadMore(),getData:()=>d.value?.getData()||[],getSelectedItems:()=>d.value?.getSelectedItems()||[],clearSelected:()=>{d.value?.clearSelected(),L.value=[],k.value=0},setSelectedItems:e=>{d.value?.setSelectedItems(e),L.value=e,k.value=e.length},setKeyword:e=>{m.value.keyword=e,d.value?.refresh()},getService:()=>n,search:e=>{P(e)}}),(t,a)=>{const s=r,l=o,c=i;return y(),j(p,{api:C(T),params:m.value,selectable:e.selectable,deletable:e.deletable,searchable:e.searchable,"page-size":e.pageSize,"item-key":e.itemKey,"item-title-field":e.itemTitleField,"item-description-field":e.itemDescriptionField,"theme-mode":e.themeMode,"show-border-bottom":e.showBorderBottom,onSelect:$,onDelete:D,onSearch:P,onLoad:K},{default:z(({item:t,index:a,selected:s})=>[_(J,{music:t,index:a,selected:s,selectable:e.selectable,deletable:e.deletable,"show-index":!1,onClick:V},null,8,["music","index","selected","selectable","deletable"])]),empty:z(()=>[x("div",X,[_(s,{name:"music-o",size:"48"}),a[0]||(a[0]=x("p",null,"暂无音乐",-1))])]),loading:z(()=>[x("div",ee,[_(l,{size:"24px"}),a[1]||(a[1]=x("span",null,"加载音乐中...",-1))])]),header:z(()=>[I(t.$slots,"header",{},void 0,!0)]),footer:z(()=>[k.value>0?(y(),g("div",te,[_(c,{type:"primary",block:"",onClick:F},{default:z(()=>[M(" 批量操作 ("+b(k.value)+") ",1)]),_:1})])):f("",!0)]),_:3},8,["api","params","selectable","deletable","searchable","page-size","item-key","item-title-field","item-description-field","theme-mode","show-border-bottom"])}}}),[["__scopeId","data-v-d7545dd3"]]),se={class:"music-list-page dark-mode"},le={class:"filter-section"},ie={class:"search-container"},oe={class:"filter-controls"},re={class:"music-list-container"},ce={class:"empty-state"},ue=l(v({__name:"list",setup(e){const t=h(),a=h(""),l=h("latest"),i=h("all"),o=h(null),c=h([]),p=[{text:"最新",value:"latest"},{text:"热门",value:"popular"},{text:"标题",value:"title"},{text:"时长",value:"duration"}],v=[{text:"全部",value:"all"},{text:"流行",value:"pop"},{text:"摇滚",value:"rock"},{text:"古典",value:"classical"},{text:"电子",value:"electronic"},{text:"爵士",value:"jazz"},{text:"民谣",value:"folk"}],w=[{id:1,title:"月光奏鸣曲",artist:"贝多芬",genre:"classical",duration:360,src:"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3",cover:"https://picsum.photos/300/300?random=1",description:"贝多芬经典钢琴奏鸣曲",popularity:95,createdAt:"2024-01-15"},{id:2,title:"蓝色多瑙河",artist:"小约翰·施特劳斯",genre:"classical",duration:420,src:"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3",cover:"https://picsum.photos/300/300?random=2",description:"圆舞曲之王的经典作品",popularity:92,createdAt:"2024-01-14"},{id:3,title:"卡农",artist:"帕赫贝尔",genre:"classical",duration:300,src:"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3",cover:"https://picsum.photos/300/300?random=3",description:"永恒的经典卡农变奏曲",popularity:98,createdAt:"2024-01-13"},{id:4,title:"致爱丽丝",artist:"贝多芬",genre:"classical",duration:180,src:"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-4.mp3",cover:"https://picsum.photos/300/300?random=4",description:"贝多芬著名的钢琴小品",popularity:90,createdAt:"2024-01-12"},{id:5,title:"四季·春",artist:"维瓦尔第",genre:"classical",duration:240,src:"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-5.mp3",cover:"https://picsum.photos/300/300?random=5",description:"巴洛克时期的经典协奏曲",popularity:88,createdAt:"2024-01-11"},{id:6,title:"Shape of You",artist:"Ed Sheeran",genre:"pop",duration:233,src:"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-6.mp3",cover:"https://picsum.photos/300/300?random=6",description:"流行金曲",popularity:96,createdAt:"2024-01-10"},{id:7,title:"Bohemian Rhapsody",artist:"Queen",genre:"rock",duration:354,src:"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-7.mp3",cover:"https://picsum.photos/300/300?random=7",description:"摇滚经典",popularity:99,createdAt:"2024-01-09"},{id:8,title:"Take Five",artist:"Dave Brubeck",genre:"jazz",duration:324,src:"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-8.mp3",cover:"https://picsum.photos/300/300?random=8",description:"爵士名曲",popularity:85,createdAt:"2024-01-08"},{id:9,title:"Stairway to Heaven",artist:"Led Zeppelin",genre:"rock",duration:482,src:"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-9.mp3",cover:"https://picsum.photos/300/300?random=9",description:"摇滚史诗",popularity:97,createdAt:"2024-01-07"},{id:10,title:"Hotel California",artist:"Eagles",genre:"rock",duration:391,src:"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-10.mp3",cover:"https://picsum.photos/300/300?random=10",description:"经典摇滚",popularity:94,createdAt:"2024-01-06"}],f=async e=>{try{await new Promise(e=>setTimeout(e,500));let t=[...w];if(a.value){const e=a.value.toLowerCase();t=t.filter(t=>t.title.toLowerCase().includes(e)||t.artist.toLowerCase().includes(e)||t.description.toLowerCase().includes(e))}switch("all"!==i.value&&(t=t.filter(e=>e.genre===i.value)),l.value){case"latest":t.sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime());break;case"popular":t.sort((e,t)=>t.popularity-e.popularity);break;case"title":t.sort((e,t)=>e.title.localeCompare(t.title));break;case"duration":t.sort((e,t)=>e.duration-t.duration)}const{pageNumber:s=0,pageSize:o=20}=e,r=s*o,u=r+o,d=t.slice(r,u);return c.value=t,{content:d,totalElements:t.length,totalPages:Math.ceil(t.length/o),pageSize:o,number:s,first:0===s,last:u>=t.length,empty:0===t.length}}catch(t){throw t}},b=()=>{t.value&&t.value.refresh()},k=()=>{a.value="",b()},S=()=>{b()},j=()=>{b()},C=async e=>{await L();try{u.getState();u.play(e,c.value),o.value=e,s(`开始播放: ${e.title}`)}catch(t){s(`播放失败: ${t}`)}},M=e=>{},I=e=>{};return B(a,(e,t)=>{e!==t&&(clearTimeout(window.searchTimeout),window.searchTimeout=setTimeout(()=>{b()},300))}),A(()=>{c.value=w,window.$music||(window.$music=u)}),(e,s)=>{const o=m,c=n,u=d,h=r;return y(),g("div",se,[x("div",le,[x("div",ie,[_(o,{modelValue:a.value,"onUpdate:modelValue":s[0]||(s[0]=e=>a.value=e),placeholder:"搜索音乐、歌手或专辑",shape:"round",background:"transparent",onSearch:b,onClear:k},null,8,["modelValue"])]),x("div",oe,[_(u,{"active-color":"#3b82f6"},{default:z(()=>[_(c,{modelValue:l.value,"onUpdate:modelValue":s[1]||(s[1]=e=>l.value=e),options:p,onChange:S},null,8,["modelValue"]),_(c,{modelValue:i.value,"onUpdate:modelValue":s[2]||(s[2]=e=>i.value=e),options:v,onChange:j},null,8,["modelValue"])]),_:1})])]),x("div",re,[_(ae,{ref_key:"musicListRef",ref:t,api:f,selectable:!1,searchable:!1,deletable:!1,"page-size":20,"auto-load":!0,"default-keyword":a.value,onSelect:C,onLoad:I,onClick:M},{empty:z(()=>[x("div",ce,[_(h,{name:"music-o",size:"48"}),s[3]||(s[3]=x("p",{class:"empty-title"},"暂无音乐",-1)),s[4]||(s[4]=x("p",{class:"empty-description"},"尝试调整搜索条件",-1))])]),_:1},8,["default-keyword"])])])}}}),[["__scopeId","data-v-642651fd"]]);export{ue as default};
