import{k as e,a as o,f as t,j as a,r as s,s as l,t as n,v as r,q as i}from"./vue-vendor-B1RsE4Tz.js";import{n as d,t as p,r as u,x as c,c as v,T as m,at as h,a4 as w,U as f,aO as b,F as y,H as g,C,a7 as x,ab as O,a6 as P,W as k,aA as z,aP as j,P as I,I as S,w as T}from"./index-mGUiS-yG.js";import{C as V}from"./index-88IoPNO4.js";import{u as W}from"./use-id-CKFvKg0a.js";const[$,E]=v("dropdown-menu"),R={overlay:p,zIndex:d,duration:c(.2),direction:u("down"),activeColor:String,autoLocate:Boolean,closeOnClickOutside:p,closeOnClickOverlay:p,swipeThreshold:d},A=Symbol($);var B=e({name:$,props:R,setup(e,{slots:s}){const l=W(),n=o(),r=o(),i=o(0),{children:d,linkChildren:p}=m(A),u=h(n),c=t(()=>d.some(e=>e.state.showWrapper)),v=t(()=>e.swipeThreshold&&d.length>+e.swipeThreshold),O=t(()=>{if(c.value&&w(e.zIndex))return{zIndex:+e.zIndex+1}}),P=()=>{d.forEach(e=>{e.toggle(!1)})},k=()=>{if(r.value){const o=g(r);"down"===e.direction?i.value=o.bottom:i.value=C.value-o.top}},z=(o,t)=>{const{showPopup:s}=o.state,{disabled:n,titleClass:r}=o;return a("div",{id:`${l}-${t}`,role:"button",tabindex:n?void 0:0,"data-allow-mismatch":"attribute",class:[E("item",{disabled:n,grow:v.value}),{[x]:!n}],onClick:()=>{var e;n||(e=t,d.forEach((o,t)=>{t===e?o.toggle():o.state.showPopup&&o.toggle(!1,{immediate:!0})}))}},[a("span",{class:[E("title",{down:s===("down"===e.direction),active:s}),r],style:{color:s?e.activeColor:""}},[a("div",{class:"van-ellipsis"},[o.renderTitle()])])])};return f({close:P,opened:c}),p({id:l,props:e,offset:i,opened:c,updateOffset:k}),b(n,()=>{e.closeOnClickOutside&&P()}),y("scroll",()=>{c.value&&k()},{target:u,passive:!0}),()=>{var e;return a("div",{ref:n,class:E()},[a("div",{ref:r,style:O.value,class:E("bar",{opened:c.value,scrollable:v.value})},[d.map(z)]),null==(e=s.default)?void 0:e.call(s)])}}});const[L,U]=v("dropdown-item");const q=T(e({name:L,inheritAttrs:!1,props:{title:String,options:P(),disabled:Boolean,teleport:[String,Object],lazyRender:p,modelValue:O,titleClass:O},emits:["open","opened","close","closed","change","update:modelValue"],setup(e,{emit:t,slots:d,attrs:p}){const u=s({showPopup:!1,transition:!0,showWrapper:!1}),c=o(),{parent:v,index:m}=k(A);if(!v)return;const h=e=>()=>t(e),w=h("open"),b=h("close"),y=h("opened"),C=()=>{u.showWrapper=!1,t("closed")},x=o=>{e.teleport&&o.stopPropagation()},O=o=>{const{activeColor:s}=v.props,{disabled:l}=o,n=o.value===e.modelValue;return a(V,{role:"menuitem",key:String(o.value),icon:o.icon,title:o.text,class:U("option",{active:n,disabled:l}),style:{color:n?s:""},tabindex:n?0:-1,clickable:!l,onClick:()=>{l||(u.showPopup=!1,o.value!==e.modelValue&&(t("update:modelValue",o.value),t("change",o.value)))}},{value:()=>{if(n)return a(S,{class:U("icon"),color:l?void 0:s,name:"success"},null)}})},P=()=>{const{offset:o}=v,{autoLocate:t,zIndex:s,overlay:l,duration:h,direction:f,closeOnClickOverlay:P}=v.props,k=z(s);let S=o.value;if(t&&c.value){const e=j(c.value);e&&(S-=g(e).top)}return"down"===f?k.top=`${S}px`:k.bottom=`${S}px`,n(a("div",i({ref:c,style:k,class:U([f]),onClick:x},p),[a(I,{show:u.showPopup,"onUpdate:show":e=>u.showPopup=e,role:"menu",class:U("content"),overlay:l,overlayProps:{duration:u.transition&&!v.opened.value?h:0},position:"down"===f?"top":"bottom",duration:u.transition?h:0,lazyRender:e.lazyRender,overlayStyle:{position:"absolute"},"aria-labelledby":`${v.id}-${m.value}`,"data-allow-mismatch":"attribute",closeOnClickOverlay:P,onOpen:w,onClose:b,onOpened:y,onClosed:C},{default:()=>{var o;return[e.options.map(O),null==(o=d.default)?void 0:o.call(d)]}})]),[[r,u.showWrapper]])};return f({state:u,toggle:(e=!u.showPopup,o={})=>{e!==u.showPopup&&(u.showPopup=e,u.transition=!o.immediate,e&&(v.updateOffset(),u.showWrapper=!0))},renderTitle:()=>{if(d.title)return d.title();if(e.title)return e.title;const o=e.options.find(o=>o.value===e.modelValue);return o?o.text:""}}),()=>e.teleport?a(l,{to:e.teleport},{default:()=>[P()]}):P()}})),D=T(B);export{D,q as a};
