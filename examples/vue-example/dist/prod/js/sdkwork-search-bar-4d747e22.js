import{k as e,r as a,c as o,w as l,b as s,o as t,Q as d,R as r,W as u,U as n,S as c,j as i,t as h,ag as p,X as k,y as v,a1 as f,a4 as m,$ as w,V as b,n as y}from"./vue-vendor-a2672387.js";import{s as g}from"./sdkwork-icon-2d6efb98.js";import{_}from"./index-5affcab4.js";const M={key:0,class:"sdkwork-search-bar__left"},V={class:"sdkwork-search-bar__content"},x={class:"sdkwork-search-bar__icon"},B={class:"sdkwork-search-bar__field"},$=["type","placeholder","disabled","readonly","maxlength","autofocus"],E=_(e({__name:"sdkwork-search-bar",props:{modelValue:{default:""},type:{default:"text"},placeholder:{default:"搜索"},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},maxlength:{default:void 0},autofocus:{type:Boolean,default:!1},clearable:{type:Boolean,default:!0},showAction:{type:Boolean,default:!1},actionText:{default:"取消"},shape:{default:"square"},background:{default:""},themeMode:{default:"auto"},align:{default:"left"},hideActionWhenEmpty:{type:Boolean,default:!1}},emits:["update:modelValue","search","cancel","input","focus","blur","clear","keypress"],setup(e,{expose:_,emit:E}){const A=e,j=E,L=a(A.modelValue),T=a(!1),I=a(null),R=a(!1),W=()=>{"dark"===A.themeMode?R.value=!0:"light"===A.themeMode?R.value=!1:"auto"===A.themeMode&&(R.value=!("undefined"==typeof window||!window.matchMedia)&&window.matchMedia("(prefers-color-scheme: dark)").matches)},C=o(()=>R.value?"sdkwork-search-bar--dark":"sdkwork-search-bar--light"),K=o(()=>A.showAction?!(A.hideActionWhenEmpty&&!L.value):T.value);l(()=>A.themeMode,(e,a)=>{W(),"auto"===a&&"auto"!==e&&Q&&(Q.removeEventListener("change",U),Q=null),"auto"===e&&"auto"!==a&&"undefined"!=typeof window&&window.matchMedia&&(Q=window.matchMedia("(prefers-color-scheme: dark)"),Q.addEventListener("change",U),U())});let Q=null;const U=()=>{"auto"===A.themeMode&&(R.value=Q?.matches||!1)};s(()=>{W(),"auto"===A.themeMode&&"undefined"!=typeof window&&window.matchMedia&&(Q=window.matchMedia("(prefers-color-scheme: dark)"),U(),Q.addEventListener("change",U))}),t(()=>{Q&&Q.removeEventListener("change",U)}),l(()=>A.modelValue,e=>{e!==L.value&&(L.value=e)}),l(L,e=>{e!==A.modelValue&&(j("update:modelValue",e),j("input",e))});const q=e=>{T.value=!0,j("focus",e)},F=e=>{T.value=!1,j("blur",e)},S=e=>{const a=e.target;L.value=a.value},X=e=>{j("keypress",e)},z=()=>{j("search",L.value)},D=()=>{L.value="",T.value=!1,j("cancel"),j("update:modelValue","")},G=()=>{console.log("handleClear called, currentValue before:",L.value),console.log("clearable prop:",A.clearable),console.log("disabled prop:",A.disabled),L.value="",console.log("currentValue after clear:",L.value),j("clear"),j("update:modelValue",""),y(()=>{console.log("nextTick - inputRef exists:",!!I.value),I.value?.focus()})};return _({focus:()=>{I.value?.focus()},blur:()=>{I.value?.blur()},getInput:()=>I.value,getValue:()=>L.value,setValue:e=>{L.value=e},clear:G,cancel:D}),W(),(a,o)=>(d(),r("div",{class:k(["sdkwork-search-bar",[{"sdkwork-search-bar--disabled":e.disabled,"sdkwork-search-bar--readonly":e.readonly,"sdkwork-search-bar--show-action":e.showAction,"sdkwork-search-bar--round":"round"===e.shape},C.value]]),style:b({background:e.background})},[a.$slots.left?(d(),r("div",M,[u(a.$slots,"left",{},void 0,!0)])):n("",!0),c("div",V,[c("div",x,[u(a.$slots,"left-icon",{},()=>[i(g,{icon:"material-symbols:search-rounded",width:"16",height:"16"})],!0)]),c("div",B,[h(c("input",{ref_key:"inputRef",ref:I,"onUpdate:modelValue":o[0]||(o[0]=e=>L.value=e),type:e.type,placeholder:e.placeholder,disabled:e.disabled,readonly:e.readonly,maxlength:e.maxlength,autofocus:e.autofocus,class:k([[`sdkwork-search-bar__input--${e.align}`],"sdkwork-search-bar__input"]),onFocus:q,onBlur:F,onInput:S,onKeypress:X,onKeyup:[v(z,["enter"]),v(D,["esc"])]},null,42,$),[[p,L.value]]),e.clearable&&L.value&&!e.disabled?(d(),r("div",{key:0,class:"sdkwork-search-bar__clear",onMousedown:f(G,["prevent"]),onTouchstart:f(G,["prevent"])},[u(a.$slots,"clear-icon",{},()=>[i(g,{icon:"material-symbols:close-rounded",width:"16",height:"16"})],!0)],32)):n("",!0)])]),K.value?(d(),r("div",{key:1,class:"sdkwork-search-bar__action",onClick:D},[u(a.$slots,"action",{},()=>[m(w(e.actionText),1)],!0)])):n("",!0)],6))}}),[["__scopeId","data-v-0947f3a8"]]);export{E as _};
