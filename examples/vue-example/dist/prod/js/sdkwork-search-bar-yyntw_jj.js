import{k as e,a,f as o,w as l,o as s,b as t,P as d,W as r,S as u,U as n,t as c,ag as i,y as h,R as p,a1 as k,V as v,n as f,Q as m,j as w,a4 as b,$ as y}from"./vue-vendor-BOogp7Xw.js";import{S as g}from"./sdkwork-icon-Bbs-hM5p.js";import{_}from"./index-ov3QC--c.js";const M={key:0,class:"sdkwork-search-bar__left"},V={class:"sdkwork-search-bar__content"},x={class:"sdkwork-search-bar__icon"},B={class:"sdkwork-search-bar__field"},$=["type","placeholder","disabled","readonly","maxlength","autofocus"],E=_(e({__name:"sdkwork-search-bar",props:{modelValue:{default:""},type:{default:"text"},placeholder:{default:"搜索"},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},maxlength:{default:void 0},autofocus:{type:Boolean,default:!1},clearable:{type:Boolean,default:!0},showAction:{type:Boolean,default:!1},actionText:{default:"取消"},shape:{default:"square"},background:{default:""},themeMode:{default:"auto"},align:{default:"left"},hideActionWhenEmpty:{type:Boolean,default:!1}},emits:["update:modelValue","search","cancel","input","focus","blur","clear","keypress"],setup(e,{expose:_,emit:E}){const A=e,j=E,L=a(A.modelValue),T=a(!1),I=a(null),R=a(!1),W=()=>{"dark"===A.themeMode?R.value=!0:"light"===A.themeMode?R.value=!1:"auto"===A.themeMode&&(R.value=!("undefined"==typeof window||!window.matchMedia)&&window.matchMedia("(prefers-color-scheme: dark)").matches)},C=o(()=>R.value?"sdkwork-search-bar--dark":"sdkwork-search-bar--light"),K=o(()=>A.showAction?!(A.hideActionWhenEmpty&&!L.value):T.value);l(()=>A.themeMode,(e,a)=>{W(),"auto"===a&&"auto"!==e&&S&&(S.removeEventListener("change",U),S=null),"auto"===e&&"auto"!==a&&"undefined"!=typeof window&&window.matchMedia&&(S=window.matchMedia("(prefers-color-scheme: dark)"),S.addEventListener("change",U),U())});let S=null;const U=()=>{"auto"===A.themeMode&&(R.value=S?.matches||!1)};s(()=>{W(),"auto"===A.themeMode&&"undefined"!=typeof window&&window.matchMedia&&(S=window.matchMedia("(prefers-color-scheme: dark)"),U(),S.addEventListener("change",U))}),t(()=>{S&&S.removeEventListener("change",U)}),l(()=>A.modelValue,e=>{e!==L.value&&(L.value=e)}),l(L,e=>{e!==A.modelValue&&(j("update:modelValue",e),j("input",e))});const q=e=>{T.value=!0,j("focus",e)},F=e=>{T.value=!1,j("blur",e)},P=e=>{const a=e.target;L.value=a.value},Q=e=>{j("keypress",e)},z=()=>{j("search",L.value)},D=()=>{L.value="",T.value=!1,j("cancel"),j("update:modelValue","")},G=()=>{console.log("handleClear called, currentValue before:",L.value),console.log("clearable prop:",A.clearable),console.log("disabled prop:",A.disabled),L.value="",console.log("currentValue after clear:",L.value),j("clear"),j("update:modelValue",""),f(()=>{console.log("nextTick - inputRef exists:",!!I.value),I.value?.focus()})};return _({focus:()=>{I.value?.focus()},blur:()=>{I.value?.blur()},getInput:()=>I.value,getValue:()=>L.value,setValue:e=>{L.value=e},clear:G,cancel:D}),W(),(a,o)=>(m(),d("div",{class:p(["sdkwork-search-bar",[{"sdkwork-search-bar--disabled":e.disabled,"sdkwork-search-bar--readonly":e.readonly,"sdkwork-search-bar--show-action":e.showAction,"sdkwork-search-bar--round":"round"===e.shape},C.value]]),style:v({background:e.background})},[a.$slots.left?(m(),d("div",M,[n(a.$slots,"left",{},void 0,!0)])):r("",!0),u("div",V,[u("div",x,[n(a.$slots,"left-icon",{},()=>[w(g,{icon:"material-symbols:search-rounded",width:"16",height:"16"})],!0)]),u("div",B,[c(u("input",{ref_key:"inputRef",ref:I,"onUpdate:modelValue":o[0]||(o[0]=e=>L.value=e),type:e.type,placeholder:e.placeholder,disabled:e.disabled,readonly:e.readonly,maxlength:e.maxlength,autofocus:e.autofocus,class:p([[`sdkwork-search-bar__input--${e.align}`],"sdkwork-search-bar__input"]),onFocus:q,onBlur:F,onInput:P,onKeypress:Q,onKeyup:[h(z,["enter"]),h(D,["esc"])]},null,42,$),[[i,L.value]]),e.clearable&&L.value&&!e.disabled?(m(),d("div",{key:0,class:"sdkwork-search-bar__clear",onMousedown:k(G,["prevent"]),onTouchstart:k(G,["prevent"])},[n(a.$slots,"clear-icon",{},()=>[w(g,{icon:"material-symbols:close-rounded",width:"16",height:"16"})],!0)],32)):r("",!0)])]),K.value?(m(),d("div",{key:1,class:"sdkwork-search-bar__action",onClick:D},[n(a.$slots,"action",{},()=>[b(y(e.actionText),1)],!0)])):r("",!0)],6))}}),[["__scopeId","data-v-0947f3a8"]]);export{E as _};
