import{_ as e}from"./index-mGUiS-yG.js";import{P as o}from"./index-z7NB4-1J.js";import{L as t}from"./index-71u4jA4R.js";import{D as l,u as a,E as s,S as i}from"./shared-BHV4AZq-.js";import{L as n}from"./ListItem-DTjFzhTd.js";import{k as r,a as d,f as c,w as m,o as f,n as p,b as g,P as u,R as h,Z as b,u as v,ac as S,q as y,a0 as w,Q as B,U as x,ad as k,j as M,F as z,Y as D,W as L,i as F}from"./vue-vendor-B1RsE4Tz.js";const P=e(r({__name:"sdkwork-api-list",props:{api:{type:Function,default:void 0},service:{default:void 0},params:{default:()=>({})},pageableParams:{default:()=>({})},selectable:{type:Boolean,default:l.selectable},deletable:{type:Boolean,default:l.deletable},searchable:{type:Boolean,default:l.searchable},pageSize:{default:l.pageSize},itemKey:{default:l.itemKey},itemTitleField:{default:l.itemTitleField},itemDescriptionField:{default:l.itemDescriptionField},topSpacing:{default:l.topSpacing},leftSpacing:{default:l.leftSpacing},rightSpacing:{default:l.rightSpacing},showBorderBottom:{type:Boolean,default:l.showBorderBottom},borderBottomLeftOffset:{default:l.borderBottomLeftOffset},showNoMoreData:{type:Boolean,default:l.showNoMoreData},themeMode:{default:l.themeMode},minSize:{},itemGap:{},fixed:{type:Boolean},buffer:{},bufferTop:{},bufferBottom:{},horizontal:{type:Boolean},scrollDistance:{},fixSelection:{type:Boolean},start:{},offset:{},listStyle:{},listClass:{},itemStyle:{},itemClass:{},renderControl:{}},emits:["select","delete","search","reach-top","reach-bottom","scroll","item-resize","range-update","load"],setup(e,{expose:l,emit:r}){const P=e,_=r,C=d([]),T=d(!1);d(!1),d(!1),d(0);const $=c(()=>"dark"===P.themeMode||"light"!==P.themeMode&&(!("undefined"==typeof window||!window.matchMedia)&&window.matchMedia("(prefers-color-scheme: dark)").matches)),j=c(()=>$.value?"dark-mode":"light-mode"),E=async()=>{console.error("onLoadMore==============="),G.value||R.value||!U.value?console.error("阻止重复加载，当前状态:",{loading:G.value,loadingMore:R.value,hasMore:U.value}):(R.value=!0,await Y(K.value+1,!0))},{dataList:I,currentPage:K,totalElements:O,totalPages:N,loading:G,loadingMore:R,hasMore:U,isEmpty:V,loadData:q}=a({api:P.api,service:P.service,params:P.params,pageableParams:P.pageableParams,pageSize:P.pageSize,autoLoad:!0}),A=c(()=>"number"==typeof P.topSpacing?`${P.topSpacing}px`:P.topSpacing),Q=c(()=>"number"==typeof P.leftSpacing?`${P.leftSpacing}px`:P.leftSpacing),H=c(()=>"number"==typeof P.rightSpacing?`${P.rightSpacing}px`:P.rightSpacing);c(()=>({paddingTop:A.value,paddingLeft:Q.value,paddingRight:H.value}));const W=(e,o)=>{const t=e[P.itemKey];return null!=t&&""!==t?t:`index_${o}`},Y=async(e=0,o=!1)=>{try{const t=I.value.length;await q(e,o);(0===e||I.value.length!==t)&&_("load",{content:I.value,number:K.value,totalElements:O.value,totalPages:N.value,last:!U.value})}catch(t){console.error("加载数据失败:",t)}finally{G.value=!1}},Z=async()=>{try{T.value=!0,await Y(0)}catch(e){console.error("刷新数据失败:",e)}finally{T.value=!1}},J=e=>{_("search",e),Y(0)},X=e=>{if(P.selectable){const o=C.value.findIndex(o=>W(o,-1)===W(e,-1));o>-1?C.value.splice(o,1):C.value.push(e)}_("select",e)},ee=e=>{_("delete",e)};m(()=>P.params,()=>{Y(0)},{deep:!0}),m(()=>P.pageSize,()=>{Y(0)});const oe=()=>{if("undefined"!=typeof window){const e=document.querySelector(".sdkwork-api-list");if(e){P.searchable;e.clientHeight}}};return f(()=>{console.log("=== sdkwork-api-list 所有属性配置 ==="),console.log("基础API配置:"),console.log("- api:",P.api),console.log("- service:",P.service),console.log("- params:",P.params),console.log("- pageableParams:",P.pageableParams),console.log("- pageSize:",P.pageSize),console.log("功能配置:"),console.log("- selectable:",P.selectable),console.log("- deletable:",P.deletable),console.log("- searchable:",P.searchable),console.log("- itemKey:",P.itemKey),console.log("- itemTitleField:",P.itemTitleField),console.log("- itemDescriptionField:",P.itemDescriptionField),console.log("主题和样式配置:"),console.log("- themeMode:",P.themeMode),console.log("- showBorderBottom:",P.showBorderBottom),console.log("- borderBottomLeftOffset:",P.borderBottomLeftOffset),console.log("- showNoMoreData:",P.showNoMoreData),console.log("- topSpacing:",P.topSpacing),console.log("- leftSpacing:",P.leftSpacing),console.log("- rightSpacing:",P.rightSpacing),console.log("虚拟滚动配置:"),console.log("- minSize:",P.minSize),console.log("- itemGap:",P.itemGap),console.log("- fixed:",P.fixed),console.log("- buffer:",P.buffer),console.log("- bufferTop:",P.bufferTop),console.log("- bufferBottom:",P.bufferBottom),console.log("- horizontal:",P.horizontal),console.log("- scrollDistance:",P.scrollDistance),console.log("- fixSelection:",P.fixSelection),console.log("- start:",P.start),console.log("- offset:",P.offset),console.log("- listStyle:",P.listStyle),console.log("- listClass:",P.listClass),console.log("- itemStyle:",P.itemStyle),console.log("- itemClass:",P.itemClass),console.log("- renderControl:",P.renderControl),console.log("=== 配置打印结束 ==="),Y(0),p(()=>{oe()}),"undefined"!=typeof window&&window.addEventListener("resize",oe)}),g(()=>{"undefined"!=typeof window&&window.removeEventListener("resize",oe)}),l({refresh:()=>Y(0),loadMore:()=>Y(K.value+1,!0),getData:()=>I.value,getSelectedItems:()=>C.value,clearSelected:()=>{C.value=[]},setSelectedItems:e=>{C.value=e}}),(l,a)=>{const r=t,d=o;return B(),u("div",{class:h(["sdkwork-api-list",j.value])},[v(V)&&!v(G)?(B(),b(s,S(y({key:0},{empty:!0})),{empty:w(()=>[x(l.$slots,"empty",S(k({empty:!0})),void 0,!0)]),_:3},16)):(B(),b(d,{key:1,modelValue:T.value,"onUpdate:modelValue":a[1]||(a[1]=e=>T.value=e),onRefresh:Z},{default:w(()=>[M(r,{loading:v(G),"onUpdate:loading":a[0]||(a[0]=e=>F(G)?G.value=e:null),finished:!v(U),"finished-text":"没有更多了",onLoad:E,"immediate-check":!1,offset:300},{header:w(()=>[x(l.$slots,"header",{},()=>[e.searchable?(B(),b(i,{key:0,searchable:e.searchable,onSearch:J},null,8,["searchable"])):L("",!0)],!0)]),footer:w(()=>[x(l.$slots,"footer",{},void 0,!0)]),default:w(()=>[(B(!0),u(z,null,D(v(I),(o,t)=>{return B(),u("div",{key:W(o,t)},[M(n,{item:o,index:t,selectable:e.selectable,deletable:e.deletable,"is-selected":(a=o,C.value.some(e=>W(e,-1)===W(a,-1))),"item-key":W(o,t),"item-title-field":e.itemTitleField,"item-description-field":e.itemDescriptionField,"theme-mode":e.themeMode,"show-border-bottom":e.showBorderBottom,"border-bottom-left-offset":e.borderBottomLeftOffset,onSelect:X,onDelete:ee},{default:w(({item:e,index:o,selected:t})=>[x(l.$slots,"default",{item:e,index:o,selected:t},void 0,!0)]),_:3},8,["item","index","selectable","deletable","is-selected","item-key","item-title-field","item-description-field","theme-mode","show-border-bottom","border-bottom-left-offset"])]);var a}),128))]),_:3},8,["loading","finished"])]),_:3},8,["modelValue"]))],2)}}}),[["__scopeId","data-v-21417d6d"]]);export{P as S};
