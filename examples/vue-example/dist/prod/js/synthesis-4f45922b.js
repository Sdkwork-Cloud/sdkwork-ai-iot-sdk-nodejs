import{_ as e,a}from"./sdkwork-cell-group-f9040361.js";import{l,s as t,I as o,B as s,aM as u,_ as r}from"./index-34815b62.js";/* empty css              */import{_ as i,a as d}from"./sdkwork-collapse-item-4f5db70a.js";import{_ as m}from"./sdkwork-popup-2839b588.js";/* empty css              *//* empty css              */import{P as n}from"./index-e4d82c91.js";/* empty css              *//* empty css              */import{S as v}from"./sdkwork-voice-speaker-category-list-popup-26672839.js";import{k as c,r as p,a as h,c as f,w as y,Q as k,R as x,S as g,j as w,a0 as j,X as _,$ as V,Z as b,a4 as M,U}from"./vue-vendor-905d75e5.js";import{F as C}from"./index-d9bf0347.js";import"./sdkwork-icon-79456167.js";import"./utils-vendor-b5712723.js";import"./index-a966f53b.js";import"./sdkwork-pull-refresh-bd126f9c.js";import"./index-8ec85bf4.js";import"./shared-f3996f0d.js";import"./sdkwork-search-bar-d9125bb7.js";import"./index-3ae7521b.js";import"./use-id-350fcd7b.js";import"./ListItem-b2f4f4bf.js";import"./LoadingSection-50beb699.js";import"./LoadMoreSection-8eb45153.js";import"./sdkwork-voice-clone-f3949dc2.js";import"./index-89cf3eae.js";import"./index-0b87abd1.js";import"./index-8c878aea.js";const S={class:"text-input-section"},P={class:"text-field-wrapper"},z={class:"char-count-bottom"},A={class:"voice-selector"},B={key:0,class:"selected-voice"},T={key:1,class:"placeholder"},F={class:"slider-wrapper"},I={class:"slider-value"},E={class:"slider-wrapper"},L={class:"slider-value"},$={class:"slider-wrapper"},H={class:"slider-value"},N={class:"format-value"},D={class:"bottom-action-bar"},G=r(c({__name:"sdkwork-voice-synthesis",props:{themeMode:{default:"auto"},defaultText:{default:""},defaultSpeaker:{},showAdvancedParams:{type:Boolean,default:!0}},emits:["start","complete","error","speaker-change"],setup(r,{emit:c}){const{currentTheme:G,isDarkMode:K}=l(),Q=r,R=c,J=p(Q.defaultText),O=p(Q.defaultSpeaker||null),W=p(!1),X=p(!1),Z=p(Q.showAdvancedParams?["params"]:[]),q=p(!1),Y=p(!1),ee=p(null),ae=h({speed:1,volume:80,pitch:0,format:"mp3"}),le=[{text:"MP3",value:"mp3"},{text:"WAV",value:"wav"},{text:"PCM",value:"pcm"}],te=p([ae.format]),oe=p(""),se=f(()=>`theme-${G.value}`),ue=f(()=>"auto"===Q.themeMode?G.value:Q.themeMode),re=f(()=>"100%"),ie=f(()=>J.value.trim().length>0&&null!==O.value);y(()=>Q.defaultText,e=>{e&&!J.value&&(J.value=e)}),y(()=>Q.defaultSpeaker,e=>{e&&!O.value&&(O.value=e)});const de=()=>{J.value.trim()?J.value.length>1e3?oe.value="文本长度不能超过1000个字符":oe.value="":oe.value="请输入合成文本"},me=e=>{const a=le.find(a=>a.value===e);return a?a.text:"MP3"},ne=e=>{O.value=e,W.value=!1,R("speaker-change",e),t(`已选择发音人: ${e.displayName||e.name}`)},ve=e=>{Array.isArray(e)?te.value=e:e&&"object"==typeof e&&e.selectedValues&&(te.value=e.selectedValues)},ce=e=>{let a=e;Array.isArray(e)?a=e[0]:e&&"object"==typeof e&&e.selectedValues&&(a=e.selectedValues[0]),ae.format=a,X.value=!1},pe=async()=>{if(O.value&&J.value.trim()){q.value=!0;try{const e=J.value.length>50?J.value.substring(0,50)+"...":J.value,a=await ke(e,O.value,ae);ee.value&&a&&(ee.value.src=a,await ee.value.play())}catch(e){console.error("试听失败:",e),t("试听失败，请重试")}finally{q.value=!1}}else t("请先选择发音人和输入文本")},he=async()=>{if(ie.value){Y.value=!0;try{const e={text:J.value,speaker:O.value,params:{...ae}};R("start",e);const a=await xe(e);R("complete",a),t("合成完成"),ee.value&&a.audioUrl&&(ee.value.src=a.audioUrl,await ee.value.play())}catch(e){console.error("合成失败:",e),R("error",e),t("合成失败，请重试")}finally{Y.value=!1}}else t("请完善合成信息")},fe=()=>{console.log("音频播放结束")},ye=e=>{console.error("音频播放错误:",e),t("音频播放失败")},ke=async(e,a,l)=>(await new Promise(e=>setTimeout(e,1e3)),"https://example.com/preview-audio.mp3"),xe=async e=>(await new Promise(e=>setTimeout(e,2e3)),{audioUrl:"https://example.com/synthesis-result.mp3",duration:10,fileSize:102400});return(l,t)=>{const r=C,c=e,p=o,h=a,f=s,y=u,G=n,K=m,Q=i,R=d;return k(),x("div",{class:_(["voice-synthesis",se.value])},[g("div",S,[w(c,{"theme-mode":ue.value},{default:j(()=>[g("div",P,[w(r,{modelValue:J.value,"onUpdate:modelValue":t[0]||(t[0]=e=>J.value=e),label:"合成文本","label-align":"top",type:"textarea",placeholder:"请输入要合成的文本内容",autosize:{minHeight:100,maxHeight:200},maxlength:1e3,"error-message":oe.value,onBlur:de},null,8,["modelValue","error-message"]),g("div",z,[g("span",{class:_(["char-count",{error:J.value.length>1e3}])},V(J.value.length)+"/1000 ",3)])])]),_:1},8,["theme-mode"])]),w(c,{class:"voice-section","theme-mode":ue.value},{default:j(()=>[w(h,{title:"发音人",center:"","is-link":"",onClick:t[1]||(t[1]=e=>W.value=!0),"theme-mode":ue.value},{value:j(()=>[g("div",A,[w(p,{name:"music",class:"voice-icon"}),O.value?(k(),x("span",B,V(O.value.displayName||O.value.name),1)):(k(),x("span",T,"请选择发音人"))])]),_:1},8,["theme-mode"]),O.value?(k(),b(h,{key:0,title:"试听",center:"","theme-mode":ue.value},{value:j(()=>[w(f,{type:"primary",size:"small",onClick:pe,loading:q.value,disabled:!J.value.trim()},{default:j(()=>[...t[11]||(t[11]=[M(" 试听 ",-1)])]),_:1},8,["loading","disabled"])]),_:1},8,["theme-mode"])):U("",!0)]),_:1},8,["theme-mode"]),w(R,{modelValue:Z.value,"onUpdate:modelValue":t[8]||(t[8]=e=>Z.value=e),class:"params-section","theme-mode":ue.value},{default:j(()=>[w(Q,{title:"高级参数设置",name:"params","theme-mode":ue.value},{default:j(()=>[w(h,{title:"语速",center:"","theme-mode":ue.value},{value:j(()=>[g("div",F,[w(y,{modelValue:ae.speed,"onUpdate:modelValue":t[2]||(t[2]=e=>ae.speed=e),min:.5,max:2,step:.1,"bar-height":"4px","active-color":"#1989fa"},null,8,["modelValue"]),g("span",I,V(ae.speed.toFixed(1))+"x",1)])]),_:1},8,["theme-mode"]),w(h,{title:"音量",center:"","theme-mode":ue.value},{value:j(()=>[g("div",E,[w(y,{modelValue:ae.volume,"onUpdate:modelValue":t[3]||(t[3]=e=>ae.volume=e),min:0,max:100,step:1,"bar-height":"4px","active-color":"#1989fa"},null,8,["modelValue"]),g("span",L,V(ae.volume)+"%",1)])]),_:1},8,["theme-mode"]),w(h,{title:"音调",center:"","theme-mode":ue.value},{value:j(()=>[g("div",$,[w(y,{modelValue:ae.pitch,"onUpdate:modelValue":t[4]||(t[4]=e=>ae.pitch=e),min:-10,max:10,step:1,"bar-height":"4px","active-color":"#1989fa"},null,8,["modelValue"]),g("span",H,V(ae.pitch>0?"+":"")+V(ae.pitch),1)])]),_:1},8,["theme-mode"]),w(h,{title:"音频格式",center:"","is-link":"",onClick:t[5]||(t[5]=e=>X.value=!0),"theme-mode":ue.value},{value:j(()=>[g("span",N,V(me(ae.format)),1)]),_:1},8,["theme-mode"]),w(K,{show:X.value,"onUpdate:show":t[7]||(t[7]=e=>X.value=e),position:"bottom",round:"","theme-mode":ue.value,closeable:!1},{default:j(()=>[w(G,{columns:le,"model-value":te.value,"onUpdate:modelValue":ve,onConfirm:ce,onCancel:t[6]||(t[6]=e=>X.value=!1),title:"选择音频格式"},null,8,["model-value"])]),_:1},8,["show","theme-mode"])]),_:1},8,["theme-mode"])]),_:1},8,["modelValue","theme-mode"]),g("div",D,[w(f,{type:"primary",size:"large",block:"",loading:Y.value,disabled:!ie.value,onClick:he,class:"synthesis-button"},{default:j(()=>[...t[12]||(t[12]=[M(" 开始合成 ",-1)])]),_:1},8,["loading","disabled"])]),w(v,{modelValue:W.value,"onUpdate:modelValue":t[9]||(t[9]=e=>W.value=e),title:"选择发音人",height:re.value,"selected-speaker-id":O.value?.id,"theme-mode":ue.value,onConfirm:ne,onClose:t[10]||(t[10]=e=>W.value=!1)},null,8,["modelValue","height","selected-speaker-id","theme-mode"]),g("audio",{ref_key:"audioPlayer",ref:ee,style:{display:"none"},onEnded:fe,onError:ye},null,544)],2)}}}),[["__scopeId","data-v-f40e67b7"]]),K={class:"voice-synthesis-page"},Q={key:0,class:"result-section"},R={class:"result-info"},J={class:"duration"},O={class:"file-size"},W={class:"result-actions"},X=r(c({__name:"synthesis",setup(l){const o=p("auto"),u=p("欢迎使用语音合成功能，请输入您想要转换的文本内容。"),r=p(null),i=p(null),d=p(!1),m=p(null),n=e=>{console.log("合成开始:",e),i.value=null},v=e=>{console.log("合成完成:",e),i.value=e,t("语音合成完成")},c=e=>{console.error("合成错误:",e),t("合成失败，请重试")},h=e=>{console.log("发音人变更:",e),r.value=e},f=e=>{if(0===e)return"0 B";const a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+["B","KB","MB","GB"][a]},y=async()=>{if(i.value){d.value=!0;try{m.value||(m.value=new Audio),m.value.src=i.value.audioUrl,await m.value.play(),m.value.onended=()=>{d.value=!1},m.value.onerror=()=>{d.value=!1,t("播放失败")}}catch(e){console.error("播放失败:",e),d.value=!1,t("播放失败")}}},_=()=>{if(i.value)try{const e=document.createElement("a");e.href=i.value.audioUrl,e.download=`synthesis-result.${i.value.audioUrl.split(".").pop()||"mp3"}`,e.click(),t("开始下载")}catch(e){console.error("下载失败:",e),t("下载失败")}};return(l,t)=>{const m=a,p=s,b=e;return k(),x("div",K,[w(G,{"theme-mode":o.value,"default-text":u.value,"default-speaker":r.value,"show-advanced-params":!0,onStart:n,onComplete:v,onError:c,onSpeakerChange:h},null,8,["theme-mode","default-text","default-speaker"]),i.value?(k(),x("div",Q,[w(b,{"theme-mode":o.value},{default:j(()=>[w(m,{title:"合成结果","theme-mode":o.value},{value:j(()=>[g("div",R,[g("span",J,"时长: "+V(i.value.duration)+"秒",1),g("span",O,"大小: "+V(f(i.value.fileSize)),1)])]),_:1},8,["theme-mode"]),w(m,{title:"操作","theme-mode":o.value},{value:j(()=>[g("div",W,[w(p,{type:"primary",size:"small",onClick:y,loading:d.value},{default:j(()=>[...t[0]||(t[0]=[M(" 播放 ",-1)])]),_:1},8,["loading"]),w(p,{type:"default",size:"small",onClick:_},{default:j(()=>[...t[1]||(t[1]=[M(" 下载 ",-1)])]),_:1})])]),_:1},8,["theme-mode"])]),_:1},8,["theme-mode"])])):U("",!0)])}}}),[["__scopeId","data-v-e6ff516a"]]);export{X as default};
