import{_ as e,a}from"./sdkwork-cell-group-CSApM1wu.js";import{l,I as t,B as s,aR as o,s as u,_ as i}from"./index-D7I5bQOO.js";/* empty css              */import{a as r,_ as d}from"./sdkwork-collapse-item-BpnF_Ux_.js";import{_ as m}from"./sdkwork-popup-X7Jr1MOr.js";/* empty css              */import"./index-Bl1UND2F.js";import{P as n}from"./index-vmE_PtvI.js";/* empty css              *//* empty css              */import{S as v}from"./sdkwork-voice-speaker-category-list-popup-l3-c49KX.js";import{k as p,r as c,c as h,f,w as y,P as k,Q as x,R as w,S as g,j as _,a0 as j,$ as V,Z as b,W as C,a4 as U}from"./vue-vendor-Caw1HGjZ.js";import{F as M}from"./index-BBZTmlIY.js";import"./sdkwork-icon-Bx0uCmEk.js";import"./utils-vendor-WEzSe-CR.js";import"./index-b3I6_Vtk.js";import"./sdkwork-pull-refresh-BB5GTY6x.js";import"./shared-CsRLCebr.js";import"./sdkwork-search-bar-BjfTLXVV.js";import"./index-Cb9u0upf.js";import"./use-id-BN10QhF_.js";import"./ListItem-qzG7l1FH.js";import"./LoadingSection-C7DXQLKz.js";import"./LoadMoreSection-yp3zDvW9.js";import"./sdkwork-voice-clone-DEL8G63I.js";import"./index-N-9M7szo.js";const S={class:"text-input-section"},P={class:"text-field-wrapper"},z={class:"char-count-bottom"},A={class:"voice-selector"},B={key:0,class:"selected-voice"},T={key:1,class:"placeholder"},E={class:"slider-wrapper"},F={class:"slider-value"},I={class:"slider-wrapper"},$={class:"slider-value"},L={class:"slider-wrapper"},H={class:"slider-value"},N={class:"format-value"},R={class:"bottom-action-bar"},W=i(p({__name:"sdkwork-voice-synthesis",props:{themeMode:{default:"auto"},defaultText:{default:""},defaultSpeaker:{},showAdvancedParams:{type:Boolean,default:!0}},emits:["start","complete","error","speaker-change"],setup(i,{emit:p}){const{currentTheme:W}=l(),q=i,D=p,G=c(q.defaultText),K=c(q.defaultSpeaker||null),Q=c(!1),Z=c(!1),J=c(q.showAdvancedParams?["params"]:[]),O=c(!1),X=c(!1),Y=c(null),ee=h({speed:1,volume:80,pitch:0,format:"mp3"}),ae=[{text:"MP3",value:"mp3"},{text:"WAV",value:"wav"},{text:"PCM",value:"pcm"}],le=c([ee.format]),te=c(""),se=f(()=>`theme-${W.value}`),oe=f(()=>"auto"===q.themeMode?W.value:q.themeMode),ue=f(()=>"100%"),ie=f(()=>G.value.trim().length>0&&null!==K.value);y(()=>q.defaultText,e=>{e&&!G.value&&(G.value=e)}),y(()=>q.defaultSpeaker,e=>{e&&!K.value&&(K.value=e)});const re=()=>{G.value.trim()?G.value.length>1e3?te.value="文本长度不能超过1000个字符":te.value="":te.value="请输入合成文本"},de=e=>{const a=ae.find(a=>a.value===e);return a?a.text:"MP3"},me=e=>{K.value=e,Q.value=!1,D("speaker-change",e),u(`已选择发音人: ${e.displayName||e.name}`)},ne=e=>{Array.isArray(e)?le.value=e:e&&"object"==typeof e&&e.selectedValues&&(le.value=e.selectedValues)},ve=e=>{let a=e;Array.isArray(e)?a=e[0]:e&&"object"==typeof e&&e.selectedValues&&(a=e.selectedValues[0]),ee.format=a,Z.value=!1},pe=async()=>{if(K.value&&G.value.trim()){O.value=!0;try{const e=G.value.length>50?G.value.substring(0,50)+"...":G.value,a=await ye(e,K.value,ee);Y.value&&a&&(Y.value.src=a,await Y.value.play())}catch(e){u("试听失败，请重试")}finally{O.value=!1}}else u("请先选择发音人和输入文本")},ce=async()=>{if(ie.value){X.value=!0;try{const e={text:G.value,speaker:K.value,params:{...ee}};D("start",e);const a=await ke(e);D("complete",a),u("合成完成"),Y.value&&a.audioUrl&&(Y.value.src=a.audioUrl,await Y.value.play())}catch(e){D("error",e),u("合成失败，请重试")}finally{X.value=!1}}else u("请完善合成信息")},he=()=>{},fe=e=>{u("音频播放失败")},ye=async(e,a,l)=>(await new Promise(e=>setTimeout(e,1e3)),"https://example.com/preview-audio.mp3"),ke=async e=>(await new Promise(e=>setTimeout(e,2e3)),{audioUrl:"https://example.com/synthesis-result.mp3",duration:10,fileSize:102400});return(l,u)=>{const i=M,p=e,c=t,h=a,f=s,y=o,W=n,q=m,D=d,ye=r;return x(),k("div",{class:w(["voice-synthesis",se.value])},[g("div",S,[_(p,{"theme-mode":oe.value},{default:j(()=>[g("div",P,[_(i,{modelValue:G.value,"onUpdate:modelValue":u[0]||(u[0]=e=>G.value=e),label:"合成文本","label-align":"top",type:"textarea",placeholder:"请输入要合成的文本内容",autosize:{minHeight:100,maxHeight:200},maxlength:1e3,"error-message":te.value,onBlur:re},null,8,["modelValue","error-message"]),g("div",z,[g("span",{class:w(["char-count",{error:G.value.length>1e3}])},V(G.value.length)+"/1000 ",3)])])]),_:1},8,["theme-mode"])]),_(p,{class:"voice-section","theme-mode":oe.value},{default:j(()=>[_(h,{title:"发音人",center:"","is-link":"",onClick:u[1]||(u[1]=e=>Q.value=!0),"theme-mode":oe.value},{value:j(()=>[g("div",A,[_(c,{name:"music",class:"voice-icon"}),K.value?(x(),k("span",B,V(K.value.displayName||K.value.name),1)):(x(),k("span",T,"请选择发音人"))])]),_:1},8,["theme-mode"]),K.value?(x(),b(h,{key:0,title:"试听",center:"","theme-mode":oe.value},{value:j(()=>[_(f,{type:"primary",size:"small",onClick:pe,loading:O.value,disabled:!G.value.trim()},{default:j(()=>[...u[11]||(u[11]=[U(" 试听 ",-1)])]),_:1},8,["loading","disabled"])]),_:1},8,["theme-mode"])):C("",!0)]),_:1},8,["theme-mode"]),_(ye,{modelValue:J.value,"onUpdate:modelValue":u[8]||(u[8]=e=>J.value=e),class:"params-section","theme-mode":oe.value},{default:j(()=>[_(D,{title:"高级参数设置",name:"params","theme-mode":oe.value},{default:j(()=>[_(h,{title:"语速",center:"","theme-mode":oe.value},{value:j(()=>[g("div",E,[_(y,{modelValue:ee.speed,"onUpdate:modelValue":u[2]||(u[2]=e=>ee.speed=e),min:.5,max:2,step:.1,"bar-height":"4px","active-color":"#1989fa"},null,8,["modelValue"]),g("span",F,V(ee.speed.toFixed(1))+"x",1)])]),_:1},8,["theme-mode"]),_(h,{title:"音量",center:"","theme-mode":oe.value},{value:j(()=>[g("div",I,[_(y,{modelValue:ee.volume,"onUpdate:modelValue":u[3]||(u[3]=e=>ee.volume=e),min:0,max:100,step:1,"bar-height":"4px","active-color":"#1989fa"},null,8,["modelValue"]),g("span",$,V(ee.volume)+"%",1)])]),_:1},8,["theme-mode"]),_(h,{title:"音调",center:"","theme-mode":oe.value},{value:j(()=>[g("div",L,[_(y,{modelValue:ee.pitch,"onUpdate:modelValue":u[4]||(u[4]=e=>ee.pitch=e),min:-10,max:10,step:1,"bar-height":"4px","active-color":"#1989fa"},null,8,["modelValue"]),g("span",H,V(ee.pitch>0?"+":"")+V(ee.pitch),1)])]),_:1},8,["theme-mode"]),_(h,{title:"音频格式",center:"","is-link":"",onClick:u[5]||(u[5]=e=>Z.value=!0),"theme-mode":oe.value},{value:j(()=>[g("span",N,V(de(ee.format)),1)]),_:1},8,["theme-mode"]),_(q,{show:Z.value,"onUpdate:show":u[7]||(u[7]=e=>Z.value=e),position:"bottom",round:"","theme-mode":oe.value,closeable:!1},{default:j(()=>[_(W,{columns:ae,"model-value":le.value,"onUpdate:modelValue":ne,onConfirm:ve,onCancel:u[6]||(u[6]=e=>Z.value=!1),title:"选择音频格式"},null,8,["model-value"])]),_:1},8,["show","theme-mode"])]),_:1},8,["theme-mode"])]),_:1},8,["modelValue","theme-mode"]),g("div",R,[_(f,{type:"primary",size:"large",block:"",loading:X.value,disabled:!ie.value,onClick:ce,class:"synthesis-button"},{default:j(()=>[...u[12]||(u[12]=[U(" 开始合成 ",-1)])]),_:1},8,["loading","disabled"])]),_(v,{modelValue:Q.value,"onUpdate:modelValue":u[9]||(u[9]=e=>Q.value=e),title:"选择发音人",height:ue.value,"selected-speaker-id":K.value?.id,"theme-mode":oe.value,onConfirm:me,onClose:u[10]||(u[10]=e=>Q.value=!1)},null,8,["modelValue","height","selected-speaker-id","theme-mode"]),g("audio",{ref_key:"audioPlayer",ref:Y,style:{display:"none"},onEnded:he,onError:fe},null,544)],2)}}}),[["__scopeId","data-v-f40e67b7"]]),q={class:"voice-synthesis-page"},D={key:0,class:"result-section"},G={class:"result-info"},K={class:"duration"},Q={class:"file-size"},Z={class:"result-actions"},J=i(p({__name:"synthesis",setup(l){const t=c("auto"),o=c("欢迎使用语音合成功能，请输入您想要转换的文本内容。"),i=c(null),r=c(null),d=c(!1),m=c(null),n=e=>{r.value=null},v=e=>{r.value=e,u("语音合成完成")},p=e=>{u("合成失败，请重试")},h=e=>{i.value=e},f=e=>{if(0===e)return"0 B";const a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+["B","KB","MB","GB"][a]},y=async()=>{if(r.value){d.value=!0;try{m.value||(m.value=new Audio),m.value.src=r.value.audioUrl,await m.value.play(),m.value.onended=()=>{d.value=!1},m.value.onerror=()=>{d.value=!1,u("播放失败")}}catch(e){d.value=!1,u("播放失败")}}},w=()=>{if(r.value)try{const e=document.createElement("a");e.href=r.value.audioUrl,e.download=`synthesis-result.${r.value.audioUrl.split(".").pop()||"mp3"}`,e.click(),u("开始下载")}catch(e){u("下载失败")}};return(l,u)=>{const m=a,c=s,b=e;return x(),k("div",q,[_(W,{"theme-mode":t.value,"default-text":o.value,"default-speaker":i.value,"show-advanced-params":!0,onStart:n,onComplete:v,onError:p,onSpeakerChange:h},null,8,["theme-mode","default-text","default-speaker"]),r.value?(x(),k("div",D,[_(b,{"theme-mode":t.value},{default:j(()=>[_(m,{title:"合成结果","theme-mode":t.value},{value:j(()=>[g("div",G,[g("span",K,"时长: "+V(r.value.duration)+"秒",1),g("span",Q,"大小: "+V(f(r.value.fileSize)),1)])]),_:1},8,["theme-mode"]),_(m,{title:"操作","theme-mode":t.value},{value:j(()=>[g("div",Z,[_(c,{type:"primary",size:"small",onClick:y,loading:d.value},{default:j(()=>[...u[0]||(u[0]=[U(" 播放 ",-1)])]),_:1},8,["loading"]),_(c,{type:"default",size:"small",onClick:w},{default:j(()=>[...u[1]||(u[1]=[U(" 下载 ",-1)])]),_:1})])]),_:1},8,["theme-mode"])]),_:1},8,["theme-mode"])])):C("",!0)])}}}),[["__scopeId","data-v-e6ff516a"]]);export{J as default};
