import{_ as e}from"./index-5affcab4.js";import{P as o}from"./index-e159e7ef.js";import{L as t}from"./index-56f0d1d3.js";import{D as l,u as a,E as s,S as i}from"./shared-1cf0c357.js";import{L as n}from"./ListItem-783a2127.js";import{k as r,r as d,c,w as f,b as m,n as p,o as g,Q as u,R as h,u as b,Z as v,a0 as S,W as y,ad as w,ae as B,q as x,j as k,U as M,F as z,Y as D,f as L,X as F}from"./vue-vendor-a2672387.js";const P=e(r({__name:"sdkwork-api-list",props:{api:{type:Function,default:void 0},service:{default:void 0},params:{default:()=>({})},pageableParams:{default:()=>({})},selectable:{type:Boolean,default:l.selectable},deletable:{type:Boolean,default:l.deletable},searchable:{type:Boolean,default:l.searchable},pageSize:{default:l.pageSize},itemKey:{default:l.itemKey},itemTitleField:{default:l.itemTitleField},itemDescriptionField:{default:l.itemDescriptionField},topSpacing:{default:l.topSpacing},leftSpacing:{default:l.leftSpacing},rightSpacing:{default:l.rightSpacing},showBorderBottom:{type:Boolean,default:l.showBorderBottom},borderBottomLeftOffset:{default:l.borderBottomLeftOffset},showNoMoreData:{type:Boolean,default:l.showNoMoreData},themeMode:{default:l.themeMode},minSize:{},itemGap:{},fixed:{type:Boolean},buffer:{},bufferTop:{},bufferBottom:{},horizontal:{type:Boolean},scrollDistance:{},fixSelection:{type:Boolean},start:{},offset:{},listStyle:{},listClass:{},itemStyle:{},itemClass:{},renderControl:{}},emits:["select","delete","search","reach-top","reach-bottom","scroll","item-resize","range-update","load"],setup(e,{expose:l,emit:r}){const P=e,T=r,_=d([]),C=d(!1);d(!1),d(!1),d(0);const $=c(()=>"dark"===P.themeMode||"light"!==P.themeMode&&(!("undefined"==typeof window||!window.matchMedia)&&window.matchMedia("(prefers-color-scheme: dark)").matches)),j=c(()=>$.value?"dark-mode":"light-mode"),E=async()=>{console.error("onLoadMore==============="),R.value||G.value||!U.value?console.error("阻止重复加载，当前状态:",{loading:R.value,loadingMore:G.value,hasMore:U.value}):(G.value=!0,await Y(K.value+1,!0))},{dataList:I,currentPage:K,totalElements:O,totalPages:N,loading:R,loadingMore:G,hasMore:U,isEmpty:V,loadData:q,onRefresh:X}=a({api:P.api,service:P.service,params:P.params,pageableParams:P.pageableParams,pageSize:P.pageSize,autoLoad:!0}),A=c(()=>"number"==typeof P.topSpacing?`${P.topSpacing}px`:P.topSpacing),H=c(()=>"number"==typeof P.leftSpacing?`${P.leftSpacing}px`:P.leftSpacing),Q=c(()=>"number"==typeof P.rightSpacing?`${P.rightSpacing}px`:P.rightSpacing);c(()=>({paddingTop:A.value,paddingLeft:H.value,paddingRight:Q.value}));const W=(e,o)=>{const t=e[P.itemKey];return null!=t&&""!==t?t:`index_${o}`},Y=async(e=0,o=!1)=>{try{const t=I.value.length;await q(e,o);(0===e||I.value.length!==t)&&T("load",{content:I.value,number:K.value,totalElements:O.value,totalPages:N.value,last:!U.value})}catch(t){console.error("加载数据失败:",t)}finally{R.value=!1}},Z=async()=>{try{C.value=!0,await Y(0)}catch(e){console.error("刷新数据失败:",e)}finally{C.value=!1}},J=e=>{T("search",e),Y(0)},ee=e=>{if(P.selectable){const o=_.value.findIndex(o=>W(o,-1)===W(e,-1));o>-1?_.value.splice(o,1):_.value.push(e)}T("select",e)},oe=e=>{T("delete",e)};f(()=>P.params,()=>{Y(0)},{deep:!0}),f(()=>P.pageSize,()=>{Y(0)});const te=()=>{if("undefined"!=typeof window){const e=document.querySelector(".sdkwork-api-list");if(e){P.searchable;e.clientHeight}}};return m(()=>{console.log("=== sdkwork-api-list 所有属性配置 ==="),console.log("基础API配置:"),console.log("- api:",P.api),console.log("- service:",P.service),console.log("- params:",P.params),console.log("- pageableParams:",P.pageableParams),console.log("- pageSize:",P.pageSize),console.log("功能配置:"),console.log("- selectable:",P.selectable),console.log("- deletable:",P.deletable),console.log("- searchable:",P.searchable),console.log("- itemKey:",P.itemKey),console.log("- itemTitleField:",P.itemTitleField),console.log("- itemDescriptionField:",P.itemDescriptionField),console.log("主题和样式配置:"),console.log("- themeMode:",P.themeMode),console.log("- showBorderBottom:",P.showBorderBottom),console.log("- borderBottomLeftOffset:",P.borderBottomLeftOffset),console.log("- showNoMoreData:",P.showNoMoreData),console.log("- topSpacing:",P.topSpacing),console.log("- leftSpacing:",P.leftSpacing),console.log("- rightSpacing:",P.rightSpacing),console.log("虚拟滚动配置:"),console.log("- minSize:",P.minSize),console.log("- itemGap:",P.itemGap),console.log("- fixed:",P.fixed),console.log("- buffer:",P.buffer),console.log("- bufferTop:",P.bufferTop),console.log("- bufferBottom:",P.bufferBottom),console.log("- horizontal:",P.horizontal),console.log("- scrollDistance:",P.scrollDistance),console.log("- fixSelection:",P.fixSelection),console.log("- start:",P.start),console.log("- offset:",P.offset),console.log("- listStyle:",P.listStyle),console.log("- listClass:",P.listClass),console.log("- itemStyle:",P.itemStyle),console.log("- itemClass:",P.itemClass),console.log("- renderControl:",P.renderControl),console.log("=== 配置打印结束 ==="),Y(0),p(()=>{te()}),"undefined"!=typeof window&&window.addEventListener("resize",te)}),g(()=>{"undefined"!=typeof window&&window.removeEventListener("resize",te)}),l({refresh:()=>Y(0),loadMore:()=>Y(K.value+1,!0),getData:()=>I.value,getSelectedItems:()=>_.value,clearSelected:()=>{_.value=[]},setSelectedItems:e=>{_.value=e}}),(l,a)=>{const r=t,d=o;return u(),h("div",{class:F(["sdkwork-api-list",j.value])},[b(V)&&!b(R)?(u(),v(s,w(x({key:0},{empty:!0})),{empty:S(()=>[y(l.$slots,"empty",w(B({empty:!0})),void 0,!0)]),_:3},16)):(u(),v(d,{key:1,modelValue:C.value,"onUpdate:modelValue":a[1]||(a[1]=e=>C.value=e),onRefresh:Z},{default:S(()=>[k(r,{loading:b(R),"onUpdate:loading":a[0]||(a[0]=e=>L(R)?R.value=e:null),finished:!b(U),"finished-text":"没有更多了",onLoad:E,"immediate-check":!1,offset:300},{header:S(()=>[y(l.$slots,"header",{},()=>[e.searchable?(u(),v(i,{key:0,searchable:e.searchable,onSearch:J},null,8,["searchable"])):M("",!0)],!0)]),footer:S(()=>[y(l.$slots,"footer",{},void 0,!0)]),default:S(()=>[(u(!0),h(z,null,D(b(I),(o,t)=>{return u(),h("div",{key:W(o,t)},[k(n,{item:o,index:t,selectable:e.selectable,deletable:e.deletable,"is-selected":(a=o,_.value.some(e=>W(e,-1)===W(a,-1))),"item-key":W(o,t),"item-title-field":e.itemTitleField,"item-description-field":e.itemDescriptionField,"theme-mode":e.themeMode,"show-border-bottom":e.showBorderBottom,"border-bottom-left-offset":e.borderBottomLeftOffset,onSelect:ee,onDelete:oe},{default:S(({item:e,index:o,selected:t})=>[y(l.$slots,"default",{item:e,index:o,selected:t},void 0,!0)]),_:3},8,["item","index","selectable","deletable","is-selected","item-key","item-title-field","item-description-field","theme-mode","show-border-bottom","border-bottom-left-offset"])]);var a}),128))]),_:3},8,["loading","finished"])]),_:3},8,["modelValue"]))],2)}}}),[["__scopeId","data-v-21417d6d"]]);export{P as S};
