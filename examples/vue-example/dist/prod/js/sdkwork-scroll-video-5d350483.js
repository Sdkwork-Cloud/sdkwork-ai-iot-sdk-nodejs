import{_ as e}from"./sdkwork-popup-2839b588.js";import{m as a,M as l,o as t,I as o,_ as s,s as i,B as n,a as r,L as u}from"./index-34815b62.js";import{S as c}from"./sdkwork-video-player-77faa015.js";/* empty css              *//* empty css              *//* empty css              */import{I as d}from"./index-89cf3eae.js";import{k as v,Q as m,R as p,S as f,j as y,$ as h,a1 as k,r as g,c as w,a0 as b,a4 as C,U as x,w as _,Z as z,V as T,b as I,o as S,F as V,Y as L,X as j,n as B}from"./vue-vendor-905d75e5.js";import{S as F}from"./sdkwork-api-list-7d9e01ff.js";import{F as M}from"./index-d9bf0347.js";import{T as U}from"./index-a1fe09a6.js";class D extends a.BaseService{constructor(){super(l.create(t.CommentsManager))}async reply(e,a,l){const t=await this.manager.reply(e,a,l);return null==t||null==t.data?Promise.reject(new Error("data error!")):t.data}async like(e,a){const l=await this.manager.like(e,a);return null==l||null==l.data?Promise.reject(new Error("data error!")):l.data}async unlike(e,a){const l=await this.manager.unlike(e,a);return null==l||null==l.data?Promise.reject(new Error("data error!")):l.data}}const P={class:"comment-item"},$={class:"user-avatar"},E={class:"comment-content"},Y={class:"user-info"},q={class:"username"},Q={class:"create-time"},R={class:"comment-text"},K={class:"comment-actions"},A={class:"like-count"},H=s(v({__name:"comments-list-item",props:{comment:{}},emits:["like","reply"],setup(e,{emit:a}){const l=e,t=a,s=()=>{t("like",l.comment)},i=()=>{t("reply",l.comment)},n=e=>{const a=new Date(e),l=(new Date).getTime()-a.getTime();return l<6e4?"刚刚":l<36e5?Math.floor(l/6e4)+"分钟前":l<864e5?Math.floor(l/36e5)+"小时前":l<2592e6?Math.floor(l/864e5)+"天前":a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate()};return(a,l)=>{const t=d,r=o;return m(),p("div",P,[f("div",$,[y(t,{src:e.comment.user?.avatar||"https://via.placeholder.com/40",width:"40",height:"40",radius:"20",fit:"cover"},null,8,["src"])]),f("div",E,[f("div",Y,[f("span",q,h(e.comment.user?.username||"匿名用户"),1),f("span",Q,h(n(e.comment.createTime)),1)]),f("div",R,h(e.comment.content),1),f("div",K,[f("div",{class:"like-action",onClick:k(s,["stop"])},[y(r,{name:e.comment.liked?"like":"like-o",color:e.comment.liked?"#ff2442":"#999",size:"14"},null,8,["name","color"]),f("span",A,h(e.comment.likeCount),1)]),f("span",{class:"reply-btn",onClick:k(i,["stop"])},"回复")])])])}}}),[["__scopeId","data-v-e618d5c7"]]),N={class:"comments-container"},O={key:0,class:"reply-input-container"},W={class:"reply-actions"},X=s(v({__name:"sdkwork-comments-list",props:{queryParams:{default:()=>({})},selectable:{type:Boolean,default:!1},deletable:{type:Boolean,default:!1},searchable:{type:Boolean,default:!1},itemKey:{default:"id"},itemTitleField:{default:"content"},itemDescriptionField:{default:"user.username"}},emits:["select","delete","search","like","reply"],setup(e,{emit:a}){const l=e,t=a,o=new D,s=g(null),r=g(null),u=g(""),c=g(""),d=w(()=>({...l.queryParams,keyword:c.value})),v=async e=>{try{return await o.listByPage({},e)}catch(a){throw i("获取评论失败"),a}},h=e=>{t("select",e)},k=async e=>{try{await o.delete(e.id),i("删除成功"),s.value?.refresh()}catch(a){i("删除失败")}t("delete",e)},_=e=>{c.value=e,t("search",e)},z=async e=>{try{e.liked?(await o.unlike(e.id),e.likeCount--):(await o.like(e.id),e.likeCount++),e.liked=!e.liked,t("like",e)}catch(a){i("操作失败")}},T=e=>{r.value=e,u.value=""},I=()=>{r.value=null,u.value=""},S=async()=>{if(r.value&&u.value.trim())try{await o.reply({userId:r.value.user.id,content:u.value.trim()},r.value.id),i("回复成功"),t("reply",r.value,u.value.trim()),s.value?.refresh(),I()}catch(e){i("回复失败")}};return(a,l)=>{const t=M,o=n;return m(),p("div",N,[y(F,{ref_key:"apiListRef",ref:s,api:v,params:d.value,"item-key":e.itemKey,"item-title-field":e.itemTitleField,"item-description-field":e.itemDescriptionField,selectable:e.selectable,deletable:e.deletable,searchable:e.searchable,onSelect:h,onDelete:k,onSearch:_},{default:b(({item:e})=>[y(H,{comment:e,onLike:z,onReply:T},null,8,["comment"])]),_:1},8,["params","item-key","item-title-field","item-description-field","selectable","deletable","searchable"]),r.value?(m(),p("div",O,[y(t,{modelValue:u.value,"onUpdate:modelValue":l[0]||(l[0]=e=>u.value=e),placeholder:`回复 @${r.value.user.username}`,rows:"1",autosize:"",type:"textarea"},null,8,["modelValue","placeholder"]),f("div",W,[y(o,{size:"small",onClick:I},{default:b(()=>[...l[1]||(l[1]=[C("取消",-1)])]),_:1}),y(o,{type:"primary",size:"small",disabled:!u.value.trim(),onClick:S},{default:b(()=>[...l[2]||(l[2]=[C(" 发送 ",-1)])]),_:1},8,["disabled"])])])):x("",!0)])}}}),[["__scopeId","data-v-2b28814c"]]),Z={class:"comments-list-popup"},G={class:"popup-header"},J={class:"header-content"},ee={class:"popup-title"},ae={class:"popup-content"},le=s(v({__name:"sdkwork-comments-list-popup",props:{modelValue:{type:Boolean,default:!1},title:{default:"评论列表"},height:{default:"70vh"},api:{},params:{default:()=>({})},itemKey:{default:"id"},itemTitleField:{default:"content"},itemDescriptionField:{default:"user.username"},selectable:{type:Boolean,default:!1},deletable:{type:Boolean,default:!1},searchable:{type:Boolean,default:!1}},emits:["update:modelValue","confirm","close","select","delete","search"],setup(a,{emit:l}){const t=a,s=l,i=g(t.modelValue),n=g(null);_(()=>t.modelValue,e=>{i.value=e}),_(i,e=>{s("update:modelValue",e),e||s("close")});const r=()=>{i.value=!1,s("close")},u=e=>{n.value=e,s("select",e)},c=e=>{s("delete",e)},d=e=>{s("search",e)};return(l,t)=>{const s=o,n=e;return m(),z(n,{show:i.value,"onUpdate:show":t[0]||(t[0]=e=>i.value=e),position:"bottom",style:T({height:a.height,zIndex:1e4}),round:"",closeable:"","close-on-click-overlay":!1},{default:b(()=>[f("div",Z,[f("div",G,[f("div",J,[f("h3",ee,h(a.title),1),y(s,{name:"cross",class:"close-icon",onClick:r})])]),f("div",ae,[y(X,{api:a.api,params:a.params,"item-key":a.itemKey,"item-title-field":a.itemTitleField,"item-description-field":a.itemDescriptionField,selectable:a.selectable,deletable:a.deletable,searchable:a.searchable,onSelect:u,onDelete:c,onSearch:d},null,8,["api","params","item-key","item-title-field","item-description-field","selectable","deletable","searchable"])])])]),_:1},8,["show","style"])}}}),[["__scopeId","data-v-61faba13"]]),te={class:"share-panel"},oe={class:"share-header"},se={class:"share-platforms"},ie={class:"platform-icon wechat"},ne={class:"platform-icon moment"},re={class:"platform-icon qq"},ue={class:"platform-icon weibo"},ce={class:"platform-icon link"},de={class:"platform-icon download"},ve={class:"share-stats"},me={class:"stat-item"},pe={class:"stat-value"},fe=s(v({__name:"SharePanel",props:{video:{}},emits:["close"],setup(e,{emit:a}){const l=e,t=a,s=()=>{i("分享到微信"),setTimeout(()=>t("close"),1e3)},n=()=>{i("分享到朋友圈"),setTimeout(()=>t("close"),1e3)},u=()=>{i("分享到QQ"),setTimeout(()=>t("close"),1e3)},c=()=>{i("分享到微博"),setTimeout(()=>t("close"),1e3)},d=async()=>{try{const e=`https://example.com/video/${l.video.id}`;await navigator.clipboard.writeText(e),i("链接已复制"),setTimeout(()=>t("close"),1e3)}catch(e){i("复制失败")}},v=()=>{r({title:"保存视频",message:"是否保存视频到相册？",showCancelButton:!0}).then(()=>{i("视频保存成功"),setTimeout(()=>t("close"),1e3)})};return(a,l)=>{const t=o;return m(),p("div",te,[f("div",oe,[l[1]||(l[1]=f("span",{class:"share-title"},"分享到",-1)),y(t,{name:"cross",size:"20",onClick:l[0]||(l[0]=e=>a.$emit("close"))})]),f("div",se,[f("div",{class:"platform-item",onClick:s},[f("div",ie,[y(t,{name:"wechat",size:"32",color:"#fff"})]),l[2]||(l[2]=f("span",{class:"platform-name"},"微信",-1))]),f("div",{class:"platform-item",onClick:n},[f("div",ne,[y(t,{name:"friends-o",size:"32",color:"#fff"})]),l[3]||(l[3]=f("span",{class:"platform-name"},"朋友圈",-1))]),f("div",{class:"platform-item",onClick:u},[f("div",re,[y(t,{name:"qq",size:"32",color:"#fff"})]),l[4]||(l[4]=f("span",{class:"platform-name"},"QQ",-1))]),f("div",{class:"platform-item",onClick:c},[f("div",ue,[y(t,{name:"weibo",size:"32",color:"#fff"})]),l[5]||(l[5]=f("span",{class:"platform-name"},"微博",-1))]),f("div",{class:"platform-item",onClick:d},[f("div",ce,[y(t,{name:"link-o",size:"32",color:"#fff"})]),l[6]||(l[6]=f("span",{class:"platform-name"},"复制链接",-1))]),f("div",{class:"platform-item",onClick:v},[f("div",de,[y(t,{name:"down",size:"32",color:"#fff"})]),l[7]||(l[7]=f("span",{class:"platform-name"},"保存视频",-1))])]),f("div",ve,[f("div",me,[l[8]||(l[8]=f("span",{class:"stat-label"},"分享数",-1)),f("span",pe,h(e.video.shareCount),1)])])])}}}),[["__scopeId","data-v-3f1646ae"]]),ye={class:"right-actions"},he={class:"action-count"},ke={class:"action-count"},ge={class:"action-count"},we={class:"action-count"},be=s(v({__name:"RightActions",props:{video:{}},emits:["like","comment","share","follow","userClick"],setup(e,{emit:a}){const l=a,t=e=>e>=1e4?(e/1e4).toFixed(1)+"w":e>=1e3?(e/1e3).toFixed(1)+"k":e.toString();return(a,s)=>{const n=d,r=o;return m(),p("div",ye,[f("div",{class:"user-avatar",onClick:s[1]||(s[1]=a=>{return t=e.video.author,void l("userClick",t);var t})},[y(n,{src:e.video.author.avatar,width:"48",height:"48",radius:"24",fit:"cover"},null,8,["src"]),f("div",{class:"follow-btn",onClick:s[0]||(s[0]=k(a=>(async e=>{try{e.followed=!e.followed,l("follow",e),i(e.followed?"已关注":"已取消关注")}catch(a){e.followed=!e.followed,i("操作失败")}})(e.video.author),["stop"]))},[y(r,{name:e.video.author.followed?"friends-o":"add-o",color:e.video.author.followed?"#ff2442":"#fff"},null,8,["name","color"])])]),f("div",{class:"action-item",onClick:s[2]||(s[2]=a=>(async e=>{try{e.liked=!e.liked,e.likeCount+=e.liked?1:-1,l("like",e),i(e.liked?"已点赞":"已取消点赞")}catch(a){e.liked=!e.liked,e.likeCount+=e.liked?-1:1,i("操作失败")}})(e.video))},[y(r,{name:e.video.liked?"like":"like-o",color:e.video.liked?"#ff2442":"#fff",size:"32"},null,8,["name","color"]),f("span",he,h(t(e.video.likeCount)),1)]),f("div",{class:"action-item",onClick:s[3]||(s[3]=a=>{return t=e.video,void l("comment",t);var t})},[y(r,{name:"chat-o",color:"#fff",size:"32"}),f("span",ke,h(t(e.video.commentCount)),1)]),f("div",{class:"action-item",onClick:s[4]||(s[4]=a=>(e.video,void i("开始制作同款视频")))},[y(r,{name:"star-o",color:"#fff",size:"32"}),f("span",ge,h(t(e.video.makeSameCount)),1)]),f("div",{class:"action-item",onClick:s[5]||(s[5]=a=>{return t=e.video,void l("share",t);var t})},[y(r,{name:"share-o",color:"#fff",size:"32"}),f("span",we,h(t(e.video.shareCount)),1)])])}}}),[["__scopeId","data-v-bbb20ee9"]]),Ce={class:"right-content"},xe={class:"user-info"},_e={class:"username"},ze={class:"video-desc"},Te={class:"music-name"},Ie=s(v({__name:"RightContent",props:{video:{}},emits:["musicClick"],setup(e,{emit:a}){const l=a;return(a,t)=>{const s=U,i=o;return m(),p("div",Ce,[f("div",xe,[f("span",_e,"@"+h(e.video.author?.username||"未知用户"),1),e.video.author?.verified?(m(),z(s,{key:0,type:"primary",size:"medium"},{default:b(()=>[...t[1]||(t[1]=[C(" 已认证 ",-1)])]),_:1})):x("",!0)]),f("div",ze,h(e.video.description),1),f("div",{class:"music-info",onClick:t[0]||(t[0]=a=>{var t;(t=e.video.music)&&l("musicClick",t)})},[y(i,{name:"music-o",color:"#fff",size:"14"}),f("span",Te,h(e.video.music?.name||"原声"),1)])])}}}),[["__scopeId","data-v-5a364515"]]),Se={class:"sdkwork-scroll-video"},Ve=["src"],Le={key:1,class:"loading-overlay"},je={key:0,class:"data-overlay"},Be={key:1,class:"bottom-controls-fixed"},Fe={class:"progress-bar"},Me={class:"play-controls"},Ue={class:"time-text"},De={key:1,class:"pull-text"},Pe={key:1,class:"pull-text"},$e={key:0,class:"loading-more"},Ee=s(v({__name:"sdkwork-scroll-video",props:{api:{},params:{default:()=>({})},pageSize:{default:10},preloadCount:{default:3},autoplay:{type:Boolean,default:!0},muted:{type:Boolean,default:!1},enableLoading:{type:Boolean,default:!1}},emits:["video-change","like","comment","share","follow","load"],setup(a,{expose:l,emit:t}){const s=g();g();const n=g(0),r=g(0),d=g(0),v=g(0),k=g(!1),C=g(!1),F=g(!1),M=g(!1),U=g({}),D=g(!1),P=g("none"),$=g(0),E=g(!1),Y=g(!1),q=g([]),Q=g(0),R=w(()=>{const e=[],a=n.value-1,l=n.value+1;return a>=0&&e.push({...q.value[a],index:a,position:"prev",originalIndex:a}),e.push({...q.value[n.value],index:n.value,position:"current",originalIndex:n.value}),l<q.value.length&&e.push({...q.value[l],index:l,position:"next",originalIndex:l}),e}),K=w(()=>q.value[n.value]||null),A=a,H=t,N=e=>{const a=[...[e-1,e,e+1],...[e-2,e+2]];for(const l of a)if(l>=0&&l<q.value.length){const e=q.value[l];e&&!e.preloaded&&O(e)}},O=e=>{if(e.preloaded||!e.videoUrl)return;e.preloaded=!0;const a=document.createElement("video");a.setAttribute("src",e.videoUrl),a.preload="metadata",a.crossOrigin="anonymous";const l=setTimeout(()=>{a.remove(),console.warn("视频预加载超时:",e.id)},1e4);a.onloadeddata=()=>{clearTimeout(l),e.duration=a.duration,a.remove(),console.log("视频预加载完成:",e.id,"时长:",e.duration)},a.onerror=()=>{clearTimeout(l),console.error("视频预加载失败:",e.id),a.remove()}};_(n,(e,a)=>{N(e)},{immediate:!0}),I(()=>{xe(),W()}),S(()=>{X(),Ee()});const W=()=>{window.addEventListener("resize",Ne),document.addEventListener("visibilitychange",Oe)},X=()=>{window.removeEventListener("resize",Ne),document.removeEventListener("visibilitychange",Oe)},Z=e=>{k.value=!0,d.value=e.touches[0].clientY,v.value=d.value,P.value="none",$.value=0;const a=s.value;a&&(a.style.transition="none")},G=e=>{if(!k.value)return;e.preventDefault();const a=e.touches[0].clientY-v.value;v.value=e.touches[0].clientY;const l=qe(),t=0===n.value&&r.value>=0,o=n.value===q.value.length-1&&r.value<=-(q.value.length-1)*l;if(t&&a>0)P.value="refresh",$.value=Math.min($.value+a,80),r.value=.3*$.value;else if(o&&a<0)P.value="loadmore",$.value=Math.min($.value-a,80),r.value=-(q.value.length-1)*l-.3*$.value;else{P.value="none",$.value=0;const e=100,t=-(q.value.length-1)*l-100,o=r.value-a;r.value=o>e?e-.3*(o-e):o<t?t-.3*(o-t):o}},J=()=>{if(!k.value)return;k.value=!1;const e=v.value-d.value,a=qe(),l=s.value;l&&(l.style.transition="transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94)");if("refresh"===P.value&&$.value>=60)return void ae();if("loadmore"===P.value&&$.value>=60)return void te();const t=.15*a,o=Math.abs(e)/300;Math.abs(e)>t||o>.5?e<0?n.value<q.value.length-1?ze(n.value+1):Qe():e>0&&n.value>0?ze(n.value-1):Qe():Qe(),P.value="none",$.value=0},ee=e=>{e.preventDefault();const a=e.deltaY;a>50&&n.value<q.value.length-1?ze(n.value+1):a<-50&&n.value>0&&ze(n.value-1)},ae=async()=>{if(!E.value&&!C.value)try{E.value=!0,P.value="refresh",i("刷新中..."),await xe(),n.value=0,r.value=0,Qe(),i("刷新成功")}catch(e){console.error("刷新失败:",e),i("刷新失败")}finally{E.value=!1,P.value="none",$.value=0}},te=async()=>{if(!Y.value&&!C.value)try{Y.value=!0,P.value="loadmore",i("加载更多..."),await _e(),q.value.length>n.value+1?ze(n.value+1):Qe(),i("加载成功")}catch(e){console.error("加载更多失败:",e),i("加载失败"),Qe()}finally{Y.value=!1,P.value="none",$.value=0}},oe=g(),se=()=>{K.value&&(K.value.loading=!0)},ie=()=>{K.value&&(K.value.loading=!1,oe.value&&(K.value.duration=oe.value.duration))},ne=()=>{K.value&&(K.value.loading=!1,A.autoplay&&!K.value.playing&&(K.value.playing=!0,Te()))},re=()=>{K.value&&(K.value.playing=!0)},ue=()=>{K.value&&(K.value.playing=!1)},ce=()=>{K.value&&oe.value&&(K.value.currentTime=oe.value.currentTime,oe.value.duration>0&&(K.value.progress=oe.value.currentTime/oe.value.duration*100))},de=()=>{K.value&&(K.value.playing=!1,n.value<q.value.length-1&&setTimeout(()=>ze(n.value+1),1e3))},ve=e=>{console.error("视频播放错误:",e),K.value&&(K.value.loading=!1),i("视频加载失败")},me=async e=>{try{e.liked=!e.liked,e.likeCount+=e.liked?1:-1,H("like",e),i(e.liked?"已点赞":"已取消点赞")}catch(a){e.liked=!e.liked,e.likeCount+=e.liked?-1:1,i("操作失败")}},pe=e=>{U.value={contentType:"VIDEO",contentId:e.id,...e.commentParams},F.value=!0,H("comment",e)},ye=e=>{F.value=!1},he=()=>{F.value=!1},ke=e=>{M.value=!0,H("share",e)},ge=async e=>{try{e.followed=!e.followed,H("follow",e),i(e.followed?"已关注":"已取消关注")}catch(a){e.followed=!e.followed,i("操作失败")}},we=e=>{console.log("跳转到用户主页:",e.username)},Ce=e=>{console.log("播放音乐:",e?.name)},xe=async()=>{try{C.value=!0;const e={pageNumber:1,pageSize:A.pageSize,...A.params},a=await A.api(e);q.value=a.records.map(e=>({...e,loading:!0,playing:!1,muted:A.muted,progress:0,currentTime:0,preloaded:!1})),Q.value=a.total,H("load",a),N(0)}catch(e){console.error("加载视频失败:",e),i("加载失败")}finally{C.value=!1}},_e=async()=>{if(!C.value)try{C.value=!0;const e={pageNumber:Math.ceil(q.value.length/A.pageSize)+1,pageSize:A.pageSize,...A.params},a=await A.api(e),l=a.records.map(e=>({...e,loading:!0,playing:!1,muted:A.muted,progress:0,currentTime:0,preloaded:!1}));q.value.push(...l),Q.value=a.total,H("load",a),N(n.value)}catch(e){console.error("加载更多视频失败:",e)}finally{C.value=!1}},ze=async e=>{if(!(e<0||e>=q.value.length||D.value)){D.value=!0;try{const a=n.value,l=e>a?"down":"up";Ee(),q.value[a]&&(q.value[a].playing=!1,q.value[a].loading=!1);const t=q.value[e];t&&(t.loading=!0,t.playing=!1),t?.preloaded||O(t),n.value=e,r.value=-e*qe(),P.value="none",$.value=0;const o=s.value;if(o){const e="down"===l?"cubic-bezier(0.25, 0.46, 0.45, 0.94)":"cubic-bezier(0.42, 0, 0.58, 1)";o.style.transition=`transform 0.4s ${e}`}await B(),A.autoplay&&setTimeout(async()=>{await Te()},200),H("video-change",t,e),N(e);(e>=q.value.length-Math.max(2,A.preloadCount)&&q.value.length<Q.value||e===q.value.length-1&&q.value.length<Q.value)&&_e()}catch(a){console.error("切换视频失败:",a)}finally{setTimeout(()=>{D.value=!1},300)}}},Te=async()=>{if(oe.value&&A.autoplay)try{oe.value.paused&&await oe.value.play()}catch(e){console.warn("播放失败，稍后重试:",e),setTimeout(async()=>{if(oe.value&&oe.value.paused)try{await oe.value.play()}catch(e){console.error("重试播放失败:",e)}},500)}},Ee=()=>{oe.value&&oe.value.pause()},Ye=async()=>{if(oe.value)try{oe.value.paused?await oe.value.play():oe.value.pause()}catch(e){console.error("切换播放状态失败:",e)}},qe=()=>s.value?.clientHeight||window.innerHeight,Qe=()=>{const e=-n.value*qe();r.value=e,P.value="none",$.value=0;const a=s.value;a&&(a.style.transition="transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94)")},Re=e=>{const a=qe();let l=0,t=1,o=1;return"prev"===e.position?(l=-a,t=.7,o=.95):"next"===e.position&&(l=a,t=.7,o=.95),{transform:`translateY(${l}px) scale(${o})`,opacity:t,zIndex:Ae(e.position),transition:"transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.3s ease"}},Ke=e=>{if(!e)return{top:"0px",opacity:0,zIndex:0};const a=qe();let l=0,t=1;return"prev"===e.position?(l=-a,t=.7):"next"===e.position&&(l=a,t=.7),{top:`${l}px`,opacity:t,zIndex:Ae(e.position),transition:"top 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.3s ease"}},Ae=e=>{if(!e)return 0;switch(e){case"current":return 30;case"prev":case"next":return 20;default:return 0}},He=e=>{const a=Math.floor(e/60),l=Math.floor(e%60);return`${a.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`},Ne=()=>{Qe()},Oe=()=>{document.hidden?Ee():A.autoplay&&Te()};return l({play:()=>Te(),pause:()=>Ee(),switchTo:e=>ze(e),getCurrentIndex:()=>n.value,getVideoList:()=>q.value,getCurrentVideo:()=>K.value,refresh:()=>xe(),getVideoPlayer:()=>oe.value,getComponentInfo:()=>({totalVideos:q.value.length,currentIndex:n.value,isSwitching:D.value})}),(a,l)=>{const t=u,i=o,r=e;return m(),p("div",Se,[f("div",{ref_key:"scrollContainer",ref:s,class:"video-scroll-container",onTouchstart:Z,onTouchmove:G,onTouchend:J,onWheel:ee},[(m(!0),p(V,null,L(R.value,e=>(m(),p("div",{key:e.id,class:j(["video-item",{active:n.value===e.originalIndex,prev:"prev"===e.position,current:"current"===e.position,next:"next"===e.position}]),style:T(Re(e))},[e.coverUrl&&n.value!==e.originalIndex?(m(),p("img",{key:0,src:e.coverUrl,class:"video-cover",alt:"视频封面"},null,8,Ve)):x("",!0),e.loading&&A.enableLoading?(m(),p("div",Le,[y(t,{type:"spinner",color:"#fff"}),l[3]||(l[3]=f("span",{class:"loading-text"},"加载中...",-1))])):x("",!0)],6))),128)),f("div",{class:j(["video-player",{current:!0}]),style:T(Ke(K.value)),onClick:Ye},[K.value&&K.value.videoUrl?(m(),z(c,{key:0,ref_key:"currentVideoPlayer",ref:oe,src:K.value.videoUrl,poster:K.value.coverUrl,autoplay:A.autoplay,muted:K.value.muted||A.muted,playsInline:!0,controls:!1,mode:"fullscreen",preload:K.value.preloaded?"auto":"metadata",enableLoading:A.enableLoading,onLoadstart:se,onLoadedmetadata:ie,onCanplay:ne,onPlay:re,onPause:ue,onTimeupdate:ce,onEnded:de,onError:ve},null,8,["src","poster","autoplay","muted","preload","enableLoading"])):x("",!0)],4),K.value?(m(),p("div",je,[y(Ie,{video:K.value,onMusicClick:Ce},null,8,["video"]),y(be,{video:K.value,onLike:me,onComment:pe,onShare:ke,onFollow:ge,onUserClick:we,style:{"pointer-events":"auto"}},null,8,["video"])])):x("",!0),K.value?(m(),p("div",Be,[f("div",Fe,[f("div",{class:"progress-fill",style:T({width:`${K.value.progress||0}%`})},null,4)]),f("div",Me,[y(i,{name:K.value.playing?"pause":"play",color:"#fff",size:"24",onClick:Ye},null,8,["name"]),f("span",Ue,h(He(K.value.currentTime||0))+" / "+h(He(K.value.duration||0)),1)])])):x("",!0),"refresh"===P.value?(m(),p("div",{key:2,class:"pull-refresh-tip",style:T({top:`${-60+$.value}px`})},[E.value?(m(),z(t,{key:0,type:"spinner",color:"#fff"})):(m(),p("span",De,"下拉刷新"))],4)):x("",!0),"loadmore"===P.value?(m(),p("div",{key:3,class:"pull-loadmore-tip",style:T({top:q.value.length*qe()-$.value+"px"})},[Y.value?(m(),z(t,{key:0,type:"spinner",color:"#fff"})):(m(),p("span",Pe,"上拉加载更多"))],4)):x("",!0)],544),C.value?(m(),p("div",$e,[y(t,{type:"spinner"}),l[4]||(l[4]=f("span",null,"加载更多...",-1))])):x("",!0),y(le,{modelValue:F.value,"onUpdate:modelValue":l[0]||(l[0]=e=>F.value=e),title:"视频评论",params:U.value,onConfirm:ye,onClose:he,style:{"z-index":"10000"}},null,8,["modelValue","params"]),y(r,{show:M.value,"onUpdate:show":l[2]||(l[2]=e=>M.value=e),position:"bottom",round:"",style:{height:"50%",zIndex:1e4}},{default:b(()=>[y(fe,{video:K.value,onClose:l[1]||(l[1]=e=>M.value=!1)},null,8,["video"])]),_:1},8,["show"])])}}}),[["__scopeId","data-v-404c9835"]]);export{Ee as _};
