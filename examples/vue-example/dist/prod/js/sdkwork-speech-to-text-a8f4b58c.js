import{_ as e}from"./sdkwork-popup-6e1ec418.js";import{a,_ as l}from"./sdkwork-cell-group-c8f6555d.js";import{aY as s,s as t,c as o,B as n,I as i,r as u,_ as c}from"./index-5affcab4.js";import{S as r}from"./index-8ec8972f.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */import{k as d,r as v,c as m,w as p,b as g,o as h,Q as y,R as k,S as f,j as _,a0 as b,a4 as w,X as x,$ as V,F as z,Y as C,U as j,Z as S}from"./vue-vendor-a2672387.js";import{F as U}from"./index-dee6a080.js";import{a as I,R as $}from"./index-b13738ef.js";const F={class:"sdkwork-speech-to-text"},R={class:"stt-container"},B={class:"result-section"},D={class:"section-header"},K={class:"result-actions"},M={class:"result-content"},E={class:"recognition-status"},H={class:"status-text"},J={key:0,class:"volume-indicator"},N={class:"volume-bars"},T={class:"volume-text"},Y={class:"control-section"},q={class:"control-buttons"},G={key:0,class:"recording-controls"},L={key:0,class:"recording-info"},O={class:"recording-time"},P={class:"recording-size"},Q={class:"settings-section"},W={class:"selected-language"},X={class:"slider-value"},Z={class:"popup-header"},A={key:0,class:"history-section"},ee={class:"section-header"},ae={class:"history-list"},le=d({__name:"sdkwork-speech-to-text",emits:["recognition-start","recognition-stop","recognition-error","recognition-complete"],setup(c,{emit:d}){const le=d,se=v(""),te=v(!1),oe=v(!1),ne=v(!1),ie=v(""),ue=v(0),ce=v(0),re=v({code:"zh-CN",name:"中文（普通话）"}),de=v("continuous"),ve=v(!0),me=v(!0),pe=v(3),ge=v(!1),he=v([]),ye=[{code:"zh-CN",name:"中文（普通话）"},{code:"zh-TW",name:"中文（台湾）"},{code:"zh-HK",name:"中文（香港）"},{code:"en-US",name:"英语（美国）"},{code:"en-GB",name:"英语（英国）"},{code:"ja-JP",name:"日语"},{code:"ko-KR",name:"韩语"},{code:"fr-FR",name:"法语"},{code:"de-DE",name:"德语"},{code:"es-ES",name:"西班牙语"}],{isSupported:ke,isListening:fe,isFinal:_e,result:be,error:we,start:xe,stop:Ve}=s({continuous:m(()=>"continuous"===de.value).value});let ze=null,Ce=null;const je=m(()=>!!ke||(t("您的浏览器不支持语音识别功能"),!1)),Se=async()=>{je.value&&(te.value?await Ie():await Ue())},Ue=async()=>{try{ne.value=!0,ie.value="",ue.value=0,await xe(),te.value=!0,oe.value=!1,Ke(),Ee(),le("recognition-start"),t("开始语音识别")}catch(e){console.error("语音识别启动失败:",e),ie.value="语音识别启动失败",le("recognition-error",e),t("语音识别启动失败")}finally{ne.value=!1}},Ie=async()=>{try{await Ve(),te.value=!1,oe.value=!1,Me(),He(),se.value.trim()&&Je(),le("recognition-stop",se.value),le("recognition-complete",se.value),t("语音识别已停止")}catch(e){console.error("停止语音识别失败:",e),ie.value="停止语音识别失败",le("recognition-error",e)}},$e=()=>{oe.value=!0,Me(),He(),t("语音识别已暂停")},Fe=()=>{oe.value=!1,Ke(),Ee(),t("语音识别已继续")},Re=()=>{se.value="",t("已清空识别结果")},Be=async()=>{try{await navigator.clipboard.writeText(se.value),t("已复制到剪贴板")}catch(e){console.error("复制失败:",e),t("复制失败")}},De=async()=>{try{await o({title:"确认清空",message:"确定要清空所有识别历史记录吗？"}),he.value=[],t("历史记录已清空")}catch{}},Ke=()=>{ze=window.setInterval(()=>{ue.value++},1e3)},Me=()=>{ze&&(clearInterval(ze),ze=null)},Ee=()=>{Ce=window.setInterval(()=>{ce.value=Math.floor(5*Math.random())+1},200)},He=()=>{Ce&&(clearInterval(Ce),Ce=null),ce.value=0},Je=()=>{he.value.unshift({text:se.value,timestamp:Date.now()}),he.value.length>50&&(he.value=he.value.slice(0,50))},Ne=e=>{const a=e%60;return`${Math.floor(e/60).toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`};return p(be,e=>{e&&(se.value=e,_e&&"single"===de.value&&Ie())}),p(we,e=>{e&&(ie.value=e.message,t(`识别错误: ${e.message}`))}),g(()=>{je.value||t("您的浏览器不支持语音识别功能")}),h(()=>{Me(),He(),te.value&&Ve()}),(s,o)=>{const c=n,d=U,v=i,m=a,p=I,g=$,h=r,le=u,ke=l,fe=e;return y(),k("div",F,[f("div",R,[f("div",B,[f("div",D,[o[11]||(o[11]=f("h3",{class:"section-title"},"识别结果",-1)),f("div",K,[_(c,{type:"default",size:"small",onClick:Re,disabled:!se.value,class:"clear-btn"},{default:b(()=>[...o[9]||(o[9]=[w(" 清空 ",-1)])]),_:1},8,["disabled"]),_(c,{type:"primary",size:"small",onClick:Be,disabled:!se.value,class:"copy-btn"},{default:b(()=>[...o[10]||(o[10]=[w(" 复制 ",-1)])]),_:1},8,["disabled"])])]),f("div",M,[_(d,{modelValue:se.value,"onUpdate:modelValue":o[0]||(o[0]=e=>se.value=e),type:"textarea",rows:"6",placeholder:"识别结果将显示在这里...",readonly:"",class:"result-textarea"},null,8,["modelValue"]),f("div",E,[f("div",{class:x(["status-indicator",{active:te.value,error:ie.value}])},[_(v,{name:ie.value?"warning":te.value?"volume":"volume-o",class:"status-icon"},null,8,["name"]),f("span",H,V(ie.value?"识别错误":te.value?"正在识别中...":"等待语音输入"),1)],2),te.value?(y(),k("div",J,[f("div",N,[(y(),k(z,null,C(5,e=>f("div",{key:e,class:x(["volume-bar",{active:e<=ce.value}])},null,2)),64))]),f("span",T,"音量: "+V(20*ce.value)+"%",1)])):j("",!0)])])]),f("div",Y,[o[14]||(o[14]=f("div",{class:"section-header"},[f("h3",{class:"section-title"},"语音控制")],-1)),f("div",q,[_(c,{type:te.value?"danger":"primary",size:"large",loading:ne.value,onClick:Se,class:"recognition-btn"},{default:b(()=>[_(v,{name:te.value?"pause":"play"},null,8,["name"]),w(" "+V(te.value?"停止识别":"开始识别"),1)]),_:1},8,["type","loading"]),te.value?(y(),k("div",G,[_(c,{type:"warning",size:"small",onClick:$e,disabled:!te.value||oe.value,class:"pause-btn"},{default:b(()=>[_(v,{name:"pause"}),o[12]||(o[12]=w(" 暂停 ",-1))]),_:1},8,["disabled"]),_(c,{type:"success",size:"small",onClick:Fe,disabled:!oe.value,class:"resume-btn"},{default:b(()=>[_(v,{name:"play"}),o[13]||(o[13]=w(" 继续 ",-1))]),_:1},8,["disabled"])])):j("",!0)]),te.value?(y(),k("div",L,[f("div",O,[_(v,{name:"clock"}),w(" 录音时长: "+V(Ne(ue.value)),1)]),f("div",P,[_(v,{name:"graph"}),w(" 识别字数: "+V(se.value.length),1)])])):j("",!0)]),f("div",Q,[o[17]||(o[17]=f("div",{class:"section-header"},[f("h3",{class:"section-title"},"识别设置")],-1)),_(ke,null,{default:b(()=>[_(m,{title:"识别语言",center:"","is-link":"",onClick:o[1]||(o[1]=e=>ge.value=!0)},{value:b(()=>[f("div",W,[_(v,{name:"globe"}),w(" "+V(re.value.name),1)])]),_:1}),_(m,{title:"识别模式",center:""},{value:b(()=>[_(g,{modelValue:de.value,"onUpdate:modelValue":o[2]||(o[2]=e=>de.value=e),direction:"horizontal"},{default:b(()=>[_(p,{name:"continuous"},{default:b(()=>[...o[15]||(o[15]=[w("连续识别",-1)])]),_:1}),_(p,{name:"single"},{default:b(()=>[...o[16]||(o[16]=[w("单次识别",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),_(m,{title:"自动标点",center:""},{value:b(()=>[_(h,{modelValue:ve.value,"onUpdate:modelValue":o[3]||(o[3]=e=>ve.value=e),size:"20"},null,8,["modelValue"])]),_:1}),_(m,{title:"静音检测",center:""},{value:b(()=>[_(h,{modelValue:me.value,"onUpdate:modelValue":o[4]||(o[4]=e=>me.value=e),size:"20"},null,8,["modelValue"])]),_:1}),me.value?(y(),S(m,{key:0,title:"静音阈值",center:""},{value:b(()=>[_(le,{modelValue:pe.value,"onUpdate:modelValue":o[5]||(o[5]=e=>pe.value=e),min:1,max:10,step:1,class:"threshold-slider"},{button:b(()=>[f("div",X,V(pe.value)+"秒",1)]),_:1},8,["modelValue"])]),_:1})):j("",!0)]),_:1})])]),_(fe,{show:ge.value,"onUpdate:show":o[8]||(o[8]=e=>ge.value=e),position:"bottom",round:"",class:"language-popup"},{default:b(()=>[f("div",Z,[o[19]||(o[19]=f("h3",{class:"popup-title"},"选择识别语言",-1)),_(c,{type:"primary",size:"small",onClick:o[6]||(o[6]=e=>ge.value=!1)},{default:b(()=>[...o[18]||(o[18]=[w(" 确定 ",-1)])]),_:1})]),_(g,{modelValue:re.value.code,"onUpdate:modelValue":o[7]||(o[7]=e=>re.value.code=e)},{default:b(()=>[_(ke,null,{default:b(()=>[(y(),k(z,null,C(ye,e=>_(m,{key:e.code,title:e.name,clickable:"",onClick:a=>(e=>{re.value=e,ge.value=!1,t(`已切换到${e.name}`)})(e)},{"right-icon":b(()=>[_(p,{name:e.code},null,8,["name"])]),_:2},1032,["title","onClick"])),64))]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["show"]),he.value.length>0?(y(),k("div",A,[f("div",ee,[o[21]||(o[21]=f("h3",{class:"section-title"},"识别历史",-1)),_(c,{type:"default",size:"small",onClick:De,class:"clear-history-btn"},{default:b(()=>[...o[20]||(o[20]=[w(" 清空历史 ",-1)])]),_:1})]),f("div",ae,[(y(!0),k(z,null,C(he.value.slice(0,5),(e,a)=>(y(),S(m,{key:a,title:Ne(e.timestamp),value:e.text.substring(0,50)+(e.text.length>50?"...":""),clickable:"",onClick:a=>(e=>{se.value=e.text,t("已加载历史记录")})(e)},{"right-icon":b(()=>[_(v,{name:"arrow"})]),_:1},8,["title","value","onClick"]))),128))])])):j("",!0)])}}}),se=c(le,[["__scopeId","data-v-66cac5bf"]]);export{se as _};
