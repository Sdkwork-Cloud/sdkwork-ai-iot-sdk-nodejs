import{k as a,r as e,c as t,b as l,n as s,w as u,d as o,e as v,t as n,v as i,j as r,q as c,s as f}from"./vue-vendor-a2672387.js";import{k as p,F as g,an as h,ao as x,l as d,Y as y,Z as m,ax as b,o as T,al as j,T as k,w}from"./index-5affcab4.js";function C(a,e){return a.reduce((a,t)=>Math.abs(a-e)<Math.abs(t-e)?a:t)}const O={gap:{type:[Number,Object],default:24},icon:String,axis:T("y"),magnetic:String,offset:Object,teleport:{type:[String,Object],default:"body"}},[S,F]=p("floating-bubble");const M=w(a({name:S,inheritAttrs:!1,props:O,emits:["click","update:offset","offsetChange"],setup(a,{slots:p,emit:T,attrs:w}){const O=e(),S=e({x:0,y:0,width:0,height:0}),M=t(()=>g(a.gap)?a.gap.x:a.gap),P=t(()=>g(a.gap)?a.gap.y:a.gap),Y=t(()=>({top:P.value,right:h.value-S.value.width-M.value,bottom:x.value-S.value.height-P.value,left:M.value})),$=e(!1);let q=!1;const A=t(()=>{const a={},e=d(S.value.x),t=d(S.value.y);return a.transform=`translate3d(${e}, ${t}, 0)`,!$.value&&q||(a.transition="none"),a}),D=()=>{if(!G.value)return;const{width:e,height:t}=j(O.value),{offset:l}=a;S.value={x:l?l.x:h.value-e-M.value,y:l?l.y:x.value-t-P.value,width:e,height:t}},N=y();let X=0,Z=0;const z=a=>{N.start(a),$.value=!0,X=S.value.x,Z=S.value.y};m("touchmove",e=>{if(e.preventDefault(),N.move(e),"lock"!==a.axis&&!N.isTap.value){if("x"===a.axis||"xy"===a.axis){let a=X+N.deltaX.value;a<Y.value.left&&(a=Y.value.left),a>Y.value.right&&(a=Y.value.right),S.value.x=a}if("y"===a.axis||"xy"===a.axis){let a=Z+N.deltaY.value;a<Y.value.top&&(a=Y.value.top),a>Y.value.bottom&&(a=Y.value.bottom),S.value.y=a}const e=k(S.value,["x","y"]);T("update:offset",e)}},{target:O});const B=()=>{$.value=!1,s(()=>{if("x"===a.magnetic){const a=C([Y.value.left,Y.value.right],S.value.x);S.value.x=a}if("y"===a.magnetic){const a=C([Y.value.top,Y.value.bottom],S.value.y);S.value.y=a}if(!N.isTap.value){const a=k(S.value,["x","y"]);T("update:offset",a),X===a.x&&Z===a.y||T("offsetChange",a)}})},E=a=>{N.isTap.value?T("click",a):a.stopPropagation()};l(()=>{D(),s(()=>{q=!0})}),u([h,x,M,P,()=>a.offset],D,{deep:!0});const G=e(!0);return o(()=>{G.value=!0}),v(()=>{a.teleport&&(G.value=!1)}),()=>{const e=n(r("div",c({class:F(),ref:O,onTouchstartPassive:z,onTouchend:B,onTouchcancel:B,onClickCapture:E,style:A.value},w),[p.default?p.default():r(b,{name:a.icon,class:F("icon")},null)]),[[i,G.value]]);return a.teleport?r(f,{to:a.teleport},{default:()=>[e]}):e}}}));export{M as F};
