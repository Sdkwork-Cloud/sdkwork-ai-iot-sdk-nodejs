import{_ as e,a}from"./sdkwork-cell-group-Bddn3ZCY.js";import{l,I as t,B as o,aS as s,s as u,_ as r}from"./index-3Iq02xX1.js";/* empty css              */import{a as i,_ as d}from"./sdkwork-collapse-item-ImBIS9vw.js";import{_ as m}from"./sdkwork-popup-BrQY8WVz.js";/* empty css              */import"./index-B-_I9SJl.js";import{P as n}from"./index-DJp6oqBf.js";/* empty css              *//* empty css              */import{S as v}from"./sdkwork-voice-speaker-category-list-popup-DuCizZlL.js";import{k as c,a as p,r as h,f,w as y,P as k,Q as x,R as g,S as w,j,a0 as _,$ as V,Z as b,W as C,a4 as U}from"./vue-vendor-BOogp7Xw.js";import{F as M}from"./index-ooPhRfX6.js";import"./sdkwork-icon-Dhm3xmJ9.js";import"./utils-vendor-WEzSe-CR.js";import"./index-CzYZ6aVb.js";import"./sdkwork-pull-refresh-BDaMSw2R.js";import"./index-Bmpmgbhp.js";import"./shared-B_4JvhtZ.js";import"./sdkwork-search-bar-1YXth7fK.js";import"./index-DVvwYFvp.js";import"./use-id-Dx2a3-Lt.js";import"./ListItem-BDzKOUqD.js";import"./LoadingSection-DuR86uPz.js";import"./LoadMoreSection-D76MvkMN.js";import"./sdkwork-voice-clone-Bd8zXAvH.js";import"./index-CCq6pR_8.js";const S={class:"text-input-section"},P={class:"text-field-wrapper"},z={class:"char-count-bottom"},A={class:"voice-selector"},B={key:0,class:"selected-voice"},T={key:1,class:"placeholder"},E={class:"slider-wrapper"},F={class:"slider-value"},I={class:"slider-wrapper"},$={class:"slider-value"},L={class:"slider-wrapper"},H={class:"slider-value"},N={class:"format-value"},W={class:"bottom-action-bar"},q=r(c({__name:"sdkwork-voice-synthesis",props:{themeMode:{default:"auto"},defaultText:{default:""},defaultSpeaker:{},showAdvancedParams:{type:Boolean,default:!0}},emits:["start","complete","error","speaker-change"],setup(r,{emit:c}){const{currentTheme:q}=l(),D=r,G=c,K=p(D.defaultText),Q=p(D.defaultSpeaker||null),R=p(!1),Z=p(!1),J=p(D.showAdvancedParams?["params"]:[]),O=p(!1),X=p(!1),Y=p(null),ee=h({speed:1,volume:80,pitch:0,format:"mp3"}),ae=[{text:"MP3",value:"mp3"},{text:"WAV",value:"wav"},{text:"PCM",value:"pcm"}],le=p([ee.format]),te=p(""),oe=f(()=>`theme-${q.value}`),se=f(()=>"auto"===D.themeMode?q.value:D.themeMode),ue=f(()=>"100%"),re=f(()=>K.value.trim().length>0&&null!==Q.value);y(()=>D.defaultText,e=>{e&&!K.value&&(K.value=e)}),y(()=>D.defaultSpeaker,e=>{e&&!Q.value&&(Q.value=e)});const ie=()=>{K.value.trim()?K.value.length>1e3?te.value="文本长度不能超过1000个字符":te.value="":te.value="请输入合成文本"},de=e=>{const a=ae.find(a=>a.value===e);return a?a.text:"MP3"},me=e=>{Q.value=e,R.value=!1,G("speaker-change",e),u(`已选择发音人: ${e.displayName||e.name}`)},ne=e=>{Array.isArray(e)?le.value=e:e&&"object"==typeof e&&e.selectedValues&&(le.value=e.selectedValues)},ve=e=>{let a=e;Array.isArray(e)?a=e[0]:e&&"object"==typeof e&&e.selectedValues&&(a=e.selectedValues[0]),ee.format=a,Z.value=!1},ce=async()=>{if(Q.value&&K.value.trim()){O.value=!0;try{const e=K.value.length>50?K.value.substring(0,50)+"...":K.value,a=await ye(e,Q.value,ee);Y.value&&a&&(Y.value.src=a,await Y.value.play())}catch(e){console.error("试听失败:",e),u("试听失败，请重试")}finally{O.value=!1}}else u("请先选择发音人和输入文本")},pe=async()=>{if(re.value){X.value=!0;try{const e={text:K.value,speaker:Q.value,params:{...ee}};G("start",e);const a=await ke(e);G("complete",a),u("合成完成"),Y.value&&a.audioUrl&&(Y.value.src=a.audioUrl,await Y.value.play())}catch(e){console.error("合成失败:",e),G("error",e),u("合成失败，请重试")}finally{X.value=!1}}else u("请完善合成信息")},he=()=>{console.log("音频播放结束")},fe=e=>{console.error("音频播放错误:",e),u("音频播放失败")},ye=async(e,a,l)=>(await new Promise(e=>setTimeout(e,1e3)),"https://example.com/preview-audio.mp3"),ke=async e=>(await new Promise(e=>setTimeout(e,2e3)),{audioUrl:"https://example.com/synthesis-result.mp3",duration:10,fileSize:102400});return(l,u)=>{const r=M,c=e,p=t,h=a,f=o,y=s,q=n,D=m,G=d,ye=i;return x(),k("div",{class:g(["voice-synthesis",oe.value])},[w("div",S,[j(c,{"theme-mode":se.value},{default:_(()=>[w("div",P,[j(r,{modelValue:K.value,"onUpdate:modelValue":u[0]||(u[0]=e=>K.value=e),label:"合成文本","label-align":"top",type:"textarea",placeholder:"请输入要合成的文本内容",autosize:{minHeight:100,maxHeight:200},maxlength:1e3,"error-message":te.value,onBlur:ie},null,8,["modelValue","error-message"]),w("div",z,[w("span",{class:g(["char-count",{error:K.value.length>1e3}])},V(K.value.length)+"/1000 ",3)])])]),_:1},8,["theme-mode"])]),j(c,{class:"voice-section","theme-mode":se.value},{default:_(()=>[j(h,{title:"发音人",center:"","is-link":"",onClick:u[1]||(u[1]=e=>R.value=!0),"theme-mode":se.value},{value:_(()=>[w("div",A,[j(p,{name:"music",class:"voice-icon"}),Q.value?(x(),k("span",B,V(Q.value.displayName||Q.value.name),1)):(x(),k("span",T,"请选择发音人"))])]),_:1},8,["theme-mode"]),Q.value?(x(),b(h,{key:0,title:"试听",center:"","theme-mode":se.value},{value:_(()=>[j(f,{type:"primary",size:"small",onClick:ce,loading:O.value,disabled:!K.value.trim()},{default:_(()=>[...u[11]||(u[11]=[U(" 试听 ",-1)])]),_:1},8,["loading","disabled"])]),_:1},8,["theme-mode"])):C("",!0)]),_:1},8,["theme-mode"]),j(ye,{modelValue:J.value,"onUpdate:modelValue":u[8]||(u[8]=e=>J.value=e),class:"params-section","theme-mode":se.value},{default:_(()=>[j(G,{title:"高级参数设置",name:"params","theme-mode":se.value},{default:_(()=>[j(h,{title:"语速",center:"","theme-mode":se.value},{value:_(()=>[w("div",E,[j(y,{modelValue:ee.speed,"onUpdate:modelValue":u[2]||(u[2]=e=>ee.speed=e),min:.5,max:2,step:.1,"bar-height":"4px","active-color":"#1989fa"},null,8,["modelValue"]),w("span",F,V(ee.speed.toFixed(1))+"x",1)])]),_:1},8,["theme-mode"]),j(h,{title:"音量",center:"","theme-mode":se.value},{value:_(()=>[w("div",I,[j(y,{modelValue:ee.volume,"onUpdate:modelValue":u[3]||(u[3]=e=>ee.volume=e),min:0,max:100,step:1,"bar-height":"4px","active-color":"#1989fa"},null,8,["modelValue"]),w("span",$,V(ee.volume)+"%",1)])]),_:1},8,["theme-mode"]),j(h,{title:"音调",center:"","theme-mode":se.value},{value:_(()=>[w("div",L,[j(y,{modelValue:ee.pitch,"onUpdate:modelValue":u[4]||(u[4]=e=>ee.pitch=e),min:-10,max:10,step:1,"bar-height":"4px","active-color":"#1989fa"},null,8,["modelValue"]),w("span",H,V(ee.pitch>0?"+":"")+V(ee.pitch),1)])]),_:1},8,["theme-mode"]),j(h,{title:"音频格式",center:"","is-link":"",onClick:u[5]||(u[5]=e=>Z.value=!0),"theme-mode":se.value},{value:_(()=>[w("span",N,V(de(ee.format)),1)]),_:1},8,["theme-mode"]),j(D,{show:Z.value,"onUpdate:show":u[7]||(u[7]=e=>Z.value=e),position:"bottom",round:"","theme-mode":se.value,closeable:!1},{default:_(()=>[j(q,{columns:ae,"model-value":le.value,"onUpdate:modelValue":ne,onConfirm:ve,onCancel:u[6]||(u[6]=e=>Z.value=!1),title:"选择音频格式"},null,8,["model-value"])]),_:1},8,["show","theme-mode"])]),_:1},8,["theme-mode"])]),_:1},8,["modelValue","theme-mode"]),w("div",W,[j(f,{type:"primary",size:"large",block:"",loading:X.value,disabled:!re.value,onClick:pe,class:"synthesis-button"},{default:_(()=>[...u[12]||(u[12]=[U(" 开始合成 ",-1)])]),_:1},8,["loading","disabled"])]),j(v,{modelValue:R.value,"onUpdate:modelValue":u[9]||(u[9]=e=>R.value=e),title:"选择发音人",height:ue.value,"selected-speaker-id":Q.value?.id,"theme-mode":se.value,onConfirm:me,onClose:u[10]||(u[10]=e=>R.value=!1)},null,8,["modelValue","height","selected-speaker-id","theme-mode"]),w("audio",{ref_key:"audioPlayer",ref:Y,style:{display:"none"},onEnded:he,onError:fe},null,544)],2)}}}),[["__scopeId","data-v-f40e67b7"]]),D={class:"voice-synthesis-page"},G={key:0,class:"result-section"},K={class:"result-info"},Q={class:"duration"},R={class:"file-size"},Z={class:"result-actions"},J=r(c({__name:"synthesis",setup(l){const t=p("auto"),s=p("欢迎使用语音合成功能，请输入您想要转换的文本内容。"),r=p(null),i=p(null),d=p(!1),m=p(null),n=e=>{console.log("合成开始:",e),i.value=null},v=e=>{console.log("合成完成:",e),i.value=e,u("语音合成完成")},c=e=>{console.error("合成错误:",e),u("合成失败，请重试")},h=e=>{console.log("发音人变更:",e),r.value=e},f=e=>{if(0===e)return"0 B";const a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+["B","KB","MB","GB"][a]},y=async()=>{if(i.value){d.value=!0;try{m.value||(m.value=new Audio),m.value.src=i.value.audioUrl,await m.value.play(),m.value.onended=()=>{d.value=!1},m.value.onerror=()=>{d.value=!1,u("播放失败")}}catch(e){console.error("播放失败:",e),d.value=!1,u("播放失败")}}},g=()=>{if(i.value)try{const e=document.createElement("a");e.href=i.value.audioUrl,e.download=`synthesis-result.${i.value.audioUrl.split(".").pop()||"mp3"}`,e.click(),u("开始下载")}catch(e){console.error("下载失败:",e),u("下载失败")}};return(l,u)=>{const m=a,p=o,b=e;return x(),k("div",D,[j(q,{"theme-mode":t.value,"default-text":s.value,"default-speaker":r.value,"show-advanced-params":!0,onStart:n,onComplete:v,onError:c,onSpeakerChange:h},null,8,["theme-mode","default-text","default-speaker"]),i.value?(x(),k("div",G,[j(b,{"theme-mode":t.value},{default:_(()=>[j(m,{title:"合成结果","theme-mode":t.value},{value:_(()=>[w("div",K,[w("span",Q,"时长: "+V(i.value.duration)+"秒",1),w("span",R,"大小: "+V(f(i.value.fileSize)),1)])]),_:1},8,["theme-mode"]),j(m,{title:"操作","theme-mode":t.value},{value:_(()=>[w("div",Z,[j(p,{type:"primary",size:"small",onClick:y,loading:d.value},{default:_(()=>[...u[0]||(u[0]=[U(" 播放 ",-1)])]),_:1},8,["loading"]),j(p,{type:"default",size:"small",onClick:g},{default:_(()=>[...u[1]||(u[1]=[U(" 下载 ",-1)])]),_:1})])]),_:1},8,["theme-mode"])]),_:1},8,["theme-mode"])])):C("",!0)])}}}),[["__scopeId","data-v-e6ff516a"]]);export{J as default};
