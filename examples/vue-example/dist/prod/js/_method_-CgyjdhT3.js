import{S as a}from"./sdkwork-page-container-DiWROpn4.js";import{k as s,r as t,f as o,b as e,P as l,Q as i,S as r,W as n,F as c,Y as u,V as h,R as d,$ as p,w as m,Z as v,a0 as g,_ as f,O as k,a3 as w}from"./vue-vendor-BAnrfl1G.js";import{S as y}from"./sdkwork-auth-login-BfXkTFwn.js";import{h as _,_ as j}from"./index-TwMLNQLv.js";import"./index-7Dn5DELO.js";import"./index-_EkcNg-W.js";import"./use-id-u-J04b09.js";import"./index-CdJ-vIGQ.js";import"./Checker-CFPSLEh7.js";import"./index-CKYQBzIq.js";import"./utils-vendor-WEzSe-CR.js";const b={class:"sdkwork-auth-oauth-login"},A={class:"oauth-platforms"},x=["onClick"],C={class:"platform-icon"},O={class:"platform-name"},R={key:0,class:"platform-loading"},S={class:"oauth-options"},I={key:0,class:"oauth-error"},L={key:1,class:"oauth-config-hint"},E=j(s({__name:"sdkwork-auth-oauth-login",props:{showAccountLogin:{type:Boolean,default:!0},showRegister:{type:Boolean,default:!0},redirectUri:{},compact:{type:Boolean,default:!1}},emits:["oauth-started","oauth-success","oauth-error","switch-to-account","switch-to-register"],setup(a,{expose:s,emit:m}){const v=a,g=m,f=_(),k=t(null),w=t(""),y=o(()=>f.getOAuthPlatforms());return s({handleOAuthCallback:async(a,s)=>{try{k.value=s,w.value="",await f.handleOAuthCallback(a,s),g("oauth-success",s)}catch(t){const a=t instanceof Error?t.message:"OAuth2回调处理失败";w.value=a,g("oauth-error",a)}finally{k.value=null}},clearError:()=>{w.value=""}}),e(()=>{}),(s,t)=>(i(),l("div",b,[t[7]||(t[7]=r("div",{class:"oauth-header"},[r("h2",{class:"oauth-title"},"第三方登录"),r("p",{class:"oauth-subtitle"},"选择您喜欢的登录方式")],-1)),r("div",A,[(i(!0),l(c,null,u(y.value,a=>(i(),l("div",{key:a.provider,class:"oauth-platform-item",style:h({"--platform-color":a.color}),onClick:s=>(async a=>{try{k.value=a,w.value="",g("oauth-started",a),f.authorizeOAuth({provider:a,redirectUri:v.redirectUri}),g("oauth-success",a)}catch(s){const a=s instanceof Error?s.message:"OAuth2登录失败";w.value=a,g("oauth-error",a)}finally{k.value=null}})(a.provider)},[r("div",C,[r("i",{class:d(a.icon)},null,2)]),r("span",O,p(a.displayName),1),k.value===a.provider?(i(),l("div",R,[...t[2]||(t[2]=[r("i",{class:"i-mdi-loading animate-spin"},null,-1)])])):n("",!0)],12,x))),128))]),t[8]||(t[8]=r("div",{class:"oauth-divider"},[r("span",{class:"divider-text"},"或")],-1)),r("div",S,[a.showAccountLogin?(i(),l("button",{key:0,class:"oauth-option-btn",onClick:t[0]||(t[0]=a=>s.$emit("switch-to-account"))},[...t[3]||(t[3]=[r("i",{class:"i-mdi-account"},null,-1),r("span",null,"账号密码登录",-1)])])):n("",!0),a.showRegister?(i(),l("button",{key:1,class:"oauth-option-btn",onClick:t[1]||(t[1]=a=>s.$emit("switch-to-register"))},[...t[4]||(t[4]=[r("i",{class:"i-mdi-account-plus"},null,-1),r("span",null,"注册新账号",-1)])])):n("",!0)]),w.value?(i(),l("div",I,[t[5]||(t[5]=r("i",{class:"i-mdi-alert-circle"},null,-1)),r("span",null,p(w.value),1)])):n("",!0),y.value.length?n("",!0):(i(),l("div",L,[...t[6]||(t[6]=[r("div",{class:"config-hint-content"},[r("i",{class:"i-mdi-cog"}),r("div",{class:"hint-text"},[r("p",null,"未配置OAuth2平台"),r("p",{class:"hint-detail"},"请在环境变量中配置相应的CLIENT_ID")])],-1)])]))]))}}),[["__scopeId","data-v-286cf236"]]),B=j(s({__name:"[method]",setup(s){const t={account:y,oauth:E},e=k(),l=w(),r=o(()=>{const a=l.params.method;return a&&a in t?a:"account"}),n=o(()=>t[r.value]),c=a=>{e.push("/")},u=a=>{},h=()=>{e.push("/auth/register")},d=()=>{e.push("/auth/forgot-password")},p=()=>{e.push("/login/account")};return m(()=>l.params.method,a=>{}),(s,t)=>{const o=a;return i(),v(o,{"safe-area":"",scrollable:"","theme-mode":"auto"},{default:g(()=>[(i(),v(f(n.value),{onLoginSuccess:c,onLoginFailed:u,onRegisterClick:h,onForgotPassword:d,onSwitchToAccount:p,onSwitchToRegister:h},null,32))]),_:1})}}}),[["__scopeId","data-v-6b0a3a08"]]);export{B as default};
