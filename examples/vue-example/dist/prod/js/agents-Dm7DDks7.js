import{L as t,I as e,_ as s}from"./index-Czm3MDyH.js";import{F as a}from"./index-CEcfnOar.js";import{E as n}from"./index-DAOemCPB.js";import{y as i,k as r,O as o,r as c,b as d,o as g,Z as l,Q as u,a0 as h,j as p,a4 as m,S as f}from"./vue-vendor-CnVaDBlt.js";import{A as y}from"./agent-DfBsM5fR.js";import{u as w}from"./conversation-BneT2HIa.js";import{_ as A}from"./sdkwork-agent-list-B0Io7aH-.js";import{S as I}from"./sdkwork-page-container-CW_61NzG.js";import{b as L}from"./route-block-B_A1xBdJ.js";import"./utils-vendor-WEzSe-CR.js";import"./use-id-CkVbEcjv.js";import"./sdkwork-api-list-klcaLhLZ.js";import"./shared-Br1A_wtp.js";import"./sdkwork-search-bar-BXJYiKxA.js";import"./sdkwork-icon-CDfxWqAn.js";import"./ListItem-CMWkj5QP.js";/* empty css              *//* empty css              *//* empty css              */import"./index-fSkMW4vy.js";import"./index-fP7qYJKm.js";import"./Checker-CkDYVKlz.js";const j=i("agent",{state:()=>({agents:[],selectedAgentId:null,ui:{searchQuery:"",isLoading:!1}}),getters:{selectedAgent:t=>t.selectedAgentId?t.agents.find(e=>e.id===t.selectedAgentId):null,filteredAgents:t=>{const e=t.ui.searchQuery.toLowerCase().trim();return e?t.agents.filter(t=>t.name?.toLowerCase().includes(e)||t.description?.toLowerCase().includes(e)||t.tags?.tags?.some(t=>t.toLowerCase().includes(e))):t.agents},agentsByStatus:t=>{const e={active:[],inactive:[],draft:[]};return t.agents.forEach(t=>{switch(t.status){case"ACTIVE":e.active.push(t);break;case"INACTIVE":default:e.inactive.push(t);break;case"DRAFT":e.draft.push(t)}}),e}},actions:{setSearchQuery(t){this.ui.searchQuery=t},setLoading(t){this.ui.isLoading=t},selectAgent(t){this.selectedAgentId=t},async createAgent(t){try{this.setLoading(!0);const e=new y,s=await e.create(t);return this.agents.push(s),this.selectAgent(s.id?.toString()||null),s}catch(e){throw e}finally{this.setLoading(!1)}},async updateAgent(t){try{this.setLoading(!0);const e=new y,s=await e.update(t),a=this.agents.findIndex(t=>t.id===s.id);return-1!==a&&(this.agents[a]=s),s}catch(e){throw e}finally{this.setLoading(!1)}},async retrieveAgent(t){try{this.setLoading(!0);const e=new y,s=await e.retrieve(t),a=this.agents.findIndex(t=>t.id===s.id);return-1!==a?this.agents[a]=s:this.agents.push(s),s}catch(e){throw e}finally{this.setLoading(!1)}},async deleteAgent(t){try{this.setLoading(!0);const e=new y,s=await e.delete(t);return s&&(this.agents=this.agents.filter(e=>e.id!==t),this.selectedAgentId===t.toString()&&this.selectAgent(null)),s}catch(e){throw e}finally{this.setLoading(!1)}},async list(t,e){try{this.setLoading(!0);const s=new y;null==(e=e||{page:0,size:10}).page&&(e.page=0),null==e.size&&(e.size=10);const a=await s.listPublic(t,e);if(0===e?.page)this.agents=a.content||[];else{const t=new Set(this.agents.map(t=>t.id)),e=(a.content||[]).filter(e=>!t.has(e.id));this.agents.push(...e)}return a}catch(s){throw s}finally{this.setLoading(!1)}},async toggleAgentStatus(t){try{const e=this.agents.find(e=>e.id===t);if(!e)throw new Error("智能体不存在");const s="ACTIVE"===e.status?"INACTIVE":"ACTIVE",a={...e,status:s};return await this.updateAgent(a)}catch(e){throw e}},getAgentsByCategory(t){return this.agents.filter(e=>e.categoryId===t)},getAgentsByType(t){return this.agents.filter(e=>e.type===t)},clearAgents(){this.agents=[],this.selectAgent(null)},reset(){this.agents=[],this.selectedAgentId=null,this.ui.searchQuery="",this.ui.isLoading=!1}}}),v=r({__name:"agents",setup(s){const i=o(),r=j(),y=w(),L=c(),v=c({x:0,y:0}),k=()=>{const t=window.innerWidth,e=window.innerHeight;v.value={x:t-60-2,y:e-60-80}},x=async t=>{try{return await r.list({},t)}catch(e){return{content:[],empty:!0,first:!0,last:!0,pageNumber:0,numberOfElements:0,pageSize:t.pageSize||10,sort:{empty:!0,sorted:!1,unsorted:!0,orders:[]},totalElements:0,totalPages:0}}},C=async t=>{try{const e=await y.open(t.id),s=e.uuid||e.id;i.push(`/chat/${s}?agentId=${t.id}&agentName=${encodeURIComponent(t.name||"")}`)}catch(e){const s=S();i.push(`/chat/${s}?agentId=${t.id}&agentName=${encodeURIComponent(t.name||"")}`)}},b=t=>{},E=t=>{},_=()=>{i.push("/agent/create")},S=()=>window.$uuid();return d(()=>{k(),window.addEventListener("resize",k)}),g(()=>{window.removeEventListener("resize",k)}),(s,i)=>{const r=n,o=t,c=e,d=a;return u(),l(I,{"safe-area":"",scrollable:!1,"theme-mode":"auto"},{default:h(()=>[p(A,{api:x,params:{category:"all"},"page-size":10,searchable:!1,onClick:C,onSearch:b,onLoad:E,ref_key:"agentListRef",ref:L},{empty:h(()=>[p(r,{description:"暂无智能体",image:"search"},{description:h(()=>[...i[1]||(i[1]=[f("div",{class:"empty-description"},[f("p",null,"暂时没有找到智能体"),f("p",{class:"empty-tip"},"您可以尝试调整搜索条件")],-1)])]),_:1})]),loading:h(()=>[p(o,{size:"24px",vertical:""},{default:h(()=>[...i[2]||(i[2]=[m("加载智能体数据...",-1)])]),_:1})]),_:1},512),p(d,{offset:v.value,"onUpdate:offset":i[0]||(i[0]=t=>v.value=t),axis:"xy",magnetic:"x",class:"create-bubble",onClick:_},{default:h(()=>[p(c,{name:"plus",size:"24",color:"#fff"})]),_:1},8,["offset"])]),_:1})}}});"function"==typeof L&&L(v);const k=s(v,[["__scopeId","data-v-e2802de5"]]);export{k as default};
