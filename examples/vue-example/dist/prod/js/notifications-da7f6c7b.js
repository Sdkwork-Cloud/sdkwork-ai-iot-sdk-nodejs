import{I as e,B as t,c as i,_ as a,L as o}from"./index-5affcab4.js";import{E as n}from"./index-ccee2c65.js";import{S as s}from"./sdkwork-api-list-2f474514.js";/* empty css              */import{T as l}from"./index-7bca35b2.js";/* empty css              *//* empty css              */import{k as c,c as d,r,Q as m,R as p,j as f,a1 as u,U as g,S as w,X as k,$ as S,Z as y,a0 as h,a4 as b,W as v}from"./vue-vendor-a2672387.js";import{C as D}from"./index-fe36d148.js";import{S as _}from"./sdkwork-page-container-5d58390b.js";import{b as I}from"./route-block-83d24a4e.js";import"./utils-vendor-b5712723.js";import"./use-id-82312033.js";import"./index-e159e7ef.js";import"./index-56f0d1d3.js";import"./use-tab-status-aca7131d.js";import"./shared-1cf0c357.js";import"./sdkwork-search-bar-4d747e22.js";import"./sdkwork-icon-2d6efb98.js";import"./ListItem-783a2127.js";import"./Checker-704ef18a.js";const j={key:0,class:"sdkwork-notification-item__selection"},x={class:"sdkwork-notification-item__icon"},O={key:0,class:"unread-indicator"},B={class:"sdkwork-notification-item__content"},A={class:"notification-header"},z={class:"notification-title"},M={class:"title-text"},T={class:"notification-time"},C={class:"notification-preview"},$={class:"notification-content"},L={key:0,class:"notification-actions"},R={key:1,class:"sdkwork-notification-item__actions"},F=a(c({__name:"sdkwork-notification-item",props:{notification:{},selectable:{type:Boolean,default:!1},deletable:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},isSelected:{type:Boolean,default:!1},showBorderBottom:{type:Boolean,default:!0},themeMode:{default:"auto"}},emits:["select","delete","read","action","click"],setup(a,{expose:o,emit:n}){const s=a,c=n,v=d(()=>"dark"===s.themeMode||"light"!==s.themeMode&&(!("undefined"==typeof window||!window.matchMedia)&&window.matchMedia("(prefers-color-scheme: dark)").matches)),_=d(()=>v.value?"sdkwork-notification-item--dark":"sdkwork-notification-item--light"),I=r(s.isSelected);d({get:()=>I.value,set:e=>{I.value=e,c("select",s.notification)}});const F=()=>{s.disabled||("unread"===s.notification.status&&c("read",s.notification),c("click",s.notification))},N=async()=>{if(!s.disabled)try{await i({title:"确认删除",message:`确定要删除通知"${s.notification.title}"吗？`}),c("delete",s.notification)}catch(e){}},U=()=>{s.disabled||c("action",s.notification)},V=e=>{const t=new Date(e),i=(new Date).getTime()-t.getTime(),a=Math.floor(i/6e4),o=Math.floor(i/36e5),n=Math.floor(i/864e5);return a<1?"刚刚":a<60?`${a}分钟前`:o<24?`${o}小时前`:1===n?"昨天":n<7?`${n}天前`:t.toLocaleDateString("zh-CN",{month:"2-digit",day:"2-digit"})},E=(e,t=50)=>e.length<=t?e:e.substring(0,t)+"...";return o({getTitle:()=>s.notification.title,getStatus:()=>s.notification.status,isUnread:()=>"unread"===s.notification.status,formatTime:V,truncateContent:E}),(i,o)=>{const n=D,s=e,c=l,d=t;return m(),p("div",{class:k(["sdkwork-notification-item",[{"sdkwork-notification-item--selected":a.isSelected,"sdkwork-notification-item--unread":"unread"===a.notification.status,"sdkwork-notification-item--disabled":a.disabled,"sdkwork-notification-item--border-bottom":a.showBorderBottom},_.value]]),onClick:F},[a.selectable?(m(),p("div",j,[f(n,{modelValue:I.value,"onUpdate:modelValue":o[0]||(o[0]=e=>I.value=e),onClick:o[1]||(o[1]=u(()=>{},["stop"]))},null,8,["modelValue"])])):g("",!0),w("div",x,[w("div",{class:k(["notification-icon",`notification-icon--${a.notification.type}`])},[f(s,{name:(r=a.notification.type,{info:"info-o",success:"success",warning:"warning-o",error:"cross",system:"bell-o"}[r]||"info-o")},null,8,["name"])],2),"unread"===a.notification.status?(m(),p("div",O)):g("",!0)]),w("div",B,[w("div",A,[w("div",z,[w("span",M,S(a.notification.title),1),"high"===a.notification.priority?(m(),y(c,{key:0,type:"danger",class:"priority-tag"},{default:h(()=>[...o[2]||(o[2]=[b(" 重要 ",-1)])]),_:1})):"medium"===a.notification.priority?(m(),y(c,{key:1,type:"warning",class:"priority-tag"},{default:h(()=>[...o[3]||(o[3]=[b(" 中等 ",-1)])]),_:1})):g("",!0)]),w("div",T,S(V(a.notification.timestamp)),1)]),w("div",C,[w("div",$,S(E(a.notification.content)),1)]),a.notification.actionText?(m(),p("div",L,[f(d,{type:"primary",plain:"",onClick:u(U,["stop"]),class:"action-button"},{default:h(()=>[b(S(a.notification.actionText),1)]),_:1})])):g("",!0)]),a.deletable?(m(),p("div",R,[f(d,{size:"small",type:"danger",plain:"",onClick:u(N,["stop"]),class:"delete-button"},{default:h(()=>[...o[4]||(o[4]=[b(" 删除 ",-1)])]),_:1})])):g("",!0)],2);var r}}}),[["__scopeId","data-v-1f14803a"]]),N={class:"sdkwork-notification-list"},U=a(c({__name:"sdkwork-notification-list",props:{api:{},params:{default:()=>({})},selectable:{type:Boolean,default:!1},deletable:{type:Boolean,default:!1},searchable:{type:Boolean,default:!1},pageSize:{default:10},itemKey:{default:"id"},itemTitleField:{default:"title"},itemDescriptionField:{default:"content"}},emits:{select:e=>!0,delete:e=>!0,read:e=>!0,action:e=>!0,search:e=>!0,load:e=>!0,click:e=>!0},setup(e,{expose:t,emit:i}){const a=e,l=i,c=r(),u=d(()=>({pageNumber:0,pageSize:a.pageSize,filters:a.params})),g=e=>{l("select",e)},k=e=>{l("delete",e)},S=e=>{l("search",e)},y=e=>{l("load",e)},D=e=>{l("select",e)},_=e=>{l("delete",e)},I=e=>{l("read",e)},j=e=>{l("action",e)},x=e=>{l("click",e)};return t({refresh:()=>c.value?.refresh(),loadMore:()=>c.value?.loadMore(),getData:()=>c.value?.getData()||[],getSelectedItems:()=>c.value?.getSelectedItems()||[],clearSelected:()=>c.value?.clearSelected(),setSelectedItems:e=>c.value?.setSelectedItems(e)}),(t,i)=>{const a=n,l=o;return m(),p("div",N,[f(s,{api:e.api,params:u.value,selectable:e.selectable,deletable:e.deletable,searchable:e.searchable,"page-size":e.pageSize,"item-key":e.itemKey,"item-title-field":e.itemTitleField,"item-description-field":e.itemDescriptionField,onSelect:g,onDelete:k,onSearch:S,onLoad:y,ref_key:"apiListRef",ref:c,"left-spacing":"0","right-spacing":"0"},{default:h(({item:t,index:i,selected:a})=>[f(F,{notification:t,selectable:e.selectable,deletable:e.deletable,"is-selected":a,"show-border-bottom":!0,onSelect:D,onDelete:_,onRead:I,onAction:j,onClick:x},null,8,["notification","selectable","deletable","is-selected"])]),empty:h(()=>[v(t.$slots,"empty",{},()=>[f(a,{description:"暂无通知消息",image:"search"},{description:h(()=>[...i[0]||(i[0]=[w("div",{class:"empty-description"},[w("p",null,"暂时没有通知消息"),w("p",{class:"empty-tip"},"您已查看所有通知")],-1)])]),_:1})],!0)]),loading:h(()=>[v(t.$slots,"loading",{},()=>[f(l,{size:"24px",vertical:""},{default:h(()=>[...i[1]||(i[1]=[b("加载通知数据...",-1)])]),_:1})],!0)]),header:h(()=>[v(t.$slots,"header",{},void 0,!0)]),footer:h(()=>[v(t.$slots,"footer",{},void 0,!0)]),_:3},8,["api","params","selectable","deletable","searchable","page-size","item-key","item-title-field","item-description-field"])])}}}),[["__scopeId","data-v-5301462d"]]),V=c({__name:"notifications",setup(e){const t=r(),i=async e=>{await new Promise(e=>setTimeout(e,500));const t=[{id:"1",title:"系统通知",content:"您的账户已成功创建，欢迎使用我们的服务",type:"info",status:"unread",timestamp:(new Date).toISOString(),createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),priority:"medium"},{id:"2",title:"订单状态更新",content:"您的订单 #12345 已发货，预计明天送达",type:"success",status:"read",timestamp:new Date(Date.now()-36e5).toISOString(),createdAt:new Date(Date.now()-36e5).toISOString(),updatedAt:new Date(Date.now()-36e5).toISOString(),priority:"high"},{id:"3",title:"安全提醒",content:"检测到异常登录活动，请及时检查账户安全",type:"warning",status:"unread",timestamp:new Date(Date.now()-72e5).toISOString(),createdAt:new Date(Date.now()-72e5).toISOString(),updatedAt:new Date(Date.now()-72e5).toISOString(),priority:"high"},{id:"4",title:"版本更新",content:"新版本 v2.1.0 已发布，包含多项功能优化",type:"info",status:"read",timestamp:new Date(Date.now()-864e5).toISOString(),createdAt:new Date(Date.now()-864e5).toISOString(),updatedAt:new Date(Date.now()-864e5).toISOString(),priority:"low"},{id:"5",title:"支付成功",content:"您的支付已成功处理，金额：¥199.00",type:"success",status:"read",timestamp:new Date(Date.now()-1728e5).toISOString(),createdAt:new Date(Date.now()-1728e5).toISOString(),updatedAt:new Date(Date.now()-1728e5).toISOString(),priority:"medium"}],i=e.pageNumber||0,a=e.pageSize||10,o=i*a,n=o+a,s=t.slice(o,n);return{content:s,totalElements:t.length,totalPages:Math.ceil(t.length/a),pageSize:a,pageNumber:i,first:0===i,last:n>=t.length,numberOfElements:s.length,empty:0===s.length}},a=e=>{console.log("选择通知:",e)},o=e=>{console.log("删除通知:",e)},n=e=>{console.log("标记为已读:",e)},s=e=>{console.log("执行通知动作:",e)},l=e=>{console.log("点击通知:",e),n(e)},c=e=>{console.log("搜索通知:",e)},d=e=>{console.log("加载通知数据:",e)};return(e,r)=>(m(),y(_,{"safe-area":"",scrollable:"","theme-mode":"auto"},{default:h(()=>[f(U,{api:i,searchable:!1,deletable:!0,onSelect:a,onDelete:o,onRead:n,onAction:s,onClick:l,onSearch:c,onLoad:d,ref_key:"notificationListRef",ref:t},null,512)]),_:1}))}});"function"==typeof I&&I(V);const E=a(V,[["__scopeId","data-v-f73ac86e"]]);export{E as default};
