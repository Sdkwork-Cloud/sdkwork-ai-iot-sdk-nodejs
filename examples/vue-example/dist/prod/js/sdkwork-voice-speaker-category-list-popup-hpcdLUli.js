import{_ as e}from"./sdkwork-popup-DdVoNvKm.js";import{I as a,_ as t,L as l,B as o}from"./index-BWqFoNHJ.js";/* empty css              */import{z as s,a as i,k as r,f as d,P as c,Q as n,R as u,S as p,W as m,$ as g,a1 as y,j as v,U as f,w as h,o as k,n as b,b as w,Z as S,F as C,Y as _,a0 as x,q as M,u as B,i as z,V as I,ac as F,ad as A,a4 as V}from"./vue-vendor-BOogp7Xw.js";import{_ as L}from"./sdkwork-pull-refresh-DgyaCCGo.js";import{D as $,u as j,S as D,E as K}from"./shared-B-9fzjxV.js";import{L as T}from"./ListItem-T6yJlaJ8.js";import{L as P}from"./LoadingSection-BuNRibDT.js";import{L as N}from"./LoadMoreSection-DUM7NAWd.js";import{S as U}from"./sdkwork-voice-clone-B3MMt-Y4.js";const R=s("audio",()=>{const e=i(null),a=i([]),t=i([]),l=i(null),o=e=>a.value.filter(a=>a.category===e);return{selectedSpeaker:e,speakers:a,categories:t,playingAudio:l,setSelectedSpeaker:a=>{e.value=a},clearSelectedSpeaker:()=>{e.value=null},setSpeakers:e=>{a.value=e},setCategories:e=>{t.value=e},previewSpeaker:async e=>{if(l.value&&(l.value.pause(),l.value=null),e.sampleAudio)try{const a=new Audio(e.sampleAudio);l.value=a,await a.play(),a.onended=()=>{l.value=null}}catch(a){console.error("播放试听音频失败:",a),l.value=null}else console.log("该发音人暂无试听音频")},stopPreview:()=>{l.value&&(l.value.pause(),l.value=null)},getSpeakersByCategory:o,getDefaultSpeakers:()=>{if(t.value.length>0){const e=t.value[0];return o(e?.id)}return a.value}}}),E={class:"avatar"},O=["src","alt"],q={key:1,class:"avatar-placeholder"},G={class:"info"},Q={class:"name-section"},W={class:"name"},Y={class:"description"},Z={class:"meta"},H={class:"language"},J={class:"gender"},X={key:0,class:"selection-indicator"},ee=t(r({__name:"sdkwork-voice-speaker-category-item",props:{speaker:{},active:{type:Boolean},themeMode:{default:"auto"}},emits:["select"],setup(e,{emit:t}){const l=e,o=t,s=R(),i=d(()=>"dark"===l.themeMode||"light"!==l.themeMode&&(!("undefined"==typeof window||!window.matchMedia)&&window.matchMedia("(prefers-color-scheme: dark)").matches)),r=d(()=>i.value?"voice-item--dark":"voice-item--light"),f=()=>{o("select",l.speaker)},h=()=>{s.previewSpeaker(l.speaker)};return(t,l)=>{const o=a;return n(),c("div",{class:u(["voice-item",[{active:e.active},r.value]]),onClick:f},[p("div",E,[e.speaker.avatar?(n(),c("img",{key:0,src:e.speaker.avatar,alt:e.speaker.name},null,8,O)):(n(),c("div",q,g((i=e.speaker.name,i.charAt(0).toUpperCase())),1))]),p("div",G,[p("div",Q,[p("span",W,g(e.speaker.name),1),p("div",{class:"preview-btn",onClick:y(h,["stop"])},[v(o,{name:"play-circle",size:"18"})])]),p("div",Y,g(e.speaker.description),1),p("div",Z,[p("span",H,g(e.speaker.language),1),p("span",J,g((s=e.speaker.gender,"male"===s?"男声":"女声")),1)])]),e.active?(n(),c("div",X,[v(o,{name:"success",size:"16",color:"#1989fa"})])):m("",!0)],2);var s,i}}}),[["__scopeId","data-v-2400f870"]]),ae={class:"default-category"},te={class:"category-name"},le={key:0,class:"category-count"},oe=t(r({__name:"CategoryItem",props:{category:{},index:{},active:{type:Boolean},categoryKey:{default:"id"},categoryNameField:{default:"name"},categoryCountField:{default:"count"},themeMode:{default:"auto"}},emits:["select"],setup(e,{emit:a}){const t=e,l=a,o=d(()=>"dark"===t.themeMode||"light"!==t.themeMode&&(!("undefined"==typeof window||!window.matchMedia)&&window.matchMedia("(prefers-color-scheme: dark)").matches)),s=d(()=>o.value?"category-item--dark":"category-item--light"),i=e=>e[t.categoryCountField]||"",r=()=>{l("select",t.category)};return(a,l)=>(n(),c("div",{class:u(["category-item",[{active:e.active},s.value]]),onClick:r},[f(a.$slots,"default",{category:e.category,index:e.index},()=>{return[p("div",ae,[p("div",te,g((a=e.category,a[t.categoryNameField]||"未知分类")),1),i(e.category)?(n(),c("div",le,g(i(e.category)),1)):m("",!0)])];var a},!0)],2))}}),[["__scopeId","data-v-9af08e01"]]),se={class:"main-content"},ie={key:0,class:"category-sidebar"},re={key:0,class:"category-loading"},de={key:1,class:"category-list"},ce={key:2,class:"data-section"},ne=t(r({__name:"sdkwork-api-category-list",props:{api:{type:Function,default:void 0},service:{default:void 0},params:{default:()=>({})},pageableParams:{default:()=>({})},selectable:{type:Boolean,default:$.selectable},deletable:{type:Boolean,default:$.deletable},searchable:{type:Boolean,default:$.searchable},pageSize:{default:$.pageSize},itemKey:{default:$.itemKey},itemTitleField:{default:$.itemTitleField},itemDescriptionField:{default:$.itemDescriptionField},topSpacing:{default:$.topSpacing},leftSpacing:{default:$.leftSpacing},rightSpacing:{default:$.rightSpacing},categorys:{default:()=>[]},categoryApi:{},categoryKey:{default:$.categoryKey},categoryNameField:{default:$.categoryNameField},categoryCountField:{default:$.categoryCountField},defaultCategoryId:{},selectionMode:{default:$.selectionMode},showBorderBottom:{type:Boolean},borderBottomLeftOffset:{},showNoMoreData:{type:Boolean},themeMode:{default:$.themeMode},minSize:{},itemGap:{},fixed:{type:Boolean},buffer:{},bufferTop:{},bufferBottom:{},horizontal:{type:Boolean},scrollDistance:{},fixSelection:{type:Boolean},start:{},offset:{},listStyle:{},listClass:{},itemStyle:{},itemClass:{},renderControl:{}},emits:["select-category","select","delete","search","reach-top","reach-bottom","scroll","item-resize","range-update","load"],setup(e,{expose:a,emit:t}){const l=e,o=t,s=i([]),r=i(!1),g=i([]),y=i(null),V=d(()=>"dark"===l.themeMode||"light"!==l.themeMode&&(!("undefined"==typeof window||!window.matchMedia)&&window.matchMedia("(prefers-color-scheme: dark)").matches)),$=d(()=>V.value?"api-category-list--dark":"api-category-list--light"),U=i();let R=null;const{dataList:E,currentPage:O,loading:q,loadingMore:G,hasMore:Q,loadData:W,onRefresh:Y}=j({api:l.api,service:l.service,params:(()=>{const e={...l.params};return y.value&&(e.categoryId=X(y.value,-1)),e})(),pageableParams:l.pageableParams,pageSize:l.pageSize,autoLoad:!1}),Z=d(()=>s.value.length>0),H=d(()=>({"padding-top":"number"==typeof l.topSpacing?`${l.topSpacing}px`:l.topSpacing,"padding-left":"number"==typeof l.leftSpacing?`${l.leftSpacing}px`:l.leftSpacing,"padding-right":"number"==typeof l.rightSpacing?`${l.rightSpacing}px`:l.rightSpacing})),J=(e,a)=>e[l.itemKey]||a,X=(e,a)=>e[l.categoryKey]||a,ee=e=>!!y.value&&X(e,-1)===X(y.value,-1),ae=e=>g.value.some(a=>J(a,-1)===J(e,-1)),te=e=>{o("search",e),W(0)},le=e=>{y.value=e,o("select-category",e),W(0)},ne=e=>{if(l.selectable){const a=g.value.findIndex(a=>J(a,-1)===J(e,-1));a>-1?g.value.splice(a,1):"single"===l.selectionMode?g.value=[e]:g.value.push(e)}o("select",e)},ue=e=>{o("delete",e)};return h(()=>l.params,()=>{W(0)},{deep:!0}),h(()=>l.pageSize,()=>{W(0)}),h(()=>l.categorys,()=>{l.categorys&&l.categorys.length>0&&(s.value=l.categorys)},{deep:!0}),k(()=>{(async()=>{if(!r.value)try{if(r.value=!0,l.categoryApi?s.value=await l.categoryApi():l.categorys&&l.categorys.length>0&&(s.value=l.categorys),l.defaultCategoryId&&s.value.length>0){const e=s.value.find(e=>X(e,-1)===l.defaultCategoryId);e&&(y.value=e)}else s.value.length>0&&(y.value=s.value[0])}catch(e){console.error("加载分类数据失败:",e)}finally{r.value=!1}})().then(()=>{W(0)}),b(()=>{U.value?.$el&&(R=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&Q.value&&!G.value&&!q.value&&W(O.value+1,!0)})},{root:null,rootMargin:"0px",threshold:.1}),R.observe(U.value.$el))})}),w(()=>{R&&(R.disconnect(),R=null)}),a({refresh:()=>W(0),loadMore:()=>W(O.value+1,!0),getData:()=>E.value,getSelectedItems:()=>g.value,clearSelected:()=>{g.value=[]},setSelectedItems:e=>{"single"===l.selectionMode&&e.length>1?(console.warn("单选模式下只能设置一个选中项，将使用第一个项"),g.value=[e[0]]):g.value=e},getCategories:()=>s.value,getSelectedCategory:()=>y.value,setSelectedCategory:e=>{y.value=e,W(0)}}),(a,t)=>{const o=L;return n(),c("div",{class:u(["sdkwork-api-category-list",$.value])},[e.searchable?(n(),S(D,{key:0,searchable:e.searchable,onSearch:te},null,8,["searchable"])):m("",!0),p("div",se,[Z.value?(n(),c("div",ie,[r.value?(n(),c("div",re,[...t[1]||(t[1]=[p("div",{class:"loading-spinner"},null,-1),p("span",null,"加载分类中...",-1)])])):(n(),c("div",de,[(n(!0),c(C,null,_(s.value,(t,l)=>(n(),S(oe,{key:X(t,l),category:t,index:l,active:ee(t),"category-key":e.categoryKey,"category-name-field":e.categoryNameField,"category-count-field":e.categoryCountField,onSelect:le},{default:x(({category:e,index:t})=>[f(a.$slots,"category",M({ref_for:!0},{category:e,index:t}),void 0,!0)]),_:3},8,["category","index","active","category-key","category-name-field","category-count-field"]))),128))]))])):m("",!0),p("div",{class:u(["content-list",{"with-sidebar":Z.value}])},[v(o,{modelValue:B(q),"onUpdate:modelValue":t[0]||(t[0]=e=>z(q)?q.value=e:null),onRefresh:B(Y)},{default:x(()=>[p("div",{class:"list-content",style:I(H.value)},[B(q)&&!B(E).length?(n(),S(P,{key:0},{default:x(({loading:e})=>[f(a.$slots,"loading",F(A({loading:e})),void 0,!0)]),_:3})):B(q)||B(E).length?(n(),c("div",ce,[f(a.$slots,"header",{},void 0,!0),(n(!0),c(C,null,_(B(E),(t,o)=>(n(),S(T,{key:J(t,o),item:t,index:o,selectable:e.selectable,deletable:e.deletable,"is-selected":ae(t),"item-key":e.itemKey,"item-title-field":e.itemTitleField,"item-description-field":e.itemDescriptionField,"show-border-bottom":l.showBorderBottom,"border-bottom-left-offset":l.borderBottomLeftOffset,onSelect:ne,onDelete:ue},{default:x(({item:e,index:t,selected:l})=>[f(a.$slots,"default",{item:e,index:t,selected:l},void 0,!0)]),_:3},8,["item","index","selectable","deletable","is-selected","item-key","item-title-field","item-description-field","show-border-bottom","border-bottom-left-offset"]))),128)),f(a.$slots,"footer",{},void 0,!0),v(N,{"has-more":B(Q),"loading-more":B(G),"data-list":B(E),ref_key:"loadMoreSectionRef",ref:U},null,8,["has-more","loading-more","data-list"])])):(n(),S(K,{key:1},{default:x(({empty:e})=>[f(a.$slots,"empty",F(A({empty:e})),void 0,!0)]),_:3}))],4)]),_:3},8,["modelValue","onRefresh"])],2)])],2)}}}),[["__scopeId","data-v-9f6a2c55"]]),ue={class:"voice-clone-popup"},pe={class:"popup-content"},me=t(r({__name:"sdkwork-voice-clone-popup",props:{modelValue:{type:Boolean,default:!1},title:{default:"语音克隆"},height:{default:"100%"},confirmText:{default:"开始克隆"},text:{default:"请朗读这段文字：欢迎使用语音克隆功能，请清晰地朗读这段文字。"},uploadable:{type:Boolean,default:!0},recordable:{type:Boolean,default:!0},accept:{default:"audio/*"},maxSize:{default:10},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","confirm","close","upload","record","clone"],setup(a,{emit:t}){const l=a,o=t,s=i(l.modelValue),r=i(null),d=i(null);h(()=>l.modelValue,e=>{s.value=e}),h(s,e=>{o("update:modelValue",e),e||o("close")});const c=e=>{r.value=e,d.value=null,o("upload",e)},u=e=>{d.value=e,r.value=null,o("record",e)},m=()=>{o("clone")};return(t,l)=>{const o=e;return n(),S(o,{show:s.value,"onUpdate:show":l[0]||(l[0]=e=>s.value=e),position:"bottom",style:I({height:a.height}),round:"","close-on-click-overlay":!1},{default:x(()=>[p("div",ue,[p("div",pe,[v(U,{text:a.text,uploadable:a.uploadable,recordable:a.recordable,accept:a.accept,"max-size":a.maxSize,disabled:a.disabled,onUpload:c,onRecord:u,onClone:m},null,8,["text","uploadable","recordable","accept","max-size","disabled"])])])]),_:1},8,["show","style"])}}}),[["__scopeId","data-v-a420987d"]]),ge=[{id:1,name:"小爱同学",description:"甜美可爱的女声，适合日常对话",avatar:"",category:"female",language:"中文",gender:"female",sampleAudio:""},{id:2,name:"小度",description:"清晰自然的男声，适合播报新闻",avatar:"",category:"male",language:"中文",gender:"male",sampleAudio:""},{id:3,name:"Siri",description:"标准美式英语发音，适合国际交流",avatar:"",category:"female",language:"英语",gender:"female",sampleAudio:""},{id:4,name:"Alex",description:"深沉有力的男声，适合朗读文学作品",avatar:"",category:"male",language:"英语",gender:"male",sampleAudio:""},{id:5,name:"樱花",description:"温柔细腻的女声，适合儿童故事",avatar:"",category:"female",language:"中文",gender:"female",sampleAudio:""},{id:6,name:"晓晓",description:"年轻活力的女声，适合娱乐内容",avatar:"",category:"female",language:"中文",gender:"female",sampleAudio:""},{id:7,name:"云希",description:"知性优雅的女声，适合知识分享",avatar:"",category:"female",language:"中文",gender:"female",sampleAudio:""},{id:8,name:"逍遥",description:"沉稳大气的男声，适合商务场景",avatar:"",category:"male",language:"中文",gender:"male",sampleAudio:""}],ye=[{id:"all",name:"全部",count:ge.length},{id:"female",name:"女声",count:ge.filter(e=>"female"===e.gender).length},{id:"male",name:"男声",count:ge.filter(e=>"male"===e.gender).length},{id:"chinese",name:"中文",count:ge.filter(e=>"中文"===e.language).length},{id:"english",name:"英语",count:ge.filter(e=>"英语"===e.language).length}],ve=async e=>{await new Promise(e=>setTimeout(e,300));let a=ge;if(e.categoryId&&"all"!==e.categoryId&&(a=ge.filter(a=>a.category===e.categoryId||a.language===e.categoryId)),e.keyword){const t=e.keyword.toLowerCase();a=a.filter(e=>e.name.toLowerCase().includes(t)||e.description.toLowerCase().includes(t))}const t=e.page||0,l=e.size||10,o=t*l,s=o+l;return{content:a.slice(o,s),totalElements:a.length,totalPages:Math.ceil(a.length/l),number:t,size:l,first:0===t,last:s>=a.length}},fe=async()=>(await new Promise(e=>setTimeout(e,200)),ye),he={class:"voice-category-item"},ke={class:"category-name"},be={class:"voice-empty"},we={class:"voice-loading"},Se=t(r({__name:"sdkwork-voice-speaker-category-list",props:{api:{},params:{default:()=>({})},searchable:{type:Boolean,default:!0},selectable:{type:Boolean,default:!0},pageSize:{default:20},categoryApi:{},categorys:{default:()=>[]},categoryKey:{default:"id"},categoryNameField:{default:"name"},categoryCountField:{default:"count"},defaultCategoryId:{},selectedSpeakerId:{},showCloneButton:{type:Boolean,default:!0},themeMode:{default:"auto"}},emits:["select","search","select-category","load","clone"],setup(e,{expose:t,emit:o}){const s=e,r=o,m=R(),y=i(!1),f=d(()=>"dark"===s.themeMode||"light"!==s.themeMode&&(!("undefined"==typeof window||!window.matchMedia)&&window.matchMedia("(prefers-color-scheme: dark)").matches)),h=d(()=>f.value?"voice-list--dark":"voice-list--light"),k=d(()=>s.api||ve),b=d(()=>s.categoryApi||fe),w=d(()=>s.categorys&&s.categorys.length>0?s.categorys:ye),S=e=>{s.selectable&&m.setSelectedSpeaker(e),r("select",e)},C=e=>{r("search",e)},_=e=>{r("select-category",e)},M=e=>{r("load",e)},B=e=>{y.value=!1,r("clone",e)},z=()=>{y.value=!1};return t({refresh:()=>{},getSelectedSpeaker:()=>m.selectedSpeaker,setSelectedSpeaker:e=>{m.setSelectedSpeaker(e)}}),(t,o)=>{const s=ee,i=a,r=l;return n(),c("div",{class:u(["sdkwork-voice-speaker-category-list",h.value])},[v(ne,{api:k.value,params:e.params,searchable:e.searchable,selectable:e.selectable,"page-size":e.pageSize,"category-api":b.value,categorys:w.value,"category-key":e.categoryKey,"category-name-field":e.categoryNameField,"category-count-field":e.categoryCountField,"default-category-id":e.defaultCategoryId,"theme-mode":e.themeMode,onSelect:S,onSearch:C,onSelectCategory:_,onLoad:M},{default:x(({item:a,selected:t})=>[v(s,{speaker:a,active:t,"theme-mode":e.themeMode,onSelect:o[0]||(o[0]=e=>{(e=>{S(e)})(e)})},null,8,["speaker","active","theme-mode"])]),category:x(({category:e})=>[p("div",he,[p("span",ke,g(e.name),1)])]),empty:x(()=>[p("div",be,[v(i,{name:"music",size:"48",color:"#ccc"}),o[2]||(o[2]=p("div",{class:"empty-text"},"暂无发音人",-1))])]),loading:x(()=>[p("div",we,[v(r,{size:"24px"}),o[3]||(o[3]=p("span",null,"加载发音人中...",-1))])]),_:1},8,["api","params","searchable","selectable","page-size","category-api","categorys","category-key","category-name-field","category-count-field","default-category-id","theme-mode"]),v(me,{show:y.value,"onUpdate:show":o[1]||(o[1]=e=>y.value=e),onConfirm:B,onClose:z},null,8,["show"])],2)}}}),[["__scopeId","data-v-32037512"]]),Ce={class:"voice-list-popup"},_e={class:"popup-content"},xe={class:"popup-footer"},Me={key:0,class:"buttons-row"},Be={key:1,class:"single-button"},ze=t(r({__name:"sdkwork-voice-speaker-category-list-popup",props:{modelValue:{type:Boolean,default:!1},title:{default:"选择发音人"},height:{default:"70vh"},confirmText:{default:"确认"},api:{},params:{default:()=>({})},categoryApi:{},categorys:{default:()=>[]},selectedSpeakerId:{},themeMode:{default:"auto"},showCloneButton:{type:Boolean,default:!0}},emits:["update:modelValue","confirm","close","select","search","load","clone"],setup(a,{emit:t}){const l=a,s=t,r=i(l.modelValue),u=i(null),m=i(!1),y=d(()=>u.value?`克隆声音 - ${u.value.name}`:"克隆声音");h(()=>l.modelValue,e=>{r.value=e}),h(r,e=>{s("update:modelValue",e),e||s("close")});const f=()=>{u.value&&(s("confirm",u.value),r.value=!1)},k=e=>{u.value=e,s("select",e)},b=e=>{s("search",e)},w=e=>{s("load",e)},S=()=>{setTimeout(()=>{m.value=!0},300),s("clone")},_=(e,a)=>{console.log("克隆确认",{audioFile:e,audioBlob:a,speaker:u.value}),m.value=!1},M=()=>{m.value=!1};return(t,s)=>{const i=o,d=e;return n(),c(C,null,[v(d,{show:r.value,"onUpdate:show":s[0]||(s[0]=e=>r.value=e),position:"bottom",style:I({height:a.height}),round:"",closeable:"","close-on-click-overlay":!1,"theme-mode":a.themeMode,title:a.title},{default:x(()=>[p("div",Ce,[p("div",_e,[v(Se,{api:a.api,params:a.params,"category-api":a.categoryApi,categorys:a.categorys,"selected-speaker-id":a.selectedSpeakerId,"selection-mode":"single",onSelect:k,onSearch:b,onLoad:w},null,8,["api","params","category-api","categorys","selected-speaker-id"])]),p("div",xe,[l.showCloneButton?(n(),c("div",Me,[v(i,{type:"default",size:"large",onClick:S,class:"clone-btn"},{default:x(()=>[...s[2]||(s[2]=[V(" 克隆我的声音 ",-1)])]),_:1}),v(i,{type:"primary",size:"large",onClick:f,class:"confirm-btn"},{default:x(()=>[V(g(a.confirmText),1)]),_:1})])):(n(),c("div",Be,[v(i,{type:"primary",size:"large",block:"",onClick:f,class:"confirm-btn"},{default:x(()=>[V(g(a.confirmText),1)]),_:1})]))])])]),_:1},8,["show","style","theme-mode","title"]),v(me,{modelValue:m.value,"onUpdate:modelValue":s[1]||(s[1]=e=>m.value=e),title:y.value,onConfirm:_,onClose:M},null,8,["modelValue","title"])],64)}}}),[["__scopeId","data-v-b50dd23b"]]);export{ze as S};
