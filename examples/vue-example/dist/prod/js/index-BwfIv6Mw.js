import{k as e,r as a,f as t,b as l,n as s,w as u,d as o,a as v,s as i,v as n,j as r,m as c,q as f}from"./vue-vendor-CnVaDBlt.js";import{q as p,c as g,y as h,z as x,C as d,b as y,D as m,E as b,F as j,G as w,H as T,w as k}from"./index-DS3FT4GI.js";function C(e,a){return e.reduce((e,t)=>Math.abs(e-a)<Math.abs(t-a)?e:t)}const O={gap:{type:[Number,Object],default:24},icon:String,axis:p("y"),magnetic:String,offset:Object,teleport:{type:[String,Object],default:"body"}},[S,q]=g("floating-bubble");const D=k(e({name:S,inheritAttrs:!1,props:O,emits:["click","update:offset","offsetChange"],setup(e,{slots:p,emit:g,attrs:k}){const O=a(),S=a({x:0,y:0,width:0,height:0}),D=t(()=>h(e.gap)?e.gap.x:e.gap),F=t(()=>h(e.gap)?e.gap.y:e.gap),M=t(()=>({top:F.value,right:d.value-S.value.width-D.value,bottom:x.value-S.value.height-F.value,left:D.value})),P=a(!1);let $=!1;const z=t(()=>{const e={},a=y(S.value.x),t=y(S.value.y);return e.transform=`translate3d(${a}, ${t}, 0)`,!P.value&&$||(e.transition="none"),e}),A=()=>{if(!B.value)return;const{width:a,height:t}=w(O.value),{offset:l}=e;S.value={x:l?l.x:d.value-a-D.value,y:l?l.y:x.value-t-F.value,width:a,height:t}},E=m();let G=0,H=0;const N=e=>{E.start(e),P.value=!0,G=S.value.x,H=S.value.y};b("touchmove",a=>{if(a.preventDefault(),E.move(a),"lock"!==e.axis&&!E.isTap.value){if("x"===e.axis||"xy"===e.axis){let e=G+E.deltaX.value;e<M.value.left&&(e=M.value.left),e>M.value.right&&(e=M.value.right),S.value.x=e}if("y"===e.axis||"xy"===e.axis){let e=H+E.deltaY.value;e<M.value.top&&(e=M.value.top),e>M.value.bottom&&(e=M.value.bottom),S.value.y=e}const a=T(S.value,["x","y"]);g("update:offset",a)}},{target:O});const X=()=>{P.value=!1,s(()=>{if("x"===e.magnetic){const e=C([M.value.left,M.value.right],S.value.x);S.value.x=e}if("y"===e.magnetic){const e=C([M.value.top,M.value.bottom],S.value.y);S.value.y=e}if(!E.isTap.value){const e=T(S.value,["x","y"]);g("update:offset",e),G===e.x&&H===e.y||g("offsetChange",e)}})},Y=e=>{E.isTap.value?g("click",e):e.stopPropagation()};l(()=>{A(),s(()=>{$=!0})}),u([d,x,D,F,()=>e.offset],A,{deep:!0});const B=a(!0);return o(()=>{B.value=!0}),v(()=>{e.teleport&&(B.value=!1)}),()=>{const a=i(r("div",c({class:q(),ref:O,onTouchstartPassive:N,onTouchend:X,onTouchcancel:X,onClickCapture:Y,style:z.value},k),[p.default?p.default():r(j,{name:e.icon,class:q("icon")},null)]),[[n,B.value]]);return e.teleport?r(f,{to:e.teleport},{default:()=>[a]}):a}}}));export{D as F};
