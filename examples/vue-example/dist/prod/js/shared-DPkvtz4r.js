import{_ as e}from"./sdkwork-search-bar-BVv1IjtJ.js";import{k as a,a as t,P as s,j as o,Q as r,U as l,ac as i,ad as n,f as u,w as c}from"./vue-vendor-BvtDOCb5.js";import{_ as p}from"./index-CS7g9XHh.js";import{E as m}from"./index-1dsIbHLT.js";const d={class:"search-section"},v=p(a({__name:"SearchSection",props:{searchable:{type:Boolean}},emits:["search"],setup(a,{emit:l}){const i=l,n=t(""),u=(()=>{let e=null;return a=>{e&&clearTimeout(e),e=setTimeout(()=>{c(a)},300)}})(),c=e=>{const a=void 0!==e?e:n.value;i("search",a)},p=()=>{u(n.value)},m=()=>{n.value="",c("")};return(a,t)=>{const l=e;return r(),s("div",d,[o(l,{modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=e=>n.value=e),placeholder:"请输入搜索关键词",onSearch:c,onClear:m,onInput:p},null,8,["modelValue"])])}}}),[["__scopeId","data-v-913efe76"]]),g={class:"empty-section"},y=p(a({__name:"EmptySection",props:{empty:{type:Boolean,default:!0}},setup:e=>(e,a)=>{const t=m;return r(),s("div",g,[l(e.$slots,"empty",i(n({empty:!0})),()=>[o(t,{description:"暂无数据"})],!0)])}}),[["__scopeId","data-v-ed806e0f"]]),h=["page","size","sort"];function f(e){const a=t([]),s=t(0),o=t(0),r=t(0),l=t(!1),i=t(!1),n=t(!0),p=u(()=>!l.value&&0===a.value.length),m=u(()=>0===s.value&&0===a.value.length),d=()=>!(!e.api&&!e.service)&&(e.api&&e.service,!0),v=(a=0)=>{const{pageableParams:t,queryParams:s}=((e={})=>{const a={},t={};return Object.entries(e).forEach(([e,s])=>{h.includes(e)?a[e]=s:t[e]=s}),{pageableParams:a,queryParams:t}})(e.params),o={size:e.pageSize||10,...t,...e.pageableParams,page:a,pageNumber:a};s.page=a;return{pageableParams:o,queryParams:s}},g=async(a=0)=>{const{pageableParams:t,queryParams:s}=v(a);if(e.service&&"function"==typeof e.service.listByPage)return await e.service.listByPage(s,t);if(e.api)return await e.api(s,t);throw new Error("组件没有可用的请求方法")},y=async(t=0,u=!1)=>{if(!(l.value||u&&i.value)&&(!u||n.value)){if(!d())return l.value=!1,void(i.value=!1);try{u?i.value=!0:l.value=!0;const c=await g(t);if(0===t)a.value=c.content||[];else{const t=new Set(a.value.map(a=>a.id||a[e.itemKey||"id"])),s=(c.content||[]).filter(a=>{const s=a.id||a[e.itemKey||"id"];return!t.has(s)});a.value=[...a.value,...s],s.length,(c.content||[]).length}const p=c.pageable||{};s.value=p.pageNumber||0,o.value=c.total||0;const m=p.pageSize||e.pageSize||10;r.value=m>0?Math.ceil(o.value/m):0,n.value=!c.last}catch(c){}finally{l.value=!1,i.value=!1}}};return c(()=>e.params,()=>{!1!==e.autoLoad&&y(0)},{deep:!0}),c(()=>e.pageSize,()=>{!1!==e.autoLoad&&y(0)}),!1!==e.autoLoad&&y(0),{dataList:a,currentPage:s,totalElements:o,totalPages:r,loading:l,loadingMore:i,hasMore:n,isEmpty:p,isFirstLoad:m,loadData:y,onRefresh:async()=>{l.value=!0;try{await y(0),l.value=!1}catch(e){l.value=!1}},validateProps:d,buildRequestParams:v,handleRequest:g}}const b={selectable:!1,deletable:!1,searchable:!1,pageSize:10,itemKey:"id",itemTitleField:"name",itemDescriptionField:"description",showBorderBottom:!0,borderBottomLeftOffset:0,showNoMoreData:!1,themeMode:"auto",columns:2,gap:16,categoryKey:"id",categoryNameField:"name",categoryCountField:"count",selectionMode:"single",tabsSticky:!0,tabsSwipeable:!0,topSpacing:"6px",leftSpacing:"8px",rightSpacing:"8px"};export{b as D,y as E,v as S,f as u};
