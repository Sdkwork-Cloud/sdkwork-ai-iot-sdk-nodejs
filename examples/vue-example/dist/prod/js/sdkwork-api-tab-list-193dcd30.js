import{_ as e}from"./index-34815b62.js";/* empty css              *//* empty css              */import{_ as t}from"./sdkwork-pull-refresh-bd126f9c.js";import{D as a,u as l,S as s,E as o}from"./shared-f3996f0d.js";import{L as i}from"./ListItem-b2f4f4bf.js";import{L as d}from"./LoadMoreSection-8eb45153.js";import{T as r,a as n}from"./index-1a9a24a7.js";import{k as u,r as c,c as m,w as f,b as p,n as v,o as b,Q as h,R as y,j as g,a0 as S,F as k,Y as w,Z as B,S as x,U as _,u as M,f as D,W as T,q as F,ad as j,ae as z,X as L}from"./vue-vendor-905d75e5.js";const $={key:0,class:"tab-section"},I={class:"tab-content"},A={class:"list-content"},E={key:1,class:"data-section"},K={key:1,class:"no-tab-section"},O={class:"list-content"},P={key:1,class:"data-section"},R=e(u({__name:"sdkwork-api-tab-list",props:{api:{type:Function,default:void 0},service:{default:void 0},params:{default:()=>({})},pageableParams:{default:()=>({})},selectable:{type:Boolean,default:a.selectable},deletable:{type:Boolean,default:a.deletable},searchable:{type:Boolean,default:a.searchable},pageSize:{default:a.pageSize},itemKey:{default:a.itemKey},itemTitleField:{default:a.itemTitleField},itemDescriptionField:{default:a.itemDescriptionField},topSpacing:{default:a.topSpacing},leftSpacing:{default:a.leftSpacing},rightSpacing:{default:a.rightSpacing},tabs:{default:()=>[]},tabsApi:{},tabsSticky:{type:Boolean,default:a.tabsSticky},tabsSwipeable:{type:Boolean,default:a.tabsSwipeable},defaultActiveTab:{},showBorderBottom:{type:Boolean,default:a.showBorderBottom},borderBottomLeftOffset:{default:a.borderBottomLeftOffset},showNoMoreData:{type:Boolean,default:a.showNoMoreData},themeMode:{default:a.themeMode},minSize:{},itemGap:{},fixed:{type:Boolean},buffer:{},bufferTop:{},bufferBottom:{},horizontal:{type:Boolean},scrollDistance:{},fixSelection:{type:Boolean},start:{},offset:{},listStyle:{},listClass:{},itemStyle:{},itemClass:{},renderControl:{}},emits:["tab-change","select","delete","search","reach-top","reach-bottom","scroll","item-resize","range-update","load"],setup(e,{expose:a,emit:u}){const R=e,V=u,C=c([]),U=c(R.defaultActiveTab),N=c([]),Q=c(!1),q=m(()=>N.value.length>0),G=m(()=>"dark"===R.themeMode||"light"!==R.themeMode&&(!("undefined"==typeof window||!window.matchMedia)&&window.matchMedia("(prefers-color-scheme: dark)").matches)),W=m(()=>G.value?"api-tab-list--dark":"api-tab-list--light"),X=c();let Y=null;const Z=m(()=>{if(!q.value)return R.params;const e=N.value.find(e=>fe(e)===U.value);return{...R.params,...e?.params||{}}}),{dataList:H,currentPage:J,totalElements:ee,totalPages:te,loading:ae,loadingMore:le,hasMore:se,isEmpty:oe,isFirstLoad:ie,loadData:de,onRefresh:re}=l({api:R.api,service:R.service,params:Z,pageableParams:R.pageableParams,pageSize:R.pageSize,autoLoad:!1}),ne=(e,t)=>e[R.itemKey]||t,ue=e=>C.value.some(t=>ne(t,-1)===ne(e,-1)),ce=e=>fe(e),me=e=>e.title||String(e.value),fe=e=>e.value,pe=async(e=0,t=!1)=>{try{await de(e,t),(H.value.length>0||0===e)&&V("load",{content:H.value,number:J.value,totalElements:ee.value,totalPages:te.value,last:!se.value,empty:0===H.value.length,first:0===J.value,numberOfElements:H.value.length,size:R.pageSize})}catch(a){console.error("加载数据失败:",a)}},ve=()=>{pe(0)},be=e=>{V("search",e),pe(0)},he=e=>{U.value=e;const t=N.value.find(t=>fe(t)===e);t&&(V("tab-change",t,t.params||{}),pe(0))},ye=e=>{if(R.selectable){const t=C.value.findIndex(t=>ne(t,-1)===ne(e,-1));t>-1?C.value.splice(t,1):C.value.push(e)}V("select",e)},ge=e=>{V("delete",e)};return f(()=>R.params,()=>{de(0)},{deep:!0}),f(()=>R.pageSize,()=>{de(0)}),f(U,()=>{de(0)}),p(()=>{(async()=>{if(R.tabsApi)try{Q.value=!0;const e=await R.tabsApi();N.value=e,N.value.length>0&&!U.value&&(U.value=fe(N.value[0]))}catch(e){console.error("加载Tabs数据失败:",e)}finally{Q.value=!1}else R.tabs.length>0&&(N.value=R.tabs,N.value.length>0&&!U.value&&(U.value=fe(N.value[0])))})().then(()=>{de(0),v(()=>{X.value?.$el&&(Y=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&se.value&&!le.value&&!ae.value&&pe(J.value+1,!0)})},{root:null,rootMargin:"0px",threshold:.1}),Y.observe(X.value.$el))})})}),b(()=>{Y&&(Y.disconnect(),Y=null)}),a({refresh:()=>de(0),loadMore:()=>de(J.value+1,!0),getData:()=>H.value,getSelectedItems:()=>C.value,clearSelected:()=>{C.value=[]},setSelectedItems:e=>{C.value=e},getActiveTab:()=>U.value,setActiveTab:e=>{U.value=e},getTabsData:()=>N.value}),(a,l)=>{const u=t,c=r,m=n;return h(),y("div",{class:L(["sdkwork-api-tab-list",W.value])},[q.value?(h(),y("div",$,[g(m,{active:U.value,"onUpdate:active":l[1]||(l[1]=e=>U.value=e),sticky:e.tabsSticky,swipeable:e.tabsSwipeable,onChange:he},{default:S(()=>[(h(!0),y(k,null,w(N.value,t=>(h(),B(c,{key:ce(t),title:me(t),name:fe(t)},{default:S(()=>[x("div",I,[e.searchable?(h(),B(s,{key:0,searchable:e.searchable,onSearch:be},null,8,["searchable"])):_("",!0),g(u,{modelValue:M(ae),"onUpdate:modelValue":l[0]||(l[0]=e=>D(ae)?ae.value=e:null),onRefresh:ve},{default:S(()=>[x("div",A,[M(ae)||M(H).length?(h(),y("div",E,[T(a.$slots,"header",{},void 0,!0),(h(!0),y(k,null,w(M(H),(t,l)=>(h(),B(i,{key:ne(t,l),item:t,index:l,selectable:e.selectable,deletable:e.deletable,"is-selected":ue(t),"item-key":e.itemKey,"item-title-field":e.itemTitleField,"item-description-field":e.itemDescriptionField,"show-border-bottom":R.showBorderBottom,"border-bottom-left-offset":R.borderBottomLeftOffset,onSelect:ye,onDelete:ge},{default:S(({item:e,index:t,selected:l})=>[T(a.$slots,"default",{item:e,index:t,selected:l},void 0,!0)]),_:3},8,["item","index","selectable","deletable","is-selected","item-key","item-title-field","item-description-field","show-border-bottom","border-bottom-left-offset"]))),128)),T(a.$slots,"footer",{},void 0,!0),g(d,{"has-more":M(se),"loading-more":M(le),"data-list":M(H),ref_for:!0,ref_key:"loadMoreSectionRef",ref:X},null,8,["has-more","loading-more","data-list"])])):(h(),B(o,{key:0},{default:S(({empty:e})=>[T(a.$slots,"empty",F({ref_for:!0},{empty:e}),void 0,!0)]),_:3}))])]),_:3},8,["modelValue"])])]),_:3},8,["title","name"]))),128))]),_:3},8,["active","sticky","swipeable"])])):(h(),y("div",K,[e.searchable?(h(),B(s,{key:0,searchable:e.searchable,onSearch:be},null,8,["searchable"])):_("",!0),g(u,{modelValue:M(ae),"onUpdate:modelValue":l[2]||(l[2]=e=>D(ae)?ae.value=e:null),onRefresh:ve},{default:S(()=>[x("div",O,[M(ae)||M(H).length?(h(),y("div",P,[T(a.$slots,"header",{},void 0,!0),(h(!0),y(k,null,w(M(H),(t,l)=>(h(),B(i,{key:ne(t,l),item:t,index:l,selectable:e.selectable,deletable:e.deletable,"is-selected":ue(t),"item-key":e.itemKey,"item-title-field":e.itemTitleField,"item-description-field":e.itemDescriptionField,onSelect:ye,onDelete:ge},{default:S(({item:e,index:t,selected:l})=>[T(a.$slots,"default",{item:e,index:t,selected:l},void 0,!0)]),_:3},8,["item","index","selectable","deletable","is-selected","item-key","item-title-field","item-description-field"]))),128)),T(a.$slots,"footer",{},void 0,!0),g(d,{"has-more":M(se),"loading-more":M(le),"data-list":M(H),ref_key:"loadMoreSectionRef",ref:X},null,8,["has-more","loading-more","data-list"])])):(h(),B(o,{key:0},{default:S(({empty:e})=>[T(a.$slots,"empty",j(z({empty:e})),void 0,!0)]),_:3}))])]),_:3},8,["modelValue"])]))],2)}}}),[["__scopeId","data-v-df121a28"]]);export{R as S};
