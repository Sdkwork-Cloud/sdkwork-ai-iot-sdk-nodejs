import{_ as e,L as a}from"./LoadMoreSection-CWYnUmFR.js";import{k as l,f as t,P as i,Q as s,R as o,W as d,S as n,j as c,a1 as r,a0 as p,U as m,r as u,w as f,b as v,n as g,o as b,Z as h,u as y,i as S,ac as k,ad as x,F as _,Y as w,V as F,X as $}from"./vue-vendor-BAnrfl1G.js";import{D as j,u as D,S as I,E as z}from"./shared-DSXEP7p_.js";import{B,I as L,_ as P}from"./index-TwMLNQLv.js";/* empty css              *//* empty css              *//* empty css              */import{C as M}from"./index-CdJ-vIGQ.js";import{L as R}from"./LoadingSection-BtVo-TRD.js";const T={key:0,class:"selection-overlay"},K={key:1,class:"delete-overlay"},V={class:"waterfall-item-content"},C=P(l({__name:"WaterfallItem",props:{item:{},index:{},selectable:{type:Boolean,default:!1},deletable:{type:Boolean,default:!1},isSelected:{type:Boolean,default:!1},itemKey:{default:"id"},itemTitleField:{default:"name"},itemDescriptionField:{default:"description"}},emits:["select","delete","click"],setup(e,{emit:a}){const l=e,u=a,f=e=>{l.selectable&&u("select",l.item)},v=()=>{l.selectable?f(b.value):u("click",l.item)},g=()=>{l.deletable&&u("delete",l.item)},b=t(()=>l.isSelected);return t(()=>l.item[l.itemTitleField]||""),t(()=>l.item[l.itemDescriptionField]||""),(a,l)=>{const t=M,u=L,h=B;return s(),i("div",{class:o(["waterfall-item",{"waterfall-item--selected":b.value,"waterfall-item--selectable":e.selectable,"waterfall-item--deletable":e.deletable}]),onClick:v},[e.selectable?(s(),i("div",T,[c(t,{"model-value":b.value,"onUpdate:modelValue":f,onClick:l[0]||(l[0]=r(()=>{},["stop"])),class:"selection-checkbox"},null,8,["model-value"])])):d("",!0),e.deletable?(s(),i("div",K,[c(h,{type:"danger",round:"",onClick:r(g,["stop"]),class:"delete-button"},{default:p(()=>[c(u,{name:"delete",size:"14"})]),_:1})])):d("",!0),n("div",V,[m(a.$slots,"default",{item:e.item,index:e.index,selected:b.value},void 0,!0)])],2)}}}),[["__scopeId","data-v-fec8c58d"]]),E={class:"sdkwork-api-waterfall"},U={key:2,class:"data-section"},W={class:"waterfall-container"},q=P(l({__name:"sdkwork-api-waterfall",props:{api:{type:Function,default:void 0},service:{default:void 0},params:{default:()=>({})},pageableParams:{default:()=>({})},selectable:{type:Boolean,default:j.selectable},deletable:{type:Boolean,default:j.deletable},searchable:{type:Boolean,default:j.searchable},pageSize:{default:j.pageSize},itemKey:{default:j.itemKey},itemTitleField:{default:j.itemTitleField},itemDescriptionField:{default:j.itemDescriptionField},topSpacing:{default:j.topSpacing},leftSpacing:{default:j.leftSpacing},rightSpacing:{default:j.rightSpacing},columns:{default:j.columns},gap:{default:j.gap}},emits:["select","delete","search","reach-top","reach-bottom","scroll","item-resize","range-update","load"],setup(l,{expose:o,emit:r}){$(e=>({v62b79a6a:j.columns,v655f6d69:j.gap+"px"}));const j=l,B=r,L=u([]),P=u();let M=null;const{dataList:T,currentPage:K,totalElements:V,totalPages:q,loading:G,loadingMore:H,hasMore:O,loadData:Q,onRefresh:X}=D({api:j.api,service:j.service,params:j.params,pageableParams:j.pageableParams,pageSize:j.pageSize,autoLoad:!1}),Y=t(()=>"number"==typeof j.topSpacing?`${j.topSpacing}px`:j.topSpacing),Z=t(()=>"number"==typeof j.leftSpacing?`${j.leftSpacing}px`:j.leftSpacing),A=t(()=>"number"==typeof j.rightSpacing?`${j.rightSpacing}px`:j.rightSpacing),J=t(()=>({paddingTop:Y.value,paddingLeft:Z.value,paddingRight:A.value})),N=(e,a)=>e[j.itemKey]||a,ee=e=>L.value.some(a=>N(a,-1)===N(e,-1)),ae=e=>{B("search",e),(async(e=0,a=!1)=>{try{await Q(e,a),(T.value.length>0||0===e)&&B("load",{content:T.value,number:K.value,totalElements:V.value,totalPages:q.value,last:!O.value})}catch(l){}})(0)},le=e=>{if(j.selectable){const a=L.value.findIndex(a=>N(a,-1)===N(e,-1));a>-1?L.value.splice(a,1):L.value.push(e)}B("select",e)},te=e=>{B("delete",e)};return f(()=>j.params,()=>{Q(0)},{deep:!0}),f(()=>j.pageSize,()=>{Q(0)}),v(()=>{Q(0),g(()=>{P.value?.$el&&(M=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&O.value&&!H.value&&!G.value&&Q(K.value+1,!0)})},{root:null,rootMargin:"0px",threshold:.1}),M.observe(P.value.$el))})}),b(()=>{M&&(M.disconnect(),M=null)}),o({refresh:()=>Q(0),loadMore:()=>Q(K.value+1,!0),getData:()=>T.value,getSelectedItems:()=>L.value,clearSelected:()=>{L.value=[]},setSelectedItems:e=>{L.value=e}}),(t,o)=>{const r=e;return s(),i("div",E,[l.searchable?(s(),h(I,{key:0,searchable:l.searchable,onSearch:ae},null,8,["searchable"])):d("",!0),c(r,{modelValue:y(G),"onUpdate:modelValue":o[0]||(o[0]=e=>S(G)?G.value=e:null),onRefresh:y(X)},{default:p(()=>[n("div",{class:"waterfall-content",style:F(J.value)},[y(G)&&!y(T).length?(s(),h(R,{key:0},{default:p(({loading:e})=>[m(t.$slots,"loading",k(x({loading:e})),void 0,!0)]),_:3})):y(G)||y(T).length?(s(),i("div",U,[m(t.$slots,"header",{},void 0,!0),n("div",W,[(s(!0),i(_,null,w(y(T),(e,a)=>(s(),h(C,{key:N(e,a),item:e,index:a,selectable:l.selectable,deletable:l.deletable,"is-selected":ee(e),"item-key":l.itemKey,"item-title-field":l.itemTitleField,"item-description-field":l.itemDescriptionField,onSelect:le,onDelete:te},{default:p(({item:e,index:a,selected:l})=>[m(t.$slots,"default",{item:e,index:a,selected:l},void 0,!0)]),_:3},8,["item","index","selectable","deletable","is-selected","item-key","item-title-field","item-description-field"]))),128))]),m(t.$slots,"footer",{},void 0,!0),c(a,{"has-more":y(O),"loading-more":y(H),"data-list":y(T),ref_key:"loadMoreSectionRef",ref:P},null,8,["has-more","loading-more","data-list"])])):(s(),h(z,{key:1},{default:p(({empty:e})=>[m(t.$slots,"empty",k(x({empty:e})),void 0,!0)]),_:3}))],4)]),_:3},8,["modelValue","onRefresh"])])}}}),[["__scopeId","data-v-bc078e8a"]]);export{q as S};
