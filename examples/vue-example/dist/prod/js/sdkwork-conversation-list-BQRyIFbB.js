import{I as e,_ as t,L as s}from"./index-Cw3XK0oB.js";import{E as a}from"./index-DB8XvqDx.js";import{S as i}from"./sdkwork-api-list-Cts-jFj-.js";import{I as o}from"./index-BA8-zepc.js";import{k as n,f as r,P as l,Q as d,R as c,S as m,j as p,W as v,a0 as u,a4 as k,Z as f,$ as g,r as h,U as w}from"./vue-vendor-CnVaDBlt.js";const b={class:"sdkwork-conversation-list-item__avatar"},y={class:"avatar-placeholder"},S={key:0,class:"online-indicator"},_={class:"sdkwork-conversation-list-item__content"},B={class:"conversation-header"},M={class:"conversation-title"},z={class:"conversation-time"},C={class:"conversation-preview"},x={class:"last-message"},D={key:0,class:"message-content"},I={key:1,class:"no-message"},T={key:0,class:"unread-badge"},j=t(n({__name:"sdkwork-conversation-list-item",props:{conversation:{},disabled:{type:Boolean,default:!1},isSelected:{type:Boolean,default:!1},showBorderBottom:{type:Boolean,default:!0},themeMode:{default:"auto"}},emits:["click","select"],setup(t,{expose:s,emit:a}){const i=t,n=a,h=r(()=>"dark"===i.themeMode||"light"!==i.themeMode&&(!("undefined"==typeof window||!window.matchMedia)&&window.matchMedia("(prefers-color-scheme: dark)").matches)),w=r(()=>h.value?"sdkwork-conversation-list-item--dark":"sdkwork-conversation-list-item--light"),j=()=>{i.disabled||n("click",i.conversation)},L=e=>{const t=new Date(e),s=(new Date).getTime()-t.getTime(),a=Math.floor(s/864e5);return 0===a?t.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):1===a?"昨天":a<7?`${a}天前`:t.toLocaleDateString("zh-CN",{month:"2-digit",day:"2-digit"})},$=e=>e.length<=30?e:e.substring(0,30)+"...";return s({getTitle:()=>i.conversation.title,getUnreadCount:()=>i.conversation.unreadCount,isPinned:()=>i.conversation.pinned,formatTime:L,truncateMessage:$}),(s,a)=>{const i=e,n=o;return d(),l("div",{class:c(["sdkwork-conversation-list-item",[{"sdkwork-conversation-list-item--selected":t.isSelected,"sdkwork-conversation-list-item--pinned":t.conversation.pinned,"sdkwork-conversation-list-item--unread":t.conversation.unreadCount>0,"sdkwork-conversation-list-item--disabled":t.disabled,"sdkwork-conversation-list-item--border-bottom":t.showBorderBottom},w.value]]),onClick:j},[m("div",b,[p(n,{src:t.conversation.participants[0]?.avatar,width:"44",height:"44",radius:"4",fit:"cover"},{error:u(()=>[m("div",y,[p(i,{name:"chat-o",size:"18"})])]),_:1},8,["src"]),t.conversation.participants[0]?.online?(d(),l("div",S)):v("",!0)]),m("div",_,[m("div",B,[m("div",M,[k(g(t.conversation.title)+" ",1),t.conversation.pinned?(d(),f(i,{key:0,name:"pin",class:"pin-icon"})):v("",!0)]),m("div",z,g(L(t.conversation.updatedAt)),1)]),m("div",C,[m("div",x,[t.conversation.lastMessage?(d(),l("span",D,g($(t.conversation.lastMessage.content)),1)):(d(),l("span",I,"暂无消息"))]),t.conversation.unreadCount>0?(d(),l("div",T,g(t.conversation.unreadCount>99?"99+":t.conversation.unreadCount),1)):v("",!0)])])],2)}}}),[["__scopeId","data-v-deeef61f"]]),L={class:"sdkwork-conversation-list"},$=t(n({__name:"sdkwork-conversation-list",props:{api:{},params:{default:()=>({})},selectable:{type:Boolean,default:!1},deletable:{type:Boolean,default:!1},searchable:{type:Boolean,default:!1},pageSize:{default:10},itemKey:{default:"id"},itemTitleField:{default:"title"},itemDescriptionField:{default:"description"}},emits:["select","delete","archive","pin","mute","search","load","click","context-menu"],setup(e,{expose:t,emit:o}){const n=e,c=o,v=h(),f=r(()=>({pageNumber:0,pageSize:n.pageSize,filters:n.params})),g=e=>{c("select",e)},b=e=>{c("delete",e)},y=e=>{c("search",e)},S=e=>{c("load",e)},_=e=>{c("select",e)},B=e=>{c("click",e)};return t({refresh:()=>v.value?.refresh(),loadMore:()=>v.value?.loadMore(),getData:()=>v.value?.getData()||[],getSelectedItems:()=>v.value?.getSelectedItems()||[],clearSelected:()=>v.value?.clearSelected(),setSelectedItems:e=>v.value?.setSelectedItems(e)}),(t,o)=>{const n=a,r=s;return d(),l("div",L,[p(i,{api:e.api,params:f.value,selectable:e.selectable,deletable:e.deletable,searchable:e.searchable,"page-size":e.pageSize,"item-key":e.itemKey,"item-title-field":e.itemTitleField,"item-description-field":e.itemDescriptionField,"left-spacing":0,"right-spacing":0,onSelect:g,onDelete:b,onSearch:y,onLoad:S,ref_key:"apiListRef",ref:v,showBorderBottom:"",borderBottomLeftOffset:60},{default:u(({item:e,index:t,selected:s})=>[p(j,{conversation:e,"is-selected":s,"show-border-bottom":!0,onClick:B,onSelect:_},null,8,["conversation","is-selected"])]),empty:u(()=>[w(t.$slots,"empty",{},()=>[p(n,{description:"暂无聊天会话",image:"search"},{description:u(()=>[...o[0]||(o[0]=[m("div",{class:"empty-description"},[m("p",null,"暂时没有聊天会话"),m("p",{class:"empty-tip"},"您可以开始新的对话或调整搜索条件")],-1)])]),_:1})],!0)]),loading:u(()=>[w(t.$slots,"loading",{},()=>[p(r,{size:"24px",vertical:""},{default:u(()=>[...o[1]||(o[1]=[k("加载会话数据...",-1)])]),_:1})],!0)]),header:u(()=>[w(t.$slots,"header",{},void 0,!0)]),footer:u(()=>[w(t.$slots,"footer",{},void 0,!0)]),_:3},8,["api","params","selectable","deletable","searchable","page-size","item-key","item-title-field","item-description-field"])])}}}),[["__scopeId","data-v-bb158ad7"]]);export{$ as S};
