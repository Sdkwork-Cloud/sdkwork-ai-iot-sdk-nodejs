import{k as e,a,f as t,o as l,n as s,w as u,d as o,c as v,t as i,v as n,j as r,q as c,s as f}from"./vue-vendor-B1RsE4Tz.js";import{r as p,c as g,z as h,C as x,D as d,b as y,E as m,F as b,G as j,H as w,J as T,w as k}from"./index-mGUiS-yG.js";function C(e,a){return e.reduce((e,t)=>Math.abs(e-a)<Math.abs(t-a)?e:t)}const O={gap:{type:[Number,Object],default:24},icon:String,axis:p("y"),magnetic:String,offset:Object,teleport:{type:[String,Object],default:"body"}},[S,D]=g("floating-bubble");const F=k(e({name:S,inheritAttrs:!1,props:O,emits:["click","update:offset","offsetChange"],setup(e,{slots:p,emit:g,attrs:k}){const O=a(),S=a({x:0,y:0,width:0,height:0}),F=t(()=>h(e.gap)?e.gap.x:e.gap),M=t(()=>h(e.gap)?e.gap.y:e.gap),P=t(()=>({top:M.value,right:d.value-S.value.width-F.value,bottom:x.value-S.value.height-M.value,left:F.value})),$=a(!1);let q=!1;const z=t(()=>{const e={},a=y(S.value.x),t=y(S.value.y);return e.transform=`translate3d(${a}, ${t}, 0)`,!$.value&&q||(e.transition="none"),e}),A=()=>{if(!Y.value)return;const{width:a,height:t}=w(O.value),{offset:l}=e;S.value={x:l?l.x:d.value-a-F.value,y:l?l.y:x.value-t-M.value,width:a,height:t}},E=m();let G=0,H=0;const J=e=>{E.start(e),$.value=!0,G=S.value.x,H=S.value.y};b("touchmove",a=>{if(a.preventDefault(),E.move(a),"lock"!==e.axis&&!E.isTap.value){if("x"===e.axis||"xy"===e.axis){let e=G+E.deltaX.value;e<P.value.left&&(e=P.value.left),e>P.value.right&&(e=P.value.right),S.value.x=e}if("y"===e.axis||"xy"===e.axis){let e=H+E.deltaY.value;e<P.value.top&&(e=P.value.top),e>P.value.bottom&&(e=P.value.bottom),S.value.y=e}const a=T(S.value,["x","y"]);g("update:offset",a)}},{target:O});const N=()=>{$.value=!1,s(()=>{if("x"===e.magnetic){const e=C([P.value.left,P.value.right],S.value.x);S.value.x=e}if("y"===e.magnetic){const e=C([P.value.top,P.value.bottom],S.value.y);S.value.y=e}if(!E.isTap.value){const e=T(S.value,["x","y"]);g("update:offset",e),G===e.x&&H===e.y||g("offsetChange",e)}})},X=e=>{E.isTap.value?g("click",e):e.stopPropagation()};l(()=>{A(),s(()=>{q=!0})}),u([d,x,F,M,()=>e.offset],A,{deep:!0});const Y=a(!0);return o(()=>{Y.value=!0}),v(()=>{e.teleport&&(Y.value=!1)}),()=>{const a=i(r("div",c({class:D(),ref:O,onTouchstartPassive:J,onTouchend:N,onTouchcancel:N,onClickCapture:X,style:z.value},k),[p.default?p.default():r(j,{name:e.icon,class:D("icon")},null)]),[[n,Y.value]]);return e.teleport?r(f,{to:e.teleport},{default:()=>[a]}):a}}}));export{F};
