import{t as e,p as a,r as i,c as o,at as r,U as s,F as t,H as n,a1 as l,L as d,w as u}from"./index-dgv0w5gS.js";import{u as c}from"./use-tab-status-C8BruCQu.js";import{k as f,a as g,f as p,w as v,ah as h,o as m,j as x,n as b}from"./vue-vendor-BOogp7Xw.js";const[T,j,k]=o("list");const w=u(f({name:T,props:{error:Boolean,offset:i(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:a("down"),loadingText:String,finishedText:String,immediateCheck:e},emits:["load","update:error","update:loading"],setup(e,{emit:a,slots:i}){const o=g(e.loading),u=g(),f=g(),T=c(),w=r(u),B=p(()=>e.scroller||w.value),C=()=>{b(()=>{if(o.value||e.finished||e.disabled||e.error||!1===(null==T?void 0:T.value))return;const{direction:i}=e,r=+e.offset,s=n(B);if(!s.height||l(u))return;let t=!1;const d=n(f);t="up"===i?s.top-d.top<=r:d.bottom-s.bottom<=r,t&&(o.value=!0,a("update:loading",!0),a("load"))})},S=()=>{if(e.finished){const a=i.finished?i.finished():e.finishedText;if(a)return x("div",{class:j("finished-text")},[a])}},L=()=>{a("update:error",!1),C()},y=()=>{if(e.error){const a=i.error?i.error():e.errorText;if(a)return x("div",{role:"button",class:j("error-text"),tabindex:0,onClick:L},[a])}},F=()=>{if(o.value&&!e.finished&&!e.disabled)return x("div",{class:j("loading")},[i.loading?i.loading():x(d,{class:j("loading-icon")},{default:()=>[e.loadingText||k("loading")]})])};return v(()=>[e.loading,e.finished,e.error],C),T&&v(T,e=>{e&&C()}),h(()=>{o.value=e.loading}),m(()=>{e.immediateCheck&&C()}),s({check:C}),t("scroll",C,{target:B,passive:!0}),()=>{var a;const r=null==(a=i.default)?void 0:a.call(i),s=x("div",{ref:f,class:j("placeholder")},null);return x("div",{ref:u,role:"feed",class:j(),"aria-busy":o.value},["down"===e.direction?r:s,F(),S(),y(),"up"===e.direction?r:s])}}}));export{w as L};
