import{_ as e}from"./sdkwork-popup-2839b588.js";import{I as a,_ as t,L as l,B as o}from"./index-34815b62.js";/* empty css              */import{z as s,r as i,k as r,c as d,Q as c,R as n,S as u,$ as p,a1 as m,j as g,U as y,X as v,W as f,w as h,b as k,n as b,o as w,Z as S,F as C,Y as _,a0 as x,q as M,V as B,u as I,ad as z,ae as F,f as A,a4 as L}from"./vue-vendor-905d75e5.js";import{_ as V}from"./sdkwork-pull-refresh-bd126f9c.js";import{D as $,u as K,S as j,E as T}from"./shared-f3996f0d.js";import{L as D}from"./ListItem-b2f4f4bf.js";import{L as P}from"./LoadingSection-50beb699.js";import{L as N}from"./LoadMoreSection-8eb45153.js";import{S as U}from"./sdkwork-voice-clone-f3949dc2.js";const R=s("audio",()=>{const e=i(null),a=i([]),t=i([]),l=i(null),o=e=>a.value.filter(a=>a.category===e);return{selectedSpeaker:e,speakers:a,categories:t,playingAudio:l,setSelectedSpeaker:a=>{e.value=a},clearSelectedSpeaker:()=>{e.value=null},setSpeakers:e=>{a.value=e},setCategories:e=>{t.value=e},previewSpeaker:async e=>{if(l.value&&(l.value.pause(),l.value=null),e.sampleAudio)try{const a=new Audio(e.sampleAudio);l.value=a,await a.play(),a.onended=()=>{l.value=null}}catch(a){console.error("播放试听音频失败:",a),l.value=null}else console.log("该发音人暂无试听音频")},stopPreview:()=>{l.value&&(l.value.pause(),l.value=null)},getSpeakersByCategory:o,getDefaultSpeakers:()=>{if(t.value.length>0){const e=t.value[0];return o(e?.id)}return a.value}}}),E={class:"avatar"},O=["src","alt"],Q={key:1,class:"avatar-placeholder"},q={class:"info"},G={class:"name-section"},W={class:"name"},X={class:"description"},Y={class:"meta"},Z={class:"language"},H={class:"gender"},J={key:0,class:"selection-indicator"},ee=t(r({__name:"sdkwork-voice-speaker-category-item",props:{speaker:{},active:{type:Boolean},themeMode:{default:"auto"}},emits:["select"],setup(e,{emit:t}){const l=e,o=t,s=R(),i=d(()=>"dark"===l.themeMode||"light"!==l.themeMode&&(!("undefined"==typeof window||!window.matchMedia)&&window.matchMedia("(prefers-color-scheme: dark)").matches)),r=d(()=>i.value?"voice-item--dark":"voice-item--light"),f=()=>{o("select",l.speaker)},h=()=>{s.previewSpeaker(l.speaker)};return(t,l)=>{const o=a;return c(),n("div",{class:v(["voice-item",[{active:e.active},r.value]]),onClick:f},[u("div",E,[e.speaker.avatar?(c(),n("img",{key:0,src:e.speaker.avatar,alt:e.speaker.name},null,8,O)):(c(),n("div",Q,p((i=e.speaker.name,i.charAt(0).toUpperCase())),1))]),u("div",q,[u("div",G,[u("span",W,p(e.speaker.name),1),u("div",{class:"preview-btn",onClick:m(h,["stop"])},[g(o,{name:"play-circle",size:"18"})])]),u("div",X,p(e.speaker.description),1),u("div",Y,[u("span",Z,p(e.speaker.language),1),u("span",H,p((s=e.speaker.gender,"male"===s?"男声":"女声")),1)])]),e.active?(c(),n("div",J,[g(o,{name:"success",size:"16",color:"#1989fa"})])):y("",!0)],2);var s,i}}}),[["__scopeId","data-v-2400f870"]]),ae={class:"default-category"},te={class:"category-name"},le={key:0,class:"category-count"},oe=t(r({__name:"CategoryItem",props:{category:{},index:{},active:{type:Boolean},categoryKey:{default:"id"},categoryNameField:{default:"name"},categoryCountField:{default:"count"},themeMode:{default:"auto"}},emits:["select"],setup(e,{emit:a}){const t=e,l=a,o=d(()=>"dark"===t.themeMode||"light"!==t.themeMode&&(!("undefined"==typeof window||!window.matchMedia)&&window.matchMedia("(prefers-color-scheme: dark)").matches)),s=d(()=>o.value?"category-item--dark":"category-item--light"),i=e=>e[t.categoryCountField]||"",r=()=>{l("select",t.category)};return(a,l)=>(c(),n("div",{class:v(["category-item",[{active:e.active},s.value]]),onClick:r},[f(a.$slots,"default",{category:e.category,index:e.index},()=>{return[u("div",ae,[u("div",te,p((a=e.category,a[t.categoryNameField]||"未知分类")),1),i(e.category)?(c(),n("div",le,p(i(e.category)),1)):y("",!0)])];var a},!0)],2))}}),[["__scopeId","data-v-9af08e01"]]),se={class:"main-content"},ie={key:0,class:"category-sidebar"},re={key:0,class:"category-loading"},de={key:1,class:"category-list"},ce={key:2,class:"data-section"},ne=t(r({__name:"sdkwork-api-category-list",props:{api:{type:Function,default:void 0},service:{default:void 0},params:{default:()=>({})},pageableParams:{default:()=>({})},selectable:{type:Boolean,default:$.selectable},deletable:{type:Boolean,default:$.deletable},searchable:{type:Boolean,default:$.searchable},pageSize:{default:$.pageSize},itemKey:{default:$.itemKey},itemTitleField:{default:$.itemTitleField},itemDescriptionField:{default:$.itemDescriptionField},topSpacing:{default:$.topSpacing},leftSpacing:{default:$.leftSpacing},rightSpacing:{default:$.rightSpacing},categorys:{default:()=>[]},categoryApi:{},categoryKey:{default:$.categoryKey},categoryNameField:{default:$.categoryNameField},categoryCountField:{default:$.categoryCountField},defaultCategoryId:{},selectionMode:{default:$.selectionMode},showBorderBottom:{type:Boolean},borderBottomLeftOffset:{},showNoMoreData:{type:Boolean},themeMode:{default:$.themeMode},minSize:{},itemGap:{},fixed:{type:Boolean},buffer:{},bufferTop:{},bufferBottom:{},horizontal:{type:Boolean},scrollDistance:{},fixSelection:{type:Boolean},start:{},offset:{},listStyle:{},listClass:{},itemStyle:{},itemClass:{},renderControl:{}},emits:["select-category","select","delete","search","reach-top","reach-bottom","scroll","item-resize","range-update","load"],setup(e,{expose:a,emit:t}){const l=e,o=t,s=i([]),r=i(!1),p=i([]),m=i(null),L=d(()=>"dark"===l.themeMode||"light"!==l.themeMode&&(!("undefined"==typeof window||!window.matchMedia)&&window.matchMedia("(prefers-color-scheme: dark)").matches)),$=d(()=>L.value?"api-category-list--dark":"api-category-list--light"),U=i();let R=null;const{dataList:E,currentPage:O,totalElements:Q,totalPages:q,loading:G,loadingMore:W,hasMore:X,isEmpty:Y,isFirstLoad:Z,loadData:H,onRefresh:J}=K({api:l.api,service:l.service,params:(()=>{const e={...l.params};return m.value&&(e.categoryId=le(m.value,-1)),e})(),pageableParams:l.pageableParams,pageSize:l.pageSize,autoLoad:!1}),ee=d(()=>s.value.length>0),ae=d(()=>({"padding-top":"number"==typeof l.topSpacing?`${l.topSpacing}px`:l.topSpacing,"padding-left":"number"==typeof l.leftSpacing?`${l.leftSpacing}px`:l.leftSpacing,"padding-right":"number"==typeof l.rightSpacing?`${l.rightSpacing}px`:l.rightSpacing})),te=(e,a)=>e[l.itemKey]||a,le=(e,a)=>e[l.categoryKey]||a,ne=e=>!!m.value&&le(e,-1)===le(m.value,-1),ue=e=>p.value.some(a=>te(a,-1)===te(e,-1)),pe=e=>{o("search",e),H(0)},me=e=>{m.value=e,o("select-category",e),H(0)},ge=e=>{if(l.selectable){const a=p.value.findIndex(a=>te(a,-1)===te(e,-1));a>-1?p.value.splice(a,1):"single"===l.selectionMode?p.value=[e]:p.value.push(e)}o("select",e)},ye=e=>{o("delete",e)};return h(()=>l.params,()=>{H(0)},{deep:!0}),h(()=>l.pageSize,()=>{H(0)}),h(()=>l.categorys,()=>{l.categorys&&l.categorys.length>0&&(s.value=l.categorys)},{deep:!0}),k(()=>{(async()=>{if(!r.value)try{if(r.value=!0,l.categoryApi?s.value=await l.categoryApi():l.categorys&&l.categorys.length>0&&(s.value=l.categorys),l.defaultCategoryId&&s.value.length>0){const e=s.value.find(e=>le(e,-1)===l.defaultCategoryId);e&&(m.value=e)}else s.value.length>0&&(m.value=s.value[0])}catch(e){console.error("加载分类数据失败:",e)}finally{r.value=!1}})().then(()=>{H(0)}),b(()=>{U.value?.$el&&(R=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&X.value&&!W.value&&!G.value&&H(O.value+1,!0)})},{root:null,rootMargin:"0px",threshold:.1}),R.observe(U.value.$el))})}),w(()=>{R&&(R.disconnect(),R=null)}),a({refresh:()=>H(0),loadMore:()=>H(O.value+1,!0),getData:()=>E.value,getSelectedItems:()=>p.value,clearSelected:()=>{p.value=[]},setSelectedItems:e=>{"single"===l.selectionMode&&e.length>1?(console.warn("单选模式下只能设置一个选中项，将使用第一个项"),p.value=[e[0]]):p.value=e},getCategories:()=>s.value,getSelectedCategory:()=>m.value,setSelectedCategory:e=>{m.value=e,H(0)}}),(a,t)=>{const o=V;return c(),n("div",{class:v(["sdkwork-api-category-list",$.value])},[e.searchable?(c(),S(j,{key:0,searchable:e.searchable,onSearch:pe},null,8,["searchable"])):y("",!0),u("div",se,[ee.value?(c(),n("div",ie,[r.value?(c(),n("div",re,[...t[1]||(t[1]=[u("div",{class:"loading-spinner"},null,-1),u("span",null,"加载分类中...",-1)])])):(c(),n("div",de,[(c(!0),n(C,null,_(s.value,(t,l)=>(c(),S(oe,{key:le(t,l),category:t,index:l,active:ne(t),"category-key":e.categoryKey,"category-name-field":e.categoryNameField,"category-count-field":e.categoryCountField,onSelect:me},{default:x(({category:e,index:t})=>[f(a.$slots,"category",M({ref_for:!0},{category:e,index:t}),void 0,!0)]),_:3},8,["category","index","active","category-key","category-name-field","category-count-field"]))),128))]))])):y("",!0),u("div",{class:v(["content-list",{"with-sidebar":ee.value}])},[g(o,{modelValue:I(G),"onUpdate:modelValue":t[0]||(t[0]=e=>A(G)?G.value=e:null),onRefresh:I(J)},{default:x(()=>[u("div",{class:"list-content",style:B(ae.value)},[I(G)&&!I(E).length?(c(),S(P,{key:0},{default:x(({loading:e})=>[f(a.$slots,"loading",z(F({loading:e})),void 0,!0)]),_:3})):I(G)||I(E).length?(c(),n("div",ce,[f(a.$slots,"header",{},void 0,!0),(c(!0),n(C,null,_(I(E),(t,o)=>(c(),S(D,{key:te(t,o),item:t,index:o,selectable:e.selectable,deletable:e.deletable,"is-selected":ue(t),"item-key":e.itemKey,"item-title-field":e.itemTitleField,"item-description-field":e.itemDescriptionField,"show-border-bottom":l.showBorderBottom,"border-bottom-left-offset":l.borderBottomLeftOffset,onSelect:ge,onDelete:ye},{default:x(({item:e,index:t,selected:l})=>[f(a.$slots,"default",{item:e,index:t,selected:l},void 0,!0)]),_:3},8,["item","index","selectable","deletable","is-selected","item-key","item-title-field","item-description-field","show-border-bottom","border-bottom-left-offset"]))),128)),f(a.$slots,"footer",{},void 0,!0),g(N,{"has-more":I(X),"loading-more":I(W),"data-list":I(E),ref_key:"loadMoreSectionRef",ref:U},null,8,["has-more","loading-more","data-list"])])):(c(),S(T,{key:1},{default:x(({empty:e})=>[f(a.$slots,"empty",z(F({empty:e})),void 0,!0)]),_:3}))],4)]),_:3},8,["modelValue","onRefresh"])],2)])],2)}}}),[["__scopeId","data-v-9f6a2c55"]]),ue={class:"voice-clone-popup"},pe={class:"popup-content"},me=t(r({__name:"sdkwork-voice-clone-popup",props:{modelValue:{type:Boolean,default:!1},title:{default:"语音克隆"},height:{default:"100%"},confirmText:{default:"开始克隆"},text:{default:"请朗读这段文字：欢迎使用语音克隆功能，请清晰地朗读这段文字。"},uploadable:{type:Boolean,default:!0},recordable:{type:Boolean,default:!0},accept:{default:"audio/*"},maxSize:{default:10},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","confirm","close","upload","record","clone"],setup(a,{emit:t}){const l=a,o=t,s=i(l.modelValue),r=i(null),d=i(null);h(()=>l.modelValue,e=>{s.value=e}),h(s,e=>{o("update:modelValue",e),e||o("close")});const n=e=>{r.value=e,d.value=null,o("upload",e)},p=e=>{d.value=e,r.value=null,o("record",e)},m=()=>{o("clone")};return(t,l)=>{const o=e;return c(),S(o,{show:s.value,"onUpdate:show":l[0]||(l[0]=e=>s.value=e),position:"bottom",style:B({height:a.height}),round:"","close-on-click-overlay":!1},{default:x(()=>[u("div",ue,[u("div",pe,[g(U,{text:a.text,uploadable:a.uploadable,recordable:a.recordable,accept:a.accept,"max-size":a.maxSize,disabled:a.disabled,onUpload:n,onRecord:p,onClone:m},null,8,["text","uploadable","recordable","accept","max-size","disabled"])])])]),_:1},8,["show","style"])}}}),[["__scopeId","data-v-a420987d"]]),ge=[{id:1,name:"小爱同学",description:"甜美可爱的女声，适合日常对话",avatar:"",category:"female",language:"中文",gender:"female",sampleAudio:""},{id:2,name:"小度",description:"清晰自然的男声，适合播报新闻",avatar:"",category:"male",language:"中文",gender:"male",sampleAudio:""},{id:3,name:"Siri",description:"标准美式英语发音，适合国际交流",avatar:"",category:"female",language:"英语",gender:"female",sampleAudio:""},{id:4,name:"Alex",description:"深沉有力的男声，适合朗读文学作品",avatar:"",category:"male",language:"英语",gender:"male",sampleAudio:""},{id:5,name:"樱花",description:"温柔细腻的女声，适合儿童故事",avatar:"",category:"female",language:"中文",gender:"female",sampleAudio:""},{id:6,name:"晓晓",description:"年轻活力的女声，适合娱乐内容",avatar:"",category:"female",language:"中文",gender:"female",sampleAudio:""},{id:7,name:"云希",description:"知性优雅的女声，适合知识分享",avatar:"",category:"female",language:"中文",gender:"female",sampleAudio:""},{id:8,name:"逍遥",description:"沉稳大气的男声，适合商务场景",avatar:"",category:"male",language:"中文",gender:"male",sampleAudio:""}],ye=[{id:"all",name:"全部",count:ge.length},{id:"female",name:"女声",count:ge.filter(e=>"female"===e.gender).length},{id:"male",name:"男声",count:ge.filter(e=>"male"===e.gender).length},{id:"chinese",name:"中文",count:ge.filter(e=>"中文"===e.language).length},{id:"english",name:"英语",count:ge.filter(e=>"英语"===e.language).length}],ve=async e=>{await new Promise(e=>setTimeout(e,300));let a=ge;if(e.categoryId&&"all"!==e.categoryId&&(a=ge.filter(a=>a.category===e.categoryId||a.language===e.categoryId)),e.keyword){const t=e.keyword.toLowerCase();a=a.filter(e=>e.name.toLowerCase().includes(t)||e.description.toLowerCase().includes(t))}const t=e.page||0,l=e.size||10,o=t*l,s=o+l;return{content:a.slice(o,s),totalElements:a.length,totalPages:Math.ceil(a.length/l),number:t,size:l,first:0===t,last:s>=a.length}},fe=async()=>(await new Promise(e=>setTimeout(e,200)),ye),he={class:"voice-category-item"},ke={class:"category-name"},be={class:"voice-empty"},we={class:"voice-loading"},Se=t(r({__name:"sdkwork-voice-speaker-category-list",props:{api:{},params:{default:()=>({})},searchable:{type:Boolean,default:!0},selectable:{type:Boolean,default:!0},pageSize:{default:20},categoryApi:{},categorys:{default:()=>[]},categoryKey:{default:"id"},categoryNameField:{default:"name"},categoryCountField:{default:"count"},defaultCategoryId:{},selectedSpeakerId:{},showCloneButton:{type:Boolean,default:!0},themeMode:{default:"auto"}},emits:["select","search","select-category","load","clone"],setup(e,{expose:t,emit:o}){const s=e,r=o,m=R(),y=i(!1),f=d(()=>"dark"===s.themeMode||"light"!==s.themeMode&&(!("undefined"==typeof window||!window.matchMedia)&&window.matchMedia("(prefers-color-scheme: dark)").matches)),h=d(()=>f.value?"voice-list--dark":"voice-list--light"),k=d(()=>s.api||ve),b=d(()=>s.categoryApi||fe),w=d(()=>s.categorys&&s.categorys.length>0?s.categorys:ye),S=e=>{s.selectable&&m.setSelectedSpeaker(e),r("select",e)},C=e=>{r("search",e)},_=e=>{r("select-category",e)},M=e=>{r("load",e)},B=e=>{y.value=!1,r("clone",e)},I=()=>{y.value=!1};return t({refresh:()=>{},getSelectedSpeaker:()=>m.selectedSpeaker,setSelectedSpeaker:e=>{m.setSelectedSpeaker(e)}}),(t,o)=>{const s=ee,i=a,r=l;return c(),n("div",{class:v(["sdkwork-voice-speaker-category-list",h.value])},[g(ne,{api:k.value,params:e.params,searchable:e.searchable,selectable:e.selectable,"page-size":e.pageSize,"category-api":b.value,categorys:w.value,"category-key":e.categoryKey,"category-name-field":e.categoryNameField,"category-count-field":e.categoryCountField,"default-category-id":e.defaultCategoryId,"theme-mode":e.themeMode,onSelect:S,onSearch:C,onSelectCategory:_,onLoad:M},{default:x(({item:a,selected:t})=>[g(s,{speaker:a,active:t,"theme-mode":e.themeMode,onSelect:o[0]||(o[0]=e=>{(e=>{S(e)})(e)})},null,8,["speaker","active","theme-mode"])]),category:x(({category:e})=>[u("div",he,[u("span",ke,p(e.name),1)])]),empty:x(()=>[u("div",be,[g(i,{name:"music",size:"48",color:"#ccc"}),o[2]||(o[2]=u("div",{class:"empty-text"},"暂无发音人",-1))])]),loading:x(()=>[u("div",we,[g(r,{size:"24px"}),o[3]||(o[3]=u("span",null,"加载发音人中...",-1))])]),_:1},8,["api","params","searchable","selectable","page-size","category-api","categorys","category-key","category-name-field","category-count-field","default-category-id","theme-mode"]),g(me,{show:y.value,"onUpdate:show":o[1]||(o[1]=e=>y.value=e),onConfirm:B,onClose:I},null,8,["show"])],2)}}}),[["__scopeId","data-v-32037512"]]),Ce={class:"voice-list-popup"},_e={class:"popup-content"},xe={class:"popup-footer"},Me={key:0,class:"buttons-row"},Be={key:1,class:"single-button"},Ie=t(r({__name:"sdkwork-voice-speaker-category-list-popup",props:{modelValue:{type:Boolean,default:!1},title:{default:"选择发音人"},height:{default:"70vh"},confirmText:{default:"确认"},api:{},params:{default:()=>({})},categoryApi:{},categorys:{default:()=>[]},selectedSpeakerId:{},themeMode:{default:"auto"},showCloneButton:{type:Boolean,default:!0}},emits:["update:modelValue","confirm","close","select","search","load","clone"],setup(a,{emit:t}){const l=a,s=t,r=i(l.modelValue),m=i(null),y=i(!1),v=d(()=>m.value?`克隆声音 - ${m.value.name}`:"克隆声音");h(()=>l.modelValue,e=>{r.value=e}),h(r,e=>{s("update:modelValue",e),e||s("close")});const f=()=>{m.value&&(s("confirm",m.value),r.value=!1)},k=e=>{m.value=e,s("select",e)},b=e=>{s("search",e)},w=e=>{s("load",e)},S=()=>{setTimeout(()=>{y.value=!0},300),s("clone")},_=(e,a)=>{console.log("克隆确认",{audioFile:e,audioBlob:a,speaker:m.value}),y.value=!1},M=()=>{y.value=!1};return(t,s)=>{const i=o,d=e;return c(),n(C,null,[g(d,{show:r.value,"onUpdate:show":s[0]||(s[0]=e=>r.value=e),position:"bottom",style:B({height:a.height}),round:"",closeable:"","close-on-click-overlay":!1,"theme-mode":a.themeMode,title:a.title},{default:x(()=>[u("div",Ce,[u("div",_e,[g(Se,{api:a.api,params:a.params,"category-api":a.categoryApi,categorys:a.categorys,"selected-speaker-id":a.selectedSpeakerId,"selection-mode":"single",onSelect:k,onSearch:b,onLoad:w},null,8,["api","params","category-api","categorys","selected-speaker-id"])]),u("div",xe,[l.showCloneButton?(c(),n("div",Me,[g(i,{type:"default",size:"large",onClick:S,class:"clone-btn"},{default:x(()=>[...s[2]||(s[2]=[L(" 克隆我的声音 ",-1)])]),_:1}),g(i,{type:"primary",size:"large",onClick:f,class:"confirm-btn"},{default:x(()=>[L(p(a.confirmText),1)]),_:1})])):(c(),n("div",Be,[g(i,{type:"primary",size:"large",block:"",onClick:f,class:"confirm-btn"},{default:x(()=>[L(p(a.confirmText),1)]),_:1})]))])])]),_:1},8,["show","style","theme-mode","title"]),g(me,{modelValue:y.value,"onUpdate:modelValue":s[1]||(s[1]=e=>y.value=e),title:v.value,onConfirm:_,onClose:M},null,8,["modelValue","title"])],64)}}}),[["__scopeId","data-v-b50dd23b"]]);export{Ie as S};
