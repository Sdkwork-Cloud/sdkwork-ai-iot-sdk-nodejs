import{S as e}from"./sdkwork-page-container-BRaEsQRK.js";import{t,p as a,r as i,c as l,at as s,U as o,F as r,H as n,a1 as d,L as u,w as c,B as m,s as v,f,_ as p}from"./index-cvC_tnhK.js";import{E as h}from"./index-D-Jc6MLP.js";/* empty css              */import{a as g,D as x}from"./index-BIok3alx.js";/* empty css              */import{N as k}from"./index-Dsh2Ryrf.js";import{k as y,r as b,f as w,w as j,am as D,b as _,j as C,n as T,Z as V,a0 as B,Q as $,S,P as U,W as A,a4 as I,F as L,Y as M,$ as z,a1 as F,O as H}from"./vue-vendor-Caw1HGjZ.js";import{a as O}from"./use-tab-status-BA3so1OG.js";import"./utils-vendor-WEzSe-CR.js";import"./use-id-BN10QhF_.js";import"./index-Cq1eIEYb.js";const[E,N,P]=l("list");const Q=c(y({name:E,props:{error:Boolean,offset:i(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:a("down"),loadingText:String,finishedText:String,immediateCheck:t},emits:["load","update:error","update:loading"],setup(e,{emit:t,slots:a}){const i=b(e.loading),l=b(),c=b(),m=O(),v=s(l),f=w(()=>e.scroller||v.value),p=()=>{T(()=>{if(i.value||e.finished||e.disabled||e.error||!1===(null==m?void 0:m.value))return;const{direction:a}=e,s=+e.offset,o=n(f);if(!o.height||d(l))return;let r=!1;const u=n(c);r="up"===a?o.top-u.top<=s:u.bottom-o.bottom<=s,r&&(i.value=!0,t("update:loading",!0),t("load"))})},h=()=>{if(e.finished){const t=a.finished?a.finished():e.finishedText;if(t)return C("div",{class:N("finished-text")},[t])}},g=()=>{t("update:error",!1),p()},x=()=>{if(e.error){const t=a.error?a.error():e.errorText;if(t)return C("div",{role:"button",class:N("error-text"),tabindex:0,onClick:g},[t])}},k=()=>{if(i.value&&!e.finished&&!e.disabled)return C("div",{class:N("loading")},[a.loading?a.loading():C(u,{class:N("loading-icon")},{default:()=>[e.loadingText||P("loading")]})])};return j(()=>[e.loading,e.finished,e.error],p),m&&j(m,e=>{e&&p()}),D(()=>{i.value=e.loading}),_(()=>{e.immediateCheck&&p()}),o({check:p}),r("scroll",p,{target:f,passive:!0}),()=>{var t;const s=null==(t=a.default)?void 0:t.call(a),o=C("div",{ref:c,class:N("placeholder")},null);return C("div",{ref:l,role:"feed",class:N(),"aria-busy":i.value},["down"===e.direction?s:o,k(),h(),x(),"up"===e.direction?s:o])}}})),W={class:"history-container"},Y={class:"history-toolbar"},Z={class:"toolbar-actions"},q={key:1,class:"history-list"},G=["onClick"],J={class:"item-content"},K={class:"item-thumb"},R=["src","alt"],X={class:"item-info"},ee={class:"item-title"},te={class:"item-desc"},ae={class:"item-meta"},ie={class:"item-type"},le={class:"item-time"},se=p(y({__name:"history",setup(t){const a=H(),i=b("all"),l=b("all"),s=[{text:"全部类型",value:"all"},{text:"作品",value:"work"},{text:"智能体",value:"agent"},{text:"声音",value:"voice"},{text:"角色",value:"character"}],o=[{text:"全部时间",value:"all"},{text:"今天",value:"today"},{text:"最近7天",value:"week"},{text:"最近30天",value:"month"}],r=b([]),n=b(!1),d=b(!1),u=[{id:1,title:"AI绘画作品 - 山水风景",description:"使用AI技术创作的山水风景画",thumb:"/images/placeholder.jpg",type:"work",time:new Date(Date.now()-72e5)},{id:2,title:"智能语音助手",description:"多功能智能语音助手应用",thumb:"/images/placeholder.jpg",type:"agent",time:new Date(Date.now()-864e5)},{id:3,title:"自然语音包",description:"高质量自然语音合成包",thumb:"/images/placeholder.jpg",type:"voice",time:new Date(Date.now()-2592e5)}],c=w(()=>{let e=r.value;if("all"!==i.value&&(e=e.filter(e=>e.type===i.value)),"all"!==l.value){const t=new Date,a=new Date;switch(l.value){case"today":a.setHours(0,0,0,0);break;case"week":a.setDate(t.getDate()-7);break;case"month":a.setDate(t.getDate()-30)}e=e.filter(e=>e.time>=a)}return e}),p=e=>{const t=(new Date).getTime()-e.getTime();if(t<36e5){return`${Math.floor(t/6e4)}分钟前`}if(t<864e5){return`${Math.floor(t/36e5)}小时前`}return`${Math.floor(t/864e5)}天前`},y=()=>{n.value=!0,setTimeout(()=>{r.value.length>=u.length?d.value=!0:r.value=[...u],n.value=!1},500)},j=async()=>{try{await f({title:"确认清空",message:"确定要清空所有浏览记录吗？"}),r.value=[],v("浏览记录已清空")}catch{}},D=()=>{a.push("/")};return _(()=>{}),(t,a)=>{const u=k,f=g,b=x,w=m,_=h,T=Q,H=e;return $(),V(H,{"safe-area":"",scrollable:"","theme-mode":"auto"},{header:B(()=>[C(u,{title:"浏览记录","left-text":"返回","left-arrow":"",onClickLeft:a[0]||(a[0]=e=>t.$router.back())})]),default:B(()=>[S("div",W,[S("div",Y,[C(b,null,{default:B(()=>[C(f,{modelValue:i.value,"onUpdate:modelValue":a[1]||(a[1]=e=>i.value=e),options:s},null,8,["modelValue"]),C(f,{modelValue:l.value,"onUpdate:modelValue":a[2]||(a[2]=e=>l.value=e),options:o},null,8,["modelValue"])]),_:1}),S("div",Z,[r.value.length>0?($(),V(w,{key:0,size:"small",onClick:j},{default:B(()=>[...a[4]||(a[4]=[I(" 清空记录 ",-1)])]),_:1})):A("",!0)])]),0===c.value.length?($(),V(_,{key:0,image:"search",description:"暂无浏览记录"},{default:B(()=>[C(w,{round:"",type:"primary",onClick:D},{default:B(()=>[...a[5]||(a[5]=[I(" 去浏览内容 ",-1)])]),_:1})]),_:1})):($(),U("div",q,[C(T,{loading:n.value,"onUpdate:loading":a[3]||(a[3]=e=>n.value=e),finished:d.value,"finished-text":"没有更多了",onLoad:y},{default:B(()=>[($(!0),U(L,null,M(c.value,e=>{return $(),U("div",{key:e.id,class:"history-item",onClick:t=>(e=>{v(`查看：${e.title}`)})(e)},[S("div",J,[S("div",K,[S("img",{src:e.thumb,alt:e.title},null,8,R)]),S("div",X,[S("div",ee,z(e.title),1),S("div",te,z(e.description),1),S("div",ae,[S("span",ie,z((t=e.type,{work:"作品",agent:"智能体",voice:"声音",character:"角色"}[t]||"未知")),1),S("span",le,z(p(e.time)),1)])])]),C(w,{size:"small",type:"danger",plain:"",onClick:F(t=>{return a=e.id,r.value=r.value.filter(e=>e.id!==a),void v("记录已删除");var a},["stop"])},{default:B(()=>[...a[6]||(a[6]=[I(" 删除 ",-1)])]),_:1},8,["onClick"])],8,G);var t}),128))]),_:1},8,["loading","finished"])]))])]),_:1})}}}),[["__scopeId","data-v-38d85496"]]);export{se as default};
