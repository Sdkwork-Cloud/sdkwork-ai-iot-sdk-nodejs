import{_ as e}from"./sdkwork-search-bar-BXJYiKxA.js";import{k as a,r as t,P as s,j as r,Q as l,f as o,w as i}from"./vue-vendor-CnVaDBlt.js";import{_ as n}from"./index-Czm3MDyH.js";const u={class:"search-section"},c=n(a({__name:"SearchSection",props:{searchable:{type:Boolean}},emits:["search"],setup(a,{emit:o}){const i=o,n=t(""),c=(()=>{let e=null;return a=>{e&&clearTimeout(e),e=setTimeout(()=>{p(a)},300)}})(),p=e=>{const a=void 0!==e?e:n.value;i("search",a)},m=()=>{c(n.value)},d=()=>{n.value="",p("")};return(a,t)=>{const o=e;return l(),s("div",u,[r(o,{modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=e=>n.value=e),placeholder:"请输入搜索关键词",onSearch:p,onClear:d,onInput:m},null,8,["modelValue"])])}}}),[["__scopeId","data-v-913efe76"]]),p=["page","size","sort"];function m(e){const a=t([]),s=t(0),r=t(0),l=t(0),n=t(!1),u=t(!1),c=t(!0),m=o(()=>!n.value&&0===a.value.length),d=o(()=>0===s.value&&0===a.value.length),v=()=>!(!e.api&&!e.service)&&(e.api&&e.service,!0),g=(a=0)=>{const{pageableParams:t,queryParams:s}=((e={})=>{const a={},t={};return Object.entries(e).forEach(([e,s])=>{p.includes(e)?a[e]=s:t[e]=s}),{pageableParams:a,queryParams:t}})(e.params),r={size:e.pageSize||10,...t,...e.pageableParams,page:a,pageNumber:a};s.page=a;return{pageableParams:r,queryParams:s}},f=async(a=0)=>{const{pageableParams:t,queryParams:s}=g(a);if(e.service&&"function"==typeof e.service.listByPage)return await e.service.listByPage(s,t);if(e.api)return await e.api(s,t);throw new Error("组件没有可用的请求方法")},h=async(t=0,o=!1)=>{if(!(n.value||o&&u.value))try{if(!v())return;o?u.value=!0:n.value=!0;const i=await f(t);a.value=0===t?i.content||[]:[...a.value,...i.content||[]];const p=i.pageable||{};s.value=p.pageNumber||0,r.value=i.total||0;const m=p.pageSize||e.pageSize||10;l.value=m>0?Math.ceil(r.value/m):0,c.value=!i.last}catch(i){}finally{n.value=!1,u.value=!1}};return i(()=>e.params,()=>{!1!==e.autoLoad&&h(0)},{deep:!0}),i(()=>e.pageSize,()=>{!1!==e.autoLoad&&h(0)}),!1!==e.autoLoad&&h(0),{dataList:a,currentPage:s,totalElements:r,totalPages:l,loading:n,loadingMore:u,hasMore:c,isEmpty:m,isFirstLoad:d,loadData:h,onRefresh:async()=>{n.value=!0;try{await h(0),n.value=!1}catch(e){n.value=!1}},validateProps:v,buildRequestParams:g,handleRequest:f}}const d={selectable:!1,deletable:!1,searchable:!1,pageSize:10,itemKey:"id",itemTitleField:"name",itemDescriptionField:"description",showBorderBottom:!0,borderBottomLeftOffset:0,showNoMoreData:!1,themeMode:"auto",minSize:92,itemGap:0,fixed:!1,buffer:5,horizontal:!1,scrollDistance:0,fixSelection:!1,start:0,offset:0,listStyle:"",listClass:"",itemStyle:"",itemClass:"",columns:2,gap:16,categoryKey:"id",categoryNameField:"name",categoryCountField:"count",selectionMode:"single",tabsSticky:!0,tabsSwipeable:!0,topSpacing:"6px",leftSpacing:"8px",rightSpacing:"8px"};export{d as D,c as S,m as u};
