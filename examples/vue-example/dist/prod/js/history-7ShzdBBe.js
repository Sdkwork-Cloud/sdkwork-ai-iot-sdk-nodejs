import{S as e}from"./sdkwork-page-container-VUGI9Via.js";import{t as a,q as t,v as i,c as l,au as s,T as o,E as r,G as n,a0 as d,L as u,w as c,B as m,s as v,h as p,_ as f}from"./index-DS3FT4GI.js";import{E as h}from"./index-D-A-zf9T.js";/* empty css              */import{a as g,D as x}from"./index-DiZ1tZTC.js";/* empty css              */import{N as k}from"./index-daC3esrP.js";import{k as b,r as y,f as w,w as j,am as D,b as _,j as C,n as T,Z as V,a0 as $,Q as B,S,P as I,W as L,a4 as M,F as O,Y as U,$ as z,a1 as A,O as E}from"./vue-vendor-CnVaDBlt.js";import{a as Z}from"./use-tab-status-CE0k_sEf.js";import"./utils-vendor-WEzSe-CR.js";import"./use-id-CkVbEcjv.js";import"./index-BJXTf1ZV.js";const[q,F,G]=l("list");const H=c(b({name:q,props:{error:Boolean,offset:i(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:t("down"),loadingText:String,finishedText:String,immediateCheck:a},emits:["load","update:error","update:loading"],setup(e,{emit:a,slots:t}){const i=y(e.loading),l=y(),c=y(),m=Z(),v=s(l),p=w(()=>e.scroller||v.value),f=()=>{T(()=>{if(i.value||e.finished||e.disabled||e.error||!1===(null==m?void 0:m.value))return;const{direction:t}=e,s=+e.offset,o=n(p);if(!o.height||d(l))return;let r=!1;const u=n(c);r="up"===t?o.top-u.top<=s:u.bottom-o.bottom<=s,r&&(i.value=!0,a("update:loading",!0),a("load"))})},h=()=>{if(e.finished){const a=t.finished?t.finished():e.finishedText;if(a)return C("div",{class:F("finished-text")},[a])}},g=()=>{a("update:error",!1),f()},x=()=>{if(e.error){const a=t.error?t.error():e.errorText;if(a)return C("div",{role:"button",class:F("error-text"),tabindex:0,onClick:g},[a])}},k=()=>{if(i.value&&!e.finished&&!e.disabled)return C("div",{class:F("loading")},[t.loading?t.loading():C(u,{class:F("loading-icon")},{default:()=>[e.loadingText||G("loading")]})])};return j(()=>[e.loading,e.finished,e.error],f),m&&j(m,e=>{e&&f()}),D(()=>{i.value=e.loading}),_(()=>{e.immediateCheck&&f()}),o({check:f}),r("scroll",f,{target:p,passive:!0}),()=>{var a;const s=null==(a=t.default)?void 0:a.call(t),o=C("div",{ref:c,class:F("placeholder")},null);return C("div",{ref:l,role:"feed",class:F(),"aria-busy":i.value},["down"===e.direction?s:o,k(),h(),x(),"up"===e.direction?s:o])}}})),N={class:"history-container"},P={class:"history-toolbar"},Q={class:"toolbar-actions"},W={key:1,class:"history-list"},Y=["onClick"],J={class:"item-content"},K={class:"item-thumb"},R=["src","alt"],X={class:"item-info"},ee={class:"item-title"},ae={class:"item-desc"},te={class:"item-meta"},ie={class:"item-type"},le={class:"item-time"},se=f(b({__name:"history",setup(a){const t=E(),i=y("all"),l=y("all"),s=[{text:"全部类型",value:"all"},{text:"作品",value:"work"},{text:"智能体",value:"agent"},{text:"声音",value:"voice"},{text:"角色",value:"character"}],o=[{text:"全部时间",value:"all"},{text:"今天",value:"today"},{text:"最近7天",value:"week"},{text:"最近30天",value:"month"}],r=y([]),n=y(!1),d=y(!1),u=[{id:1,title:"AI绘画作品 - 山水风景",description:"使用AI技术创作的山水风景画",thumb:"/images/placeholder.jpg",type:"work",time:new Date(Date.now()-72e5)},{id:2,title:"智能语音助手",description:"多功能智能语音助手应用",thumb:"/images/placeholder.jpg",type:"agent",time:new Date(Date.now()-864e5)},{id:3,title:"自然语音包",description:"高质量自然语音合成包",thumb:"/images/placeholder.jpg",type:"voice",time:new Date(Date.now()-2592e5)}],c=w(()=>{let e=r.value;if("all"!==i.value&&(e=e.filter(e=>e.type===i.value)),"all"!==l.value){const a=new Date,t=new Date;switch(l.value){case"today":t.setHours(0,0,0,0);break;case"week":t.setDate(a.getDate()-7);break;case"month":t.setDate(a.getDate()-30)}e=e.filter(e=>e.time>=t)}return e}),f=e=>{const a=(new Date).getTime()-e.getTime();if(a<36e5){return`${Math.floor(a/6e4)}分钟前`}if(a<864e5){return`${Math.floor(a/36e5)}小时前`}return`${Math.floor(a/864e5)}天前`},b=()=>{n.value=!0,setTimeout(()=>{r.value.length>=u.length?d.value=!0:r.value=[...u],n.value=!1},500)},j=async()=>{try{await p({title:"确认清空",message:"确定要清空所有浏览记录吗？"}),r.value=[],v("浏览记录已清空")}catch{}},D=()=>{t.push("/")};return _(()=>{}),(a,t)=>{const u=k,p=g,y=x,w=m,_=h,T=H,E=e;return B(),V(E,{"safe-area":"",scrollable:"","theme-mode":"auto"},{header:$(()=>[C(u,{title:"浏览记录","left-text":"返回","left-arrow":"",onClickLeft:t[0]||(t[0]=e=>a.$router.back())})]),default:$(()=>[S("div",N,[S("div",P,[C(y,null,{default:$(()=>[C(p,{modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=e=>i.value=e),options:s},null,8,["modelValue"]),C(p,{modelValue:l.value,"onUpdate:modelValue":t[2]||(t[2]=e=>l.value=e),options:o},null,8,["modelValue"])]),_:1}),S("div",Q,[r.value.length>0?(B(),V(w,{key:0,size:"small",onClick:j},{default:$(()=>[...t[4]||(t[4]=[M(" 清空记录 ",-1)])]),_:1})):L("",!0)])]),0===c.value.length?(B(),V(_,{key:0,image:"search",description:"暂无浏览记录"},{default:$(()=>[C(w,{round:"",type:"primary",onClick:D},{default:$(()=>[...t[5]||(t[5]=[M(" 去浏览内容 ",-1)])]),_:1})]),_:1})):(B(),I("div",W,[C(T,{loading:n.value,"onUpdate:loading":t[3]||(t[3]=e=>n.value=e),finished:d.value,"finished-text":"没有更多了",onLoad:b},{default:$(()=>[(B(!0),I(O,null,U(c.value,e=>{return B(),I("div",{key:e.id,class:"history-item",onClick:a=>(e=>{v(`查看：${e.title}`)})(e)},[S("div",J,[S("div",K,[S("img",{src:e.thumb,alt:e.title},null,8,R)]),S("div",X,[S("div",ee,z(e.title),1),S("div",ae,z(e.description),1),S("div",te,[S("span",ie,z((a=e.type,{work:"作品",agent:"智能体",voice:"声音",character:"角色"}[a]||"未知")),1),S("span",le,z(f(e.time)),1)])])]),C(w,{size:"small",type:"danger",plain:"",onClick:A(a=>{return t=e.id,r.value=r.value.filter(e=>e.id!==t),void v("记录已删除");var t},["stop"])},{default:$(()=>[...t[6]||(t[6]=[M(" 删除 ",-1)])]),_:1},8,["onClick"])],8,Y);var a}),128))]),_:1},8,["loading","finished"])]))])]),_:1})}}}),[["__scopeId","data-v-38d85496"]]);export{se as default};
