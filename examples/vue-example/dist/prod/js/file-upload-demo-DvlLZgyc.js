import{d as e,_ as l,B as a,s as t}from"./index-DS3FT4GI.js";/* empty css              */import{a as o,_ as s}from"./sdkwork-cell-group-VLV2jidw.js";import{_ as u}from"./sdkwork-navbar-DG9_hzWm.js";import{_ as i}from"./sdkwork-popup-BvExtb7p.js";import{k as n,r as d,f as p,w as c,P as r,Q as v,S as m,W as f,R as h,j as w,u as k,$ as g,F as b,Y as y,V,n as U,Z as C,a0 as _,a4 as x}from"./vue-vendor-CnVaDBlt.js";import{S as $}from"./sdkwork-page-container-VUGI9Via.js";import"./utils-vendor-WEzSe-CR.js";import"./sdkwork-icon-JBBTW6q4.js";const F={class:"sdkwork-uploader-file"},j={class:"upload-content"},I={class:"upload-icon"},z={class:"upload-text"},B={class:"upload-title"},S={class:"upload-subtitle"},D={key:0,class:"file-list"},E={class:"file-list-header"},M={class:"file-items"},T={class:"file-info"},N={class:"file-icon"},A={class:"file-details"},P={class:"file-name"},R={class:"file-size"},L={class:"file-actions"},W={key:0,class:"upload-progress"},q={class:"progress-bar"},G={class:"progress-text"},K={key:1,class:"status-icons"},Q={key:0,class:"success-icon"},Y={key:1,class:"error-icon"},Z={class:"action-buttons"},H=["onClick"],J=["onClick"],O={key:1,class:"upload-actions"},X=["disabled"],ee=l(n({__name:"sdkwork-uploader-file",props:{modelValue:{default:()=>[]},accept:{default:"*/*"},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},autoUpload:{type:Boolean,default:!0},maxSize:{default:104857600},maxCount:{default:10},title:{default:"点击或拖拽文件到此处"},subtitle:{default:"支持所有文件类型"},bucket:{default:void 0},scene:{default:"default"},metadata:{default:()=>({})},contentType:{default:"application/octet-stream"},acl:{default:"private"}},emits:["update:modelValue","upload-start","upload-progress","upload-success","upload-error","upload-complete","file-add","file-remove","file-clear"],setup(l,{expose:a,emit:t}){const o=l,s=t;d();const u=d(!1),i=d([]),n=p(()=>i.value.filter(e=>"uploading"===e.status).length),C=p(()=>0===o.maxCount||i.value.length<o.maxCount);c(()=>o.modelValue,e=>{if(e&&e.length>0){const l=i.value.map(e=>e.id),a=e.filter(e=>!l.includes(_(e))).map(e=>x(e));i.value=[...i.value,...a],o.autoUpload&&U(()=>{ue()})}},{immediate:!0});const _=e=>`${e.name}-${e.size}-${e.lastModified}`,x=e=>({id:_(e),file:e,name:e.name,size:e.size,status:"pending",progress:0}),$=e=>{if(0===e)return"0 B";const l=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,l)).toFixed(2))+" "+["B","KB","MB","GB"][l]},ee=async()=>{if(!o.disabled&&C.value)try{const e=await window.$files.chooseFile({count:o.multiple?o.maxCount:1,success:e=>{},fail:e=>{},complete:()=>{}});e.tempFiles&&e.tempFiles.length>0&&oe(e.tempFiles)}catch(e){}},le=e=>{e.preventDefault(),!o.disabled&&C.value&&(u.value=!0)},ae=e=>{e.preventDefault(),u.value=!1},te=e=>{e.preventDefault(),u.value=!1,!o.disabled&&C.value&&e.dataTransfer?.files&&oe(Array.from(e.dataTransfer.files))},oe=e=>{if(0===e.length)return;const l=0===o.maxCount?1/0:o.maxCount-i.value.length,a=e.slice(0,l);if(0===a.length)return void window.$message?.warning(`最多只能上传 ${o.maxCount} 个文件`);const t=[],u=[];if(a.forEach(e=>{e.size>o.maxSize?u.push(e):t.push(e)}),u.length>0&&window.$message?.error(`以下文件超过最大限制 ${$(o.maxSize)}: ${u.map(e=>e.name).join(", ")}`),0===t.length)return;const n=t.map(e=>x(e));i.value=[...i.value,...n];const d=i.value.map(e=>e.file);s("update:modelValue",d),s("file-add",t),o.autoUpload&&ue()},se=()=>{i.value.forEach(e=>{"uploading"===e.status&&e.uploadId&&window.$uploader?.cancel(e.uploadId)}),i.value=[],s("update:modelValue",[]),s("file-clear")},ue=async()=>{const e=i.value.filter(e=>"pending"===e.status);if(0!==e.length){for(const l of e)await ie(l);s("upload-complete",i.value.map(e=>e.file))}},ie=async e=>{if(window.$uploader){e.status="uploading",e.progress=0,s("upload-start",e.file);try{const l={file:e.file,bucket:o.bucket||{name:"default-bucket"},name:e.name,scene:o.scene,metadata:o.metadata,contentType:o.contentType,acl:o.acl},a=await window.$uploader.upload(l,l=>{e.progress=l.percentage,s("upload-progress",e.file,l.percentage)});e.status="success",e.progress=100,s("upload-success",e.file,a)}catch(l){e.status="error",s("upload-error",e.file,l)}}};return a({clearFiles:()=>{se()},uploadFiles:()=>{ue()},getFileList:()=>i.value.map(e=>({file:e.file,status:e.status,progress:e.progress,response:"success"===e.status?"uploaded":void 0}))}),(a,t)=>(v(),r("div",F,[m("div",{class:h(["upload-area",{"drag-over":u.value,disabled:l.disabled}]),onClick:ee,onDrop:te,onDragover:le,onDragleave:ae},[m("div",j,[m("div",I,[w(k(e),{icon:"material-symbols:cloud-upload",width:"48",height:"48"})]),m("div",z,[m("p",B,g(l.title),1),m("p",S,g(l.subtitle),1)])])],34),i.value.length>0?(v(),r("div",D,[m("div",E,[m("span",null,"已选择文件 ("+g(i.value.length)+")",1),i.value.length>1?(v(),r("button",{key:0,type:"button",class:"clear-all-btn",onClick:se}," 清空全部 ")):f("",!0)]),m("div",M,[(v(!0),r(b,null,y(i.value,l=>(v(),r("div",{key:l.id,class:h(["file-item",{uploading:"uploading"===l.status,success:"success"===l.status,error:"error"===l.status}])},[m("div",T,[m("div",N,[w(k(e),{icon:"material-symbols:description",width:"24",height:"24"})]),m("div",A,[m("div",P,g(l.name),1),m("div",R,g($(l.size)),1)])]),m("div",L,["uploading"===l.status?(v(),r("div",W,[m("div",q,[m("div",{class:"progress-fill",style:V({width:l.progress+"%"})},null,4)]),m("span",G,g(l.progress)+"%",1)])):(v(),r("div",K,["success"===l.status?(v(),r("span",Q,"✓")):f("",!0),"error"===l.status?(v(),r("span",Y,"✗")):f("",!0)])),m("div",Z,["uploading"===l.status?(v(),r("button",{key:0,type:"button",class:"cancel-btn",onClick:e=>(e=>{const l=i.value.find(l=>l.id===e);l&&l.uploadId&&(window.$uploader?.cancel(l.uploadId),l.status="pending",l.progress=0,l.uploadId=void 0)})(l.id)}," 取消 ",8,H)):(v(),r("button",{key:1,type:"button",class:"remove-btn",onClick:e=>(e=>{const l=i.value.findIndex(l=>l.id===e);if(-1!==l){const e=i.value[l];"uploading"===e.status&&e.uploadId&&window.$uploader?.cancel(e.uploadId),i.value.splice(l,1);const a=i.value.map(e=>e.file);s("update:modelValue",a),s("file-remove",e.file)}})(l.id)}," 移除 ",8,J))])])],2))),128))])])):f("",!0),i.value.length>0&&!l.autoUpload?(v(),r("div",O,[m("button",{type:"button",class:"upload-btn primary",disabled:n.value>0,onClick:ue},g(n.value>0?`上传中... (${n.value})`:"开始上传"),9,X),m("button",{type:"button",class:"upload-btn secondary",onClick:se}," 取消 ")])):f("",!0)]))}}),[["__scopeId","data-v-720d47d1"]]),le={class:"demo-content"},ae={class:"popup-content"},te={key:0,class:"file-info"},oe={class:"popup-content"},se={key:0,class:"file-info"},ue={class:"popup-content"},ie={class:"popup-content"},ne={key:0,class:"upload-actions"},de={class:"popup-content"},pe={class:"popup-content"},ce={class:"popup-content"},re={class:"popup-content"},ve={class:"popup-content"},me={key:0,class:"progress-info"},fe={class:"popup-content"},he={class:"status-info"},we={class:"popup-content"},ke={class:"ops-info"},ge=l(n({__name:"file-upload-demo",setup(e){const l=d(!1),n=d(!1),p=d(!1),c=d(!1),h=d(!1),k=d(!1),V=d(!1),U=d(!1),F=d(!1),j=d(!1),I=d(!1),z=d([]),B=d([]),S=d([]),D=d([]),E=d([]),M=d([]),T=d([]),N=d([]),A=d([]),P=d([]),R=d([]),L=d(),W=d([]),q=d("等待上传"),G=d([]),K=(e,l)=>{t(`单文件上传成功: ${e.name}`)},Q=(e,l)=>{t(`多文件上传成功: ${e.name}`)},Y=(e,l)=>{t(`上传失败: ${e.name}`)},Z=(e,l)=>{t(`文件过大: ${e.name}`)},H=e=>{t(`添加了 ${e.length} 个文件`)},J=(e,l)=>{const a=W.value.findIndex(l=>l.fileName===e.name);-1!==a?W.value[a].progress=l:W.value.push({fileName:e.name,progress:l})},O=e=>{q.value=`开始上传: ${e.name}`,G.value.push(`开始上传: ${e.name}`)},X=(e,l)=>{q.value=`上传成功: ${e.name}`,G.value.push(`上传成功: ${e.name}`)},ge=e=>{q.value="所有文件上传完成",G.value.push("所有文件上传完成")},be=e=>{G.value.push(`移除文件: ${e.name}`)},ye=()=>{G.value.push("清空所有文件")},Ve=()=>{L.value&&(L.value.uploadFiles(),t("开始手动上传"))},Ue=()=>{L.value&&(L.value.clearFiles(),t("已清空文件"))},Ce=()=>{t("切换禁用状态")};return(e,t)=>{const d=u,_e=o,xe=s,$e=a;return v(),C($,{"safe-area":"",scrollable:"","theme-mode":"auto"},{header:_(()=>[w(d,{title:"通用文件上传组件演示","left-text":"返回","left-arrow":"",onClickLeft:t[0]||(t[0]=l=>e.$router.back())})]),default:_(()=>[m("div",le,[w(xe,{title:"基础功能演示"},{default:_(()=>[w(_e,{title:"单文件上传","is-link":"",onClick:t[1]||(t[1]=e=>l.value=!0)}),w(_e,{title:"多文件上传","is-link":"",onClick:t[2]||(t[2]=e=>n.value=!0)}),w(_e,{title:"拖拽上传","is-link":"",onClick:t[3]||(t[3]=e=>p.value=!0)}),w(_e,{title:"手动上传","is-link":"",onClick:t[4]||(t[4]=e=>c.value=!0)})]),_:1}),w(xe,{title:"高级功能演示"},{default:_(()=>[w(_e,{title:"文件大小限制","is-link":"",onClick:t[5]||(t[5]=e=>h.value=!0)}),w(_e,{title:"文件数量限制","is-link":"",onClick:t[6]||(t[6]=e=>k.value=!0)}),w(_e,{title:"自定义文件类型","is-link":"",onClick:t[7]||(t[7]=e=>V.value=!0)}),w(_e,{title:"禁用状态","is-link":"",onClick:t[8]||(t[8]=e=>U.value=!0)})]),_:1}),w(xe,{title:"事件监听演示"},{default:_(()=>[w(_e,{title:"上传进度监听","is-link":"",onClick:t[9]||(t[9]=e=>F.value=!0)}),w(_e,{title:"上传状态监听","is-link":"",onClick:t[10]||(t[10]=e=>j.value=!0)}),w(_e,{title:"文件操作监听","is-link":"",onClick:t[11]||(t[11]=e=>I.value=!0)})]),_:1})]),w(i,{show:l.value,"onUpdate:show":t[13]||(t[13]=e=>l.value=e),position:"center",title:"单文件上传",width:400},{default:_(()=>[m("div",ae,[w(ee,{modelValue:z.value,"onUpdate:modelValue":t[12]||(t[12]=e=>z.value=e),multiple:!1,"auto-upload":!0,title:"选择单个文件",subtitle:"支持所有文件类型",onUploadSuccess:K,onUploadError:Y},null,8,["modelValue"]),z.value.length>0?(v(),r("div",te,[m("p",null,"已选择文件: "+g(z.value.length)+" 个",1)])):f("",!0)])]),_:1},8,["show"]),w(i,{show:n.value,"onUpdate:show":t[15]||(t[15]=e=>n.value=e),position:"center",title:"多文件上传",width:500},{default:_(()=>[m("div",oe,[w(ee,{modelValue:B.value,"onUpdate:modelValue":t[14]||(t[14]=e=>B.value=e),multiple:!0,"auto-upload":!0,"max-count":5,title:"选择多个文件",subtitle:"最多选择5个文件",onUploadSuccess:Q,onUploadError:Y},null,8,["modelValue"]),B.value.length>0?(v(),r("div",se,[m("p",null,"已选择文件: "+g(B.value.length)+" 个",1)])):f("",!0)])]),_:1},8,["show"]),w(i,{show:p.value,"onUpdate:show":t[17]||(t[17]=e=>p.value=e),position:"center",title:"拖拽上传",width:450},{default:_(()=>[m("div",ue,[w(ee,{modelValue:S.value,"onUpdate:modelValue":t[16]||(t[16]=e=>S.value=e),multiple:!0,"auto-upload":!0,title:"拖拽文件到此处",subtitle:"支持拖拽上传文件",onFileAdd:H},null,8,["modelValue"])])]),_:1},8,["show"]),w(i,{show:c.value,"onUpdate:show":t[19]||(t[19]=e=>c.value=e),position:"center",title:"手动上传",width:480},{default:_(()=>[m("div",ie,[w(ee,{ref_key:"manualUploaderRef",ref:L,modelValue:D.value,"onUpdate:modelValue":t[18]||(t[18]=e=>D.value=e),multiple:!0,"auto-upload":!1,title:"手动控制上传",subtitle:"选择文件后手动触发上传"},null,8,["modelValue"]),D.value.length>0?(v(),r("div",ne,[w($e,{type:"primary",block:"",onClick:Ve},{default:_(()=>[...t[34]||(t[34]=[x("开始上传",-1)])]),_:1}),w($e,{type:"default",block:"",onClick:Ue},{default:_(()=>[...t[35]||(t[35]=[x("清空文件",-1)])]),_:1})])):f("",!0)])]),_:1},8,["show"]),w(i,{show:h.value,"onUpdate:show":t[21]||(t[21]=e=>h.value=e),position:"center",title:"文件大小限制",width:450},{default:_(()=>[m("div",de,[w(ee,{modelValue:E.value,"onUpdate:modelValue":t[20]||(t[20]=e=>E.value=e),multiple:!0,"auto-upload":!0,"max-size":10485760,title:"文件大小限制",subtitle:"最大文件大小: 10MB",onUploadError:Z},null,8,["modelValue"])])]),_:1},8,["show"]),w(i,{show:k.value,"onUpdate:show":t[23]||(t[23]=e=>k.value=e),position:"center",title:"文件数量限制",width:450},{default:_(()=>[m("div",pe,[w(ee,{modelValue:M.value,"onUpdate:modelValue":t[22]||(t[22]=e=>M.value=e),multiple:!0,"auto-upload":!0,"max-count":3,title:"文件数量限制",subtitle:"最多上传3个文件"},null,8,["modelValue"])])]),_:1},8,["show"]),w(i,{show:V.value,"onUpdate:show":t[25]||(t[25]=e=>V.value=e),position:"center",title:"自定义文件类型",width:450},{default:_(()=>[m("div",ce,[w(ee,{modelValue:T.value,"onUpdate:modelValue":t[24]||(t[24]=e=>T.value=e),multiple:!0,"auto-upload":!0,accept:".pdf,.doc,.docx,.xls,.xlsx",title:"文档文件上传",subtitle:"仅支持PDF、Word、Excel文档"},null,8,["modelValue"])])]),_:1},8,["show"]),w(i,{show:U.value,"onUpdate:show":t[27]||(t[27]=e=>U.value=e),position:"center",title:"禁用状态",width:400},{default:_(()=>[m("div",re,[w(ee,{modelValue:N.value,"onUpdate:modelValue":t[26]||(t[26]=e=>N.value=e),multiple:!0,"auto-upload":!0,disabled:!0,title:"禁用状态",subtitle:"上传组件已被禁用"},null,8,["modelValue"]),w($e,{type:"primary",block:"",onClick:Ce},{default:_(()=>[...t[36]||(t[36]=[x("切换禁用状态",-1)])]),_:1})])]),_:1},8,["show"]),w(i,{show:F.value,"onUpdate:show":t[29]||(t[29]=e=>F.value=e),position:"center",title:"上传进度监听",width:500},{default:_(()=>[m("div",ve,[w(ee,{modelValue:A.value,"onUpdate:modelValue":t[28]||(t[28]=e=>A.value=e),multiple:!0,"auto-upload":!0,title:"进度监听演示",onUploadProgress:J},null,8,["modelValue"]),W.value.length>0?(v(),r("div",me,[t[37]||(t[37]=m("h4",null,"上传进度:",-1)),(v(!0),r(b,null,y(W.value,e=>(v(),r("div",{key:e.fileName,class:"progress-item"},[m("span",null,g(e.fileName),1),m("span",null,g(e.progress)+"%",1)]))),128))])):f("",!0)])]),_:1},8,["show"]),w(i,{show:j.value,"onUpdate:show":t[31]||(t[31]=e=>j.value=e),position:"center",title:"上传状态监听",width:500},{default:_(()=>[m("div",fe,[w(ee,{modelValue:P.value,"onUpdate:modelValue":t[30]||(t[30]=e=>P.value=e),multiple:!0,"auto-upload":!0,title:"状态监听演示",onUploadStart:O,onUploadSuccess:X,onUploadError:Y,onUploadComplete:ge},null,8,["modelValue"]),m("div",he,[t[38]||(t[38]=m("h4",null,"上传状态:",-1)),m("p",null,g(q.value),1)])])]),_:1},8,["show"]),w(i,{show:I.value,"onUpdate:show":t[33]||(t[33]=e=>I.value=e),position:"center",title:"文件操作监听",width:500},{default:_(()=>[m("div",we,[w(ee,{modelValue:R.value,"onUpdate:modelValue":t[32]||(t[32]=e=>R.value=e),multiple:!0,"auto-upload":!0,title:"文件操作监听",onFileAdd:H,onFileRemove:be,onFileClear:ye},null,8,["modelValue"]),m("div",ke,[t[39]||(t[39]=m("h4",null,"操作记录:",-1)),(v(!0),r(b,null,y(G.value,(e,l)=>(v(),r("div",{key:l,class:"log-item"},g(e),1))),128))])])]),_:1},8,["show"])]),_:1})}}}),[["__scopeId","data-v-768596af"]]);export{ge as default};
